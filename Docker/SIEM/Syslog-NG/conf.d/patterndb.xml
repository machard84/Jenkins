<?xml version='1.0' encoding='UTF-8'?>
<patterndb version='3' pub_date='2018-02-14'><ruleset name='bro_irc' id='26008'>
  <pattern>bro_irc</pattern>
  <rules>
    <rule provider='Security_Onion' class='26008' id='26008'>
      <patterns>
        <pattern>@ESTRING::|@@ESTRING::|@@ESTRING:i0:|@@ESTRING:i1:|@@ESTRING:i2:|@@ESTRING:i3:|@@ESTRING:s0:|@@ESTRING:s1:|@@ESTRING:s2:|@@ESTRING:s3:|@@ESTRING::|@@ESTRING:s4:|@@ESTRING:i4:|@@ESTRING:s5:|@@ESTRING::@</pattern>
      </patterns>
      <examples>
        <example>
          <test_message program='bro_irc'>1385362967.853268|CiCjeA4fH8qmmiS981|192.168.10.103|44880|82.96.64.4|6667|-|-|JOIN|test|(empty)|-|-|-|-</test_message>
          <test_value name='i0'>192.168.10.103</test_value>
          <test_value name='i1'>44880</test_value>
          <test_value name='i2'>82.96.64.4</test_value>
          <test_value name='i3'>6667</test_value>
          <test_value name='s0'>-</test_value>
          <test_value name='s1'>-</test_value>
          <test_value name='s2'>JOIN</test_value>
          <test_value name='s3'>test</test_value>
          <test_value name='s4'>-</test_value>
          <test_value name='i4'>-</test_value>
          <test_value name='s5'>-</test_value>
        </example>
      </examples>
    </rule>
  </rules>
</ruleset><ruleset name='Autoruns' id='10678'>
                <pattern>ossec_archive</pattern>
        <rules>
        <rule provider='DefensiveDepth' class='10678' id='10678'>
                        <patterns>
                                 <pattern>@NUMBER::@@ESTRING::(@@ESTRING::)@ @IPv4::@-&gt;@ESTRING::AR-LOG|@@ESTRING:s0:|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING:s1:|@@ESTRING::|@@ESTRING:s2:|@@ESTRING:s3:|@@ESTRING::|@@ESTRING:s4:|@@ESTRING::|@@ESTRING:s5:|@</pattern>
                        </patterns>
        <examples>
         <example>
                <test_message program='ossec_archive'>2016 May 20 16:39:21 (DD-COLLECT-PROD) 192.168.160.18-&gt;ar-normalized.log AR-LOG|DD-RE2|05/20/2016 12:39:00|4/8/2016 4:42 PM|HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run|Skype|enabled|Logon|DD-RE2\ddadmin|Skype |Skype Technologies S.A.|c:\program files (x86)\skype\phone\skype.exe|7.22.85.109|&quot;&quot;C:\Program Files (x86)\Skype\Phone\Skype.exe&quot;&quot; /minimized /regrun|1DBD44E4C19F6EC1665A89ABC884DF56|ADC1CF4AD8C6F944E31E4649BE16B186EE19D793|BCC10DF9F36B1727DBA310827CC2A6AC5C9B0D4D|1DA131F21C1A7BAF8C70272FCE5E4288E021CB434D12A28784344E02CBEA3BFA|169D5B005368A12B6F499F7B655540884BD47D872D74AAD73CD035356DA148A9|A9159194FEF672CA050D5D2DC9E64017</test_message>
                <test_value name='s0'>DD-RE2</test_value>
                <test_value name='s1'>Skype</test_value>
                <test_value name='s2'>Logon</test_value>
                <test_value name='s3'>DD-RE2\ddadmin</test_value>
                <test_value name='s4'>Skype Technologies S.A.</test_value>
                <test_value name='s5'>c:\program files (x86)\skype\phone\skype.exe</test_value>
          </example>
        </examples>
        </rule>
        </rules>
  </ruleset><ruleset name='CITRIX_NETSCALER' id='12001'>
   <pattern>ossec_archive</pattern>
        <rules>
                <rule provider='ELSA' class='12001' id='12001'>
                <patterns>
                <pattern>@ESTRING::NS-VPX @@ESTRING::SSLVPN @@ESTRING:s1: @@ESTRING::SessionId: @@ESTRING:i3:-@@ESTRING:: User @@ESTRING:s0: @@ESTRING:: Client_ip @@IPv4:i0:@@ESTRING:: Destination @@IPv4:i1:@@ESTRING:::@@ESTRING:i2: @@ESTRING::bytes_send @@ESTRING:i4: @@ESTRING::bytes_recv @@ESTRING:i5: @</pattern>
                <pattern>@ESTRING::NS-VPX @@ESTRING::SSLVPN @@ESTRING:s1: @@ESTRING::Source @@IPv4:i0:@@ESTRING::Destination @@IPv4:i1:@@ESTRING:::@@ESTRING:i2: @@ESTRING::username:domainname @@ESTRING:s0::@@ESTRING::bytes_send @@ESTRING:i5: @@ESTRING::bytes_recv @@ESTRING:i4: @</pattern>
                <pattern>@ESTRING::NS-VPX @@ESTRING::SSLVPN @@ESTRING:s1: @@ESTRING::SessionId: @@ESTRING:i3:- @@ESTRING:s2: User @@ESTRING:s0: @@ESTRING::Vserver @@IPv4:i1:@@ESTRING:::@@ESTRING:i2: @@ESTRING::GMT @@ESTRING:s3: @@ESTRING:s4: @</pattern>
                <pattern>@ESTRING::NS-VPX @@ESTRING::SSLVPN @@ESTRING:s1: @@ESTRING::SessionId: @@ESTRING:i3:- @@ESTRING:s2:User @@ESTRING:s0: @@ESTRING::Client_ip @@IPv4:i0:@@ESTRING::Vserver @@IPv4:i1:@@ESTRING:::@@ESTRING:i2: @@ESTRING::Browser_type @@QSTRING:s5:&quot;@</pattern>
                <pattern>@ESTRING::NS-VPX @@ESTRING::AAA @@ESTRING:s1: @@ESTRING:: User @@ESTRING:s0: @@ESTRING::Client_ip @@IPv4:i0:@@ESTRING::Browser @@ANYSTRING:s5:@</pattern>
                <pattern>@ESTRING::NS-VPX @@ESTRING::SSLLOG @@ESTRING:s1: @@ESTRING::ClientIP @@IPv4:i0@@ESTRING::VserverServiceIP @@IPv4:i1:@@ESTRING::VserverServicePort @@ESTRING:i2: @</pattern>
                <pattern>@ESTRING::NS-VPX @@ESTRING::SSLVPN @@ESTRING:s1: @@ESTRING::SessionId: @@ESTRING:i3:-@@ESTRING:: User @@ESTRING:s0: @@ESTRING:: Client_ip @@IPv4:i0:@@ESTRING::Vserver @@IPv4:i1:@@ESTRING:::@@ESTRING:i2: @@ESTRING::bytes_send @@ESTRING:i5: @@ESTRING::bytes_recv @@ESTRING:i4: @</pattern>
                <pattern>@ESTRING::NS-VPX @@ESTRING::UI @@ESTRING:s1: @@ESTRING::User @@ESTRING:s0: @@ESTRING::Remote_ip @@IPv4:i0:@</pattern>
                <pattern>@ESTRING::NS-VPX @@ESTRING::SSLVPN @@ESTRING:s1: @@ESTRING::Source @@IPv4:i0:@@ESTRING::Destination @@IPv4:i1@@ESTRING:::@@ESTRING:i2: @@ESTRING::domainname @@ESTRING:s0::@</pattern>
                </patterns>
                <examples>
                        <example>
                        <test_message program='ossec_archive'>03/16/2016:09:15:12 GMT NS-VPX 0-PPE-0 : SSLVPN ICASTART 145792 0 : Source 1.1.1.1:4323 - Destination 10.1.1.1:1494 - username:domainname user01:domain01 - applicationName Citrix QuickConnect - startTime &quot;03/16/2016:09:15:11 GMT&quot; - connectionId 1a92ae</test_message>
                        <test_value name='s1'>ICASTART</test_value>
                        <test_value name='s0'>user01</test_value>
                        <test_value name='i0'>1.1.1.1</test_value>
                        <test_value name='i1'>10.1.1.1</test_value>
                        <test_value name='i2'>1494</test_value>
                        </example>
                        <example>
                        <test_message program='ossec_archive'>03/22/2016:16:05:58 GMT NS-VPX 0-PPE-0 : default GUI CMD_EXECUTED 22771 0 : User user01 - Remote_ip 1.1.1.1 - Command &quot;show aaa group -weight 0&quot; - Status &quot;Success&quot;</test_message>
                        <test_value name='s1'>CMD_EXECUTED</test_value>
                        <test_value name='s0'>user01</test_value>
                        <test_value name='i0'>1.1.1.1</test_value>
                        </example>
                        <example>
                        <test_message program='ossec_archive'>03/22/2016:01:46:02 GMT NS-VPX 0-PPE-0 : default SSLVPN LOGOUT 12037 0 : Context user01@1.1.1.1 - SessionId: 151- User user01 - Client_ip 1.1.1.1 - Nat_ip &quot;Mapped Ip&quot; - Vserver 192.168.1.1:443 - Start_time &quot;03/22/2016:01:05:50 GMT&quot; - End_time &quot;03/22/2016:01:46:02 GMT&quot; - Duration 00:40:12 - Http_resources_accessed 0 - NonHttp_services_accessed 0 - Total_TCP_connections 107 - Total_UDP_flows 0 - Total_policies_allowed 107 - Total_policies_denied 0 - Total_bytes_send 94324 - Total_bytes_recv 47820732 - Total_compressedbytes_send 0 - Total_compressedbytes_recv 1618378 - Compression_ratio_send 0.00% - Compression_ratio_recv 96.61% - LogoutMethod &quot;TimedOut&quot; - Group(s) &quot;N/A&quot;</test_message>
                        <test_value name='s1'>LOGOUT</test_value>
                        <test_value name='s0'>user01</test_value>
                        <test_value name='i0'>1.1.1.1</test_value>
                        <test_value name='i1'>192.168.1.1</test_value>
                        <test_value name='i2'>443</test_value>
                        <test_value name='i3'>151</test_value>
                        <test_value name='i4'>47820732</test_value>
                        <test_value name='i5'>94324</test_value>
                        </example>
                        <example>
                        <test_message program='ossec_archive'>03/24/2016:08:54:11 GMT NS-VPX 0-PPE-0 : default SSLLOG SSL_HANDSHAKE_SUCCESS 50326 0 : SPCBId 7460 - ClientIP 1.1.1.1 - ClientPort 51412 - VserverServiceIP 192.168.1.1 - VserverServicePort 443 - ClientVersion TLSv1.0 - CipherSuite &quot;DES-CBC3-SHA TLSv1 Non-Export 168-bit&quot; - Session Reuse</test_message>
                        <test_value name='s1'>SSL_HANDSHAKE_SUCCESS</test_value>
                        <test_value name='i0'>1.1.1.1</test_value>
                        <test_value name='i1'>192.168.1.1</test_value>
                        <test_value name='i2'>443</test_value>
                        </example>
                        <example>
                        <test_message program='ossec_archive'>03/22/2016:06:49:23 GMT NS-VPX 0-PPE-0 : default AAA LOGIN_FAILED 15678 0 : User user01 - Client_ip 1.1.1.1 - Failure_reason &quot;External authentication server denied access&quot; - Browser Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/49.0.2623.87 Safari/537.36</test_message>
                        <test_value name='s0'>user01</test_value>
                        <test_value name='s1'>LOGIN_FAILED</test_value>
                        <test_value name='s5'>Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/49.0.2623.87 Safari/537.36</test_value>
                        <test_value name='i0'>1.1.1.1</test_value>
                        </example>
                        <example>
                        <test_message program='ossec_archive'>03/21/2016:09:06:46 GMT NS-VPX 0-PPE-0 : default SSLVPN LOGIN 5119 0 : Context user01@1.1.1.1 - SessionId: 69- User user01 - Client_ip 1.1.1.1 - Nat_ip &quot;Mapped Ip&quot; - Vserver 192.168.1.1:443 - Browser_type &quot;Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/49.0.2623.87 Safari/537.36&quot; - SSLVPN_client_type ICA - Group(s) &quot;N/A&quot;</test_message>
                        <test_value name='s0'>user01</test_value>
                        <test_value name='s1'>LOGIN</test_value>
                        <test_value name='s5'>Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/49.0.2623.87 Safari/537.36</test_value>
                        <test_value name='i0'>1.1.1.1</test_value>
                        <test_value name='i1'>192.168.1.1</test_value>
                        <test_value name='i2'>443</test_value>
                        <test_value name='i3'>69</test_value>
                        </example>
                        <example>
                        <test_message program='ossec_archive'>03/21/2016:13:03:59 GMT NS-VPX 0-PPE-0 : default SSLVPN HTTPREQUEST 6728 0 : Context user01@1.1.1.1 - SessionId: 91- top.site.com User user01 : Group(s) N/A : Vserver 192.168.1.1:443 - 03/21/2016:13:03:59 GMT GET /blah/appCon - -</test_message>
                        <test_value name='s0'>user01</test_value>
                        <test_value name='s1'>HTTPREQUEST</test_value>
                        <test_value name='s2'>top.site.com</test_value>
                        <test_value name='s3'>GET</test_value>
                        <test_value name='s4'>/blah/appCon</test_value>
                        <test_value name='i1'>192.168.1.1</test_value>
                        <test_value name='i2'>443</test_value>
                        <test_value name='i3'>91</test_value>
                        </example>
                        <example>
                        <test_message program='ossec_archive'>03/21/2016:09:06:46 GMT NS-VPX 0-PPE-0 : default SSLVPN TCPCONNSTAT 5123 0 : Context user01@1.1.1.1 - SessionId: 69- User user01 - Client_ip 1.1.1.1 - Nat_ip 10.0.0.1 - Vserver 192.168.0.1:443 - Source 1.1.1.1:39344 - Destination 10.0.0.2:80 - Start_time &quot;03/21/2016:09:06:46 GMT&quot; - End_time &quot;03/21/2016:09:06:46 GMT&quot; - Duration 00:00:00 - Total_bytes_send 588 - Total_bytes_recv 394 - Total_compressedbytes_send 0 - Total_compressedbytes_recv 0 - Compression_ratio_send 0.00% - Compression_ratio_recv 0.00% - Access Allowed - Group(s) &quot;N/A&quot;</test_message>
                        <test_value name='s1'>TCPCONNSTAT</test_value>
                        <test_value name='s0'>user01</test_value>
                        <test_value name='i0'>1.1.1.1</test_value>
                        <test_value name='i1'>10.0.0.2</test_value>
                        <test_value name='i2'>80</test_value>
                        <test_value name='i3'>69</test_value>
                        <test_value name='i4'>588</test_value>
                        <test_value name='i5'>394</test_value>
                        </example>
                        <example>
                        <test_message program='ossec_archive'>03/21/2016:08:26:46 GMT NS-VPX 0-PPE-0 : default SSLVPN ICAEND_CONNSTAT 4986 0 : Source 1.1.1.1:58792 - Destination 10.1.2.3:1494 - username:domainname user01:domain01 - startTime &quot;03/21/2016:06:42:33 GMT&quot; - endTime &quot;03/21/2016:08:26:46 GMT&quot; - Duration 01:44:13 - Total_bytes_send 616233 - Total_bytes_recv 12302665 - Total_compressedbytes_send 0 - Total_compressedbytes_recv 0 - Compression_ratio_send 0.00% - Compression_ratio_recv 0.00% - connectionId 2403e</test_message>
                        <test_value name='s0'>user01</test_value>
                        <test_value name='s1'>ICAEND_CONNSTAT</test_value>
                        <test_value name='i0'>1.1.1.1</test_value>
                        <test_value name='i1'>10.1.2.3</test_value>
                        <test_value name='i2'>1494</test_value>
                        <test_value name='i4'>12302665</test_value>
                        <test_value name='i5'>616233</test_value>
                        </example>
                    </examples>
                </rule>
        </rules>
</ruleset><ruleset name='MS-DHCP' id='40'>
<pattern>ossec_archive</pattern>
<rules>
    <rule provider='ELSA' class='40' id='40'>
        <patterns>
            <pattern>@ESTRING::DhcpSrvLog-@@ESTRING::NACK@@ESTRING::,@@IPv4:i0:@@ESTRING::,,@@ESTRING:s0:,@</pattern>
            <pattern>@ESTRING::DhcpSrvLog-@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@IPv4:i0:,@@ESTRING::,@@ESTRING:s2:.@@ESTRING:s1:,@@ESTRING:s0:,@</pattern>
            <pattern>@ESTRING::DhcpSrvLog-@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@IPv4:i0:,@@ESTRING::,@@ESTRING:s2:.@@ESTRING:s1:,@</pattern>
            <pattern>@ESTRING::DhcpSrvLog-@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@IPv4:i0:,@@ESTRING::,@@ESTRING:s2:,@</pattern>
            <pattern>@ESTRING::DhcpSrvLog-@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@IPv4:i0:,@</pattern>
        </patterns>
        <examples>
            <example>
                <test_message program='ossec_archive'>2015 Nov 04 23:34:34 (SERVER01) 10.0.0.1-&gt;\\Windows/sysnative/Dhcp/DhcpSrvLog-Wed.log 11,11/09/15,12:03:23,Renew,10.0.0.5,CLIENT01.contoso.com,28D24AA50FF2,,1904697850,0,,,</test_message>
                <test_value name='i0'>10.0.0.5</test_value>
                <test_value name='s0'>28D24AA50FF2</test_value>
                <test_value name='s1'>contoso.com</test_value>
                <test_value name='s2'>CLIENT01</test_value>
            </example>
            <example>
                <test_message program='ossec_archive'>2015 Nov 04 23:34:34 (SERVER01) 10.0.0.1-&gt;\\Windows/sysnative/Dhcp/DhcpSrvLog-Wed.log 30,11/09/15,12:03:23,DNS Update Request,10.0.0.5,CLIENT01.contoso.com,,,0,6,,,</test_message>
                <test_value name='i0'>10.0.0.5</test_value>
                <test_value name='s1'>contoso.com</test_value>
                <test_value name='s2'>CLIENT01</test_value>
            </example>
            <example>
                <test_message program='ossec_archive'>2015 Nov 04 23:34:34 (SERVER01) 10.0.0.1-&gt;\\Windows/sysnative/Dhcp/DhcpSrvLog-Wed.log 30,11/09/15,12:03:23,DNS Update Request,10.0.0.5,CLIENT01,,,0,6,,,</test_message>
                <test_value name='i0'>10.0.0.5</test_value>
                <test_value name='s2'>CLIENT01</test_value>
            </example>
            <example>
                <test_message program='ossec_archive'>2016 Mar 14 12:11:03 (SERVER01) 10.0.0.1-&gt;\\Windows/sysnative/Dhcp/DhcpSrvLog-Mon.log 15,03/14/16,08:11:02,NACK,10.0.0.5,,AAAABBBBCCCC,,0,6,,,</test_message>
                <test_value name='i0'>10.0.0.5</test_value>
                <test_value name='s0'>AAAABBBBCCCC</test_value>
            </example>
            <example>
                <test_message program='ossec_archive'>2015 Nov 10 10:23:15 (SERVER01) 10.0.0.1-&gt;\\Windows/sysnative/Dhcp/DhcpSrvLog-Tue.log 16,11/10/15,11:23:12,Deleted,10.0.0.5,,,,0,6,,,</test_message>
                <test_value name='i0'>10.0.0.5</test_value>
            </example>
        </examples>
    </rule>
</rules>
</ruleset><ruleset name='bro_pe' id='26016'>
  <pattern>bro_pe</pattern>
  <rules>
    <rule provider='Security_Onion' class='26016' id='26016'>
      <patterns>
        <pattern>@ESTRING::|@@ESTRING::|@@ESTRING:s0:|@@ESTRING::|@@ESTRING:s1:|@@ESTRING:s2:|@@ESTRING:s3:|@@ESTRING:s4:|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING:s5:@</pattern>
      </patterns>
      <examples>
        <example>
          <test_message program='bro_pe'>1440175068.686115|F1bfwb4ISGyepouhIh|I386|1268327830.000000|Windows 95 or NT 4.0|WINDOWS_GUI|T|F|F|F|F|F|T|T|F|F|UPX0,UPX1,.rsrc</test_message>
          <test_value name='s0'>I386</test_value>
          <test_value name='s1'>Windows 95 or NT 4.0</test_value>
          <test_value name='s2'>WINDOWS_GUI</test_value>
          <test_value name='s3'>T</test_value>
          <test_value name='s4'>F</test_value>
          <test_value name='s5'>UPX0,UPX1,.rsrc</test_value>
        </example>
      </examples>
    </rule>
  </rules>
</ruleset><ruleset>
                <pattern>bro_mysql</pattern>
                <rules>
                        <rule class='26013' id='26013'>
                                <patterns>
					<pattern>@ESTRING::|@@ESTRING::|@@ESTRING:i0:|@@ESTRING:i1:|@@ESTRING:i2:|@@ESTRING:i3:|@@ESTRING:s0:|@@ESTRING:s1:|@@ESTRING:s2:|@@ESTRING:i4:|@@ESTRING:s3:@</pattern>
                                </patterns>
                                <examples>
                                        <example>
						<test_message program='bro_mysql'>MESSAGE=1438800219.691536|CgGl4C24eFgIb8JYEf|192.168.0.254|56162|192.168.0.254|3306|field_list|agent|T|3|-</test_message>
                                                <test_value name='i0'>192.168.0.254</test_value>
                                                <test_value name='i1'>56162</test_value>
                                                <test_value name='i2'>192.168.0.254</test_value>
                                                <test_value name='i3'>3306</test_value>
                                                <test_value name='s0'>field_list</test_value>
                                                <test_value name='s1'>agent</test_value>
                                                <test_value name='s2'>T</test_value>
                                                <test_value name='i4'>3</test_value>
                                                <test_value name='s3'>-</test_value>
                                        </example>
                                </examples>
                        </rule>
                </rules>
        </ruleset><ruleset name='bro_rfb' id='26020'>
  <pattern>bro_rfb</pattern>
  <rules>
    <rule provider='Security_Onion' class='26020' id='26020'>
      <patterns>
        <pattern>@ESTRING::|@@ESTRING::|@@ESTRING:i0:|@@ESTRING:i1:|@@ESTRING:i2:|@@ESTRING:i3:|@@ESTRING:s0:|@@ESTRING:s1:|@@ESTRING:s2:|@@ESTRING:s3:|@@ESTRING:s4:|@@ESTRING::|@@ESTRING::|@@ESTRING:s5:|@@ESTRING:i4:|@@ESTRING:i5:@</pattern>
      </patterns>
      <examples>
        <example>
          <test_message program='bro_rfb'>1484079685.745596|Cjoynh4xFlb9GzUNv9|192.168.2.115|52353|192.168.2.16|5900|003|889|003|889|Apple Remote Desktop|T|T|\x00\x00\x00\x00\x00\x02\xbf\xfe\xe7\x03\xe0\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00MacMini SSD|1920|1080</test_message>
          <test_value name='i0'>192.168.2.115</test_value>
          <test_value name='i1'>52353</test_value>
          <test_value name='i2'>192.168.2.16</test_value>
          <test_value name='i3'>5900</test_value>
          <test_value name='s0'>003</test_value>
          <test_value name='s1'>889</test_value>
          <test_value name='s2'>003</test_value>
          <test_value name='s3'>889</test_value>
          <test_value name='s4'>Apple Remote Desktop</test_value>
          <test_value name='s5'>\x00\x00\x00\x00\x00\x02\xbf\xfe\xe7\x03\xe0\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00MacMini SSD</test_value>
          <test_value name='i4'>1920</test_value>
          <test_value name='i5'>1080</test_value>
        </example>
      </examples>
    </rule>
  </rules>
</ruleset><ruleset name='IISWebLog'>
                <pattern>ossec_archive</pattern>
                <rule provider='ELSA' class='7' id='IIS_7'>
		                   <patterns> 
                        <pattern>@NUMBER::@@ESTRING::(@@ESTRING::)@ @IPv4::@-&gt;@ESTRING:: @@ESTRING::-@@ESTRING::-@@ESTRING:: @@ESTRING:: @@ESTRING:s1: @@ESTRING:: @@IPv4:i1:@ @ESTRING:s0: @@ESTRING:s2: @@ESTRING:: @@ESTRING:: @@ESTRING:s3: @@IPv4:i0:@ @ESTRING:: @@ESTRING:s4: @@ESTRING:: @@ESTRING:s3: @@ESTRING:s1: @@ESTRING:i2: @@NUMBER::@ @NUMBER::@ @ESTRING:i3: @@ESTRING:: @@ESTRING:i5:@</pattern>
	                <pattern>@ESTRING::) @@IPv4:i1:-&gt;@@ESTRING::inetpub@@ESTRING:: @@ESTRING:: @@ESTRING:: @@ESTRING:: @@ESTRING:s0: @@ESTRING:s2: @@ESTRING:: @@ESTRING:: @@ESTRING:: @@IPv4:i0:@ @ESTRING:s4: @@ESTRING:i2: @</pattern>
		                    </patterns>	
                        <examples>
                                 <example>
                                        <test_message program='ossec_archive'>2015 Jul 13 23:06:36 (windows7_x64) 192.168.142.6-&gt;\inetpub\logs\LogFiles\W3SVC1\u_ex150715.log 2015-07-15 15:29:30 W3SVC1 WIN-KTL39CHEPFC 192.168.142.6 GET /index.html - 80 - 192.168.142.5 HTTP/1.1 Mozilla/5.0+(X11;+Linux+x86_64)+AppleWebKit/537.36+(KHTML,+like+Gecko)+Ubuntu+Chromium/37.0.2062.120+Chrome/37.0.2062.120+Safari/537.36 - - 192.168.142.6 304 0 0 188 487 0</test_message>
                             <test_values>
                                                <test_value name='i0'>192.168.142.5</test_value>
                                                <test_value name='i1'>192.168.142.6</test_value>
                                                <test_value name='i2'>304</test_value>
                                                <test_value name='i3'>188</test_value>
                                                <test_value name='i5'>0</test_value>
                                                <test_value name='s0'>GET</test_value>
                                                <test_value name='s1'>192.168.142.6</test_value>
                                                <test_value name='s2'>/index.html</test_value>
                                                <test_value name='s3'>-</test_value>
                                                <test_value name='s4'>Mozilla/5.0+(X11;+Linux+x86_64)+AppleWebKit/537.36+(KHTML,+like+Gecko)+Ubuntu+Chromium/37.0.2062.120+Chrome/37.0.2062.120+Safari/537.36</test_value>
                                     </test_values>
                                </example>
                                           <example>
                        <test_message program='ossec_archive'>2015 Nov 11 09:53:55 (SERVER01) 10.0.0.6-&gt;/inetpub/logs/LogFiles/W3SVC1/u_ex151111.log 2015-11-11 09:52:55 10.0.0.6 HEAD /Ldlogon/lddwnld.dll - 80 - 10.0.0.5 Apple-iPhone6C2/1208.321 200 0 0 0</test_message>
                        <test_values>
                                <test_value name='i0'>10.0.0.5</test_value>
                                <test_value name='i1'>10.0.0.6</test_value>
                                <test_value name='i2'>200</test_value>
                                <test_value name='s0'>HEAD</test_value>
                                <test_value name='s2'>/Ldlogon/lddwnld.dll</test_value>
                                <test_value name='s4'>Apple-iPhone6C2/1208.321</test_value>
                        </test_values>
                </example>
                    		</examples>
                  </rule>
	</ruleset><ruleset name='bro_tunnel' id='26002'>
  <pattern>bro_tunnel</pattern>
  <rules>
    <rule provider='Security_Onion' class='26002' id=''>
      <patterns>
        <pattern>@ESTRING::|@@ESTRING::|@@ESTRING:i0:|@@ESTRING:i1:|@@ESTRING:i2:|@@ESTRING:i3:|@@ESTRING:s0:|@@ESTRING:s1:@</pattern>
      </patterns>
      <examples>
        <example>
          <test_message program='bro_tunnel'>1375125910.892967|RamHZItz989|172.24.241.83|53003|10.0.0.50|3544|Tunnel::TEREDO|Tunnel::DISCOVER</test_message>
          <test_value name='i0'>172.24.241.83</test_value>
          <test_value name='i1'>53003</test_value>
          <test_value name='i2'>10.0.0.50</test_value>
          <test_value name='i3'>3544</test_value>
          <test_value name='s0'>Tunnel::TEREDO</test_value>
          <test_value name='s1'>Tunnel::DISCOVER</test_value>
        </example>
      </examples>
    </rule>
  </rules>
</ruleset><ruleset name='bro_sip' id='26017'>
  <pattern>bro_sip</pattern>
  <rules>
    <rule provider='Security_Onion' class='26017' id='26017'>
      <patterns>
        <pattern>@ESTRING::|@@ESTRING::|@@ESTRING:i0:|@@ESTRING:i1:|@@ESTRING:i2:|@@ESTRING:i3:|@@ESTRING:i4:|@@ESTRING:s0:|@@ESTRING:s1:|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING:s2:|@@ESTRING:i5:|@@ESTRING:s3:|@</pattern>
      </patterns>
      <examples>
        <example>
          <test_message program='bro_sip'>1440177006.231050|CdxbIv4iLTqX3iS1O4|192.168.1.2|5060|212.242.33.35|5060|0|REGISTER|sip:sip.cybercity.dk|-|&lt;sip:voi18063@sip.cybercity.dk&gt;|&lt;sip:voi18063@sip.cybercity.dk&gt;|&lt;sip:voi18063@sip.cybercity.dk&gt;|&lt;sip:voi18063@sip.cybercity.dk&gt;;tag=00-04092-1701af62-120c67172|-|578222729-4665d775@578222732-4665d772|68 REGISTER|-|SIP/2.0/UDP 192.168.1.2|SIP/2.0/UDP 192.168.1.2;received=80.230.219.70;rport=5060|Nero SIPPS IP Phone Version 2.0.51.16|401|Unauthorized|-|0|0|-</test_message>
          <test_value name='i0'>192.168.1.2</test_value>
          <test_value name='i1'>5060</test_value>
          <test_value name='i2'>212.242.33.35</test_value>
          <test_value name='i3'>5060</test_value>
          <test_value name='i4'>0</test_value>
          <test_value name='s0'>REGISTER</test_value>
          <test_value name='s1'>sip:sip.cybercity.dk</test_value>
          <test_value name='s2'>Nero SIPPS IP Phone Version 2.0.51.16</test_value>
          <test_value name='i5'>401</test_value>
          <test_value name='s3'>Unauthorized</test_value>
        </example>
      </examples>
    </rule>
  </rules>
</ruleset><ruleset>
		<pattern>bro_dns</pattern>
		<rules>
			<rule class='14' id='14'>
				<patterns>
					<pattern>@ESTRING::|@@ESTRING::|@@ESTRING:i0:|@@ESTRING:i1:|@@ESTRING:i2:|@@ESTRING:i3:|@@ESTRING:i4:|@@ESTRING::|@@ESTRING::|@@ESTRING:s0:|@@ESTRING::|@@ESTRING:s2:|@@ESTRING::|@@ESTRING:s3:|@@ESTRING::|@@ESTRING:s4:|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING:s1:|@@ANYSTRING::@</pattern>
                                        <pattern>@ESTRING::|@@ESTRING::|@@ESTRING:i0:|@@ESTRING:i1:|@@ESTRING:i2:|@@ESTRING:i3:|@@ESTRING:i4:|@@ESTRING::|@@ESTRING::|@@ESTRING:s0:|@@ESTRING::|@@ESTRING:s2:|@@ESTRING::|@@ESTRING:s3:|@@ESTRING::|@@ESTRING:s4:|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ANYSTRING:s1@</pattern>
                                        <pattern>@ESTRING::|@@ESTRING::|@@ESTRING:i0:|@@ESTRING:i1:|@@ESTRING:i2:|@@ESTRING:i3:|@@ESTRING:i4:|@@ESTRING::|@@ESTRING::|@@ESTRING:s0:|@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program='bro_dns'>1420831379.950431|CsQlNY1bfzq9sW2tsc|192.168.10.101|1036|193.108.91.137|53|udp|3753|0.0|www.ask.com.edgesuite.net|1|C_INTERNET|1|A|0|NOERROR|T|F|F|F|0|a1230.b.akamai.net|21600.000000|F</test_message>
						<test_value name='i0'>192.168.10.101</test_value>
						<test_value name='i1'>1036</test_value>
						<test_value name='i2'>193.108.91.137</test_value>
						<test_value name='i3'>53</test_value>
						<test_value name='i4'>udp</test_value>
						<test_value name='s0'>www.ask.com.edgesuite.net</test_value>
						<test_value name='s1'>a1230.b.akamai.net</test_value>
						<test_value name='s2'>C_INTERNET</test_value>
						<test_value name='s3'>A</test_value>
						<test_value name='s4'>NOERROR</test_value>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset><ruleset>
  <pattern>bro_notice</pattern>
  <rules>
    <rule provider='Simone Bonetti' class='15' id='15'>
        <patterns>
          <pattern>@ESTRING::|@@ESTRING::|-|-|-|-|-|@@ESTRING:s0:|@@ESTRING:s1:|@@ESTRING:s2:|@@ESTRING:s3:|@@ESTRING:s4:|@@ESTRING:s5:|@@ESTRING:i0:|@@ESTRING:i2:|@@ESTRING:i3:|@@ESTRING:i1:|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::@</pattern>
        </patterns>
        <examples>
          <example>
            <test_message program='bro_notice'>1431057588.407430|-|-|-|-|-|-|-|-|tcp|Scan::Address_Scan|1.2.3.4 scanned at least 28 unique hosts on port 1095/tcp in 0m5s|remote|1.2.3.4|-|1095|-|brosensor-ethx-5|Notice::ACTION_LOG|3600.000000|F|-|-|-|-|-</test_message>
            <test_value name='s0'>-</test_value>
            <test_value name='s1'>-</test_value>
            <test_value name='s2'>tcp</test_value>
            <test_value name='s3'>Scan::Address_Scan</test_value>
            <test_value name='s4'>1.2.3.4 scanned at least 28 unique hosts on port 1095/tcp in 0m5s</test_value>
            <test_value name='s5'>remote</test_value>
            <test_value name='i0'>1.2.3.4</test_value>
            <test_value name='i2'>-</test_value>
            <test_value name='i3'>1095</test_value>
            <test_value name='i1'>-</test_value>
           </example>
         </examples>
     </rule>
     <rule provider='Security_Onion' class='15' id='15'>
	  <patterns>
            <pattern>@ESTRING::|@@ESTRING::|@@ESTRING:i0:|@@ESTRING:i1:|@@ESTRING:i2:|@@ESTRING:i3:|@@ESTRING::|@@ESTRING:s0:|@@ESTRING:s1:|@@ESTRING:s2:|@@ESTRING:s3:|@@ESTRING:s4:|@@ESTRING:s5:|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::@</pattern>
	  </patterns>
	  <examples>
	    <example>
             <test_message program='bro_notice'>1384786661.610946|ClFR684ID34iQAkkH8|192.168.3.25|1054|89.187.51.0|80|F4mTaE3W2oCrLZFAw6|application/x-dosexec|http://pipiskin.hk/load.exe|tcp|TeamCymruMalwareHashRegistry::Match|Malware Hash Registry Detection rate: 56%  Last seen: 2010-06-25 19:07:15|https://www.virustotal.com/en/search/?query=3ddcf24f58664a92023cc0004a799b6e0ec411ac|192.168.3.25|89.187.51.0|80|-|Sandbox01-eth0-1|Notice::ACTION_LOG|3600.000000|F|-|-|-|-|-</test_message>
	      <test_value name='i0'>192.168.3.25</test_value>
	      <test_value name='i1'>1054</test_value>
	      <test_value name='i2'>89.187.51.0</test_value>
	      <test_value name='i3'>80</test_value>
	      <test_value name='s0'>application/x-dosexec</test_value>
	      <test_value name='s1'>http://pipiskin.hk/load.exe</test_value>
	      <test_value name='s2'>tcp</test_value>
	      <test_value name='s3'>TeamCymruMalwareHashRegistry::Match</test_value>
	      <test_value name='s4'>Malware Hash Registry Detection rate: 56%  Last seen: 2010-06-25 19:07:15</test_value>
	      <test_value name='s5'>https://www.virustotal.com/en/search/?query=3ddcf24f58664a92023cc0004a799b6e0ec411ac</test_value>
	    </example>
	  </examples>
	</rule>
  </rules>
</ruleset><ruleset name='bro_dnp3' id='26019'>
  <pattern>bro_dnp3</pattern>
  <rules>
    <rule provider='Security_Onion' class='26019' id='26019'>
      <patterns>
        <pattern>@ESTRING::|@@ESTRING::|@@ESTRING:i0:|@@ESTRING:i1:|@@ESTRING:i2:|@@ESTRING:i3:|@@ESTRING:s0:|@@ESTRING:s1:|@@ESTRING:i4:@</pattern>
      </patterns>
      <examples>
        <example>
          <test_message program='bro_dnp3'>1436555953.765764|CnZKS10trXfqFTCu8|203.0.113.77|65438|192.168.3.5|502|READ|-|-</test_message>
          <test_value name='i0'>203.0.113.77</test_value>
          <test_value name='i1'>65438</test_value>
          <test_value name='i2'>192.168.3.5</test_value>
          <test_value name='i3'>502</test_value>
          <test_value name='s0'>READ</test_value>
          <test_value name='s1'>-</test_value>
          <test_value name='i4'>-</test_value>
        </example>
      </examples>
    </rule>
  </rules>
</ruleset><ruleset>
                <pattern>bro_smtp</pattern>
                <rules>
                        <rule class='16' id='16'>
                                <patterns>
                                        <pattern>@ESTRING::|@@ESTRING::|@@ESTRING:i0:|@@ESTRING:i1:|@@ESTRING:i2:|@@ESTRING:i3:|@@ESTRING::|@@ESTRING:s0:|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING:s1:|@@ESTRING:s2:|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING:s3:|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING:s4:|@@ESTRING:s5:|@</pattern>
                                </patterns>
                                <examples>
                                        <example>
                                                <test_message program='bro_smtp'>1481136793.453126|CFau1z1sOBwsm9J2ij|192.168.1.159|1038|64.12.102.142|587|1|annlaptop|sneakyg33k@aol.com|mistersecretx@aol.com|Sat, 10 Oct 2009 07:38:10 -0600|&quot;Ann Dercover&quot; &lt;sneakyg33k@aol.com&gt;|&lt;mistersecretx@aol.com&gt;|-|-|&lt;001101ca49ae$e93e45b0$9f01a8c0@annlaptop&gt;|-|rendezvous|-|-|-|250 OK|64.12.102.142,192.168.1.159|Microsoft Outlook Express 6.00.2900.2180|F|FQiXGa4wsod68Ybzz2,FLZ2TY3RRwekPJ26Xb,FwBjO73iIuicfTC8gk|F</test_message>
                                                <test_value name='i0'>192.168.1.159</test_value>
                                                <test_value name='i1'>1038</test_value>
                                                <test_value name='i2'>64.12.102.142</test_value>
                                                <test_value name='i3'>587</test_value>
                                                <test_value name='s0'>annlaptop</test_value>
                                                <test_value name='s1'>&quot;Ann Dercover&quot; &lt;sneakyg33k@aol.com&gt;</test_value>
                                                <test_value name='s2'>&lt;mistersecretx@aol.com&gt;</test_value>
                                                <test_value name='s3'>rendezvous</test_value>
                                                <test_value name='s4'>250 OK</test_value>
                                                <test_value name='s5'>64.12.102.142,192.168.1.159</test_value>
                                        </example>
                                </examples>
                        </rule>
                </rules>
        </ruleset><ruleset name='bro_modbus' id='26018'>
  <pattern>bro_modbus</pattern>
  <rules>
    <rule provider='Security_Onion' class='26018' id='26018'>
      <patterns>
        <pattern>@ESTRING::|@@ESTRING::|@@ESTRING:i0:|@@ESTRING:i1:|@@ESTRING:i2:|@@ESTRING:i3:|@@ESTRING:s0:|@@ESTRING:s1:@</pattern>
      </patterns>
      <examples>
        <example>
          <test_message program='bro_modbus'>1436555953.765764|CnZKS10trXfqFTCu8|203.0.113.77|65438|192.168.3.5|502|READ_HOLDING_REGISTERS|-</test_message>
          <test_value name='i0'>203.0.113.77</test_value>
          <test_value name='i1'>65438</test_value>
          <test_value name='i2'>192.168.3.5</test_value>
          <test_value name='i3'>502</test_value>
          <test_value name='s0'>READ_HOLDING_REGISTERS</test_value>
          <test_value name='s1'>-</test_value>
        </example>
      </examples>
    </rule>
  </rules>
</ruleset><ruleset name='bro_http' id='19'>
  <pattern>bro_http</pattern>
  <rules>
    <rule provider='Security_Onion' class='19' id='19'>
      <patterns>
        <pattern>@ESTRING::|@@ESTRING::|@@ESTRING:i0:|@@ESTRING:i1:|@@ESTRING:i2:|@@ESTRING:i3:|@@ESTRING::|@@ESTRING:s0:|@@ESTRING:s1:|@@ESTRING:s2:|@@ESTRING:s3:|@@ESTRING::|@@ESTRING:s4:|@@ESTRING::|@@ESTRING:i5:|@@ESTRING:i4:|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING:s5:@</pattern>
      </patterns>
      <examples>
        <example>
          <test_message program='bro_http'>1384366977.167889|CeEWn14oWSULhfVyL6|192.168.4.226|58543|74.125.228.32|80|1|GET|clients2.google.com||-|-|Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Ubuntu Chromium/28.0.1500.71 Chrome/28.0.1500.71 Safari/537.36|0|380|200|OK|-|-|(empty)|-|-|-|-|-|-|F6XqFl1L5YkUsflHK8|-|application/xml</test_message>
          <test_value name='i0'>192.168.4.226</test_value>
          <test_value name='i1'>58543</test_value>
          <test_value name='i2'>74.125.228.32</test_value>
          <test_value name='i3'>80</test_value>
          <test_value name='s0'>GET</test_value>
          <test_value name='s1'>clients2.google.com</test_value>
          <test_value name='s2'></test_value>
          <test_value name='s3'>-</test_value>
          <test_value name='s4'>Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Ubuntu Chromium/28.0.1500.71 Chrome/28.0.1500.71 Safari/537.36</test_value>
          <test_value name='i4'>200</test_value>
          <test_value name='i5'>380</test_value>
          <test_value name='s5'>application/xml</test_value>
        </example>
      </examples>
    </rule>
  </rules>
</ruleset><ruleset name='bro_kerberos' id='26014'>
  <pattern>bro_kerberos</pattern>
  <rules>
    <rule provider='Security_Onion' class='26014' id='26014'>
      <patterns>
        <pattern>@ESTRING::|@@ESTRING::|@@ESTRING:i0:|@@ESTRING:i1:|@@ESTRING:i2:|@@ESTRING:i3:|@@ESTRING:s0:|@@ESTRING:s1:|@@ESTRING:s2:|@@ESTRING:s3:|@@ESTRING:s4:|@@ESTRING::@</pattern>
      </patterns>
      <examples>
        <example>
          <test_message program='bro_kerberos'>1440016860.160321|CHNIve4skjMIJUM7Fg|192.168.10.128|1533|192.168.10.101|88|AS|mallory/EXAMPLE|krbtgt/EXAMPLE|F|KDC_ERR_PREAUTH_FAILED|-|2136422885.000000|-|T|T|-|-|-|-</test_message>
          <test_value name='i0'>192.168.10.128</test_value>
          <test_value name='i1'>1533</test_value>
          <test_value name='i2'>192.168.10.101</test_value>
          <test_value name='i3'>88</test_value>
          <test_value name='s0'>AS</test_value>
          <test_value name='s1'>mallory/EXAMPLE</test_value>
          <test_value name='s2'>krbtgt/EXAMPLE</test_value>
          <test_value name='s3'>F</test_value>
          <test_value name='s4'>KDC_ERR_PREAUTH_FAILED</test_value>
        </example>
      </examples>
    </rule>
  </rules>
</ruleset><ruleset name='filterlog'>
		<pattern>filterlog</pattern>
		<rules>
			<rule provider='ELSA' class='2' id='2'>
				<patterns>
					<pattern>@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING:s1:,@@ESTRING::,@block,@ESTRING::,@4,@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@NUMBER:i0:,@,@ESTRING::,@@ESTRING::,@@IPv4:i1:,@,@IPv4:i3:,@,@NUMBER:i2:,@,@NUMBER:i4:,@</pattern>
                    <pattern>@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING:s1:,@@ESTRING::,@block,@ESTRING::,@@NUMBER::,@,@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@NUMBER:i0:,@,igmp,@ESTRING::,@@IPv4:i1,@,@IPv4:i3:,@,@ESTRING::@</pattern>
					<pattern>@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING:s1:,@@ESTRING::,@block,@ESTRING::,@6,@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@NUMBER:i0:,@,@ESTRING::,@@IPv6:i1:,@,@IPv6:i3:,@,@NUMBER:i2:,@,@NUMBER:i4:,@</pattern>
					<pattern>@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING:s1:,@@ESTRING::,@block,@ESTRING::,@6,@ESTRING::,@@ESTRING::,@@ESTRING::,@Options,@NUMBER:i0:,@,@ESTRING::,@@IPv6:i1:,@,@IPv6:i3:,@,@ESTRING::@</pattern>
					<pattern>@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING:s1:,@@ESTRING::,@block,@ESTRING::,@4,@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@NUMBER:i0:,@,@ESTRING::,@@ESTRING::,@@IPv4:i1:,@,@IPv4:i3:,@,@ESTRING::@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program='filterlog'>171,16777216,,1424282996,em1,match,block,in,4,0x0,,1,30898,0,none,17,udp,50,192.168.1.10,224.0.0.252,63227,5355,30</test_message>
						<test_value name='s1'>em1</test_value>
						<test_value name='i0'>17</test_value>
						<test_value name='i1'>192.168.1.10</test_value>
						<test_value name='i2'>63227</test_value>
						<test_value name='i3'>224.0.0.252</test_value>
						<test_value name='i4'>5355</test_value>
					</example>
					<example>
						<test_message program='filterlog'>170,16777216,,1424282996,em0,match,block,in,4,0x0,,128,18835,0,DF,6,tcp,48,193.110.44.49,10.15.180.114,55253,25,0,S,2587172434,,8192,,mss;nop;nop;sackOK</test_message>
						<test_value name='s1'>em0</test_value>
						<test_value name='i0'>6</test_value>
						<test_value name='i1'>193.110.44.49</test_value>
						<test_value name='i2'>55253</test_value>
						<test_value name='i3'>10.15.180.114</test_value>
						<test_value name='i4'>25</test_value>
					</example>
				</examples>
			</rule>
			<rule provider='ELSA' class='3' id='3'>
				<patterns>
					<pattern>@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING:s1:,@@ESTRING::,@pass,@ESTRING::,@4,@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@NUMBER:i0:,@,@ESTRING::,@@ESTRING::,@@IPv4:i1:,@,@IPv4:i3:,@,@NUMBER:i2:,@,@NUMBER:i4:,@</pattern>
					<pattern>@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING:s1:,@@ESTRING::,@pass,@ESTRING::,@@NUMBER::,@,@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@NUMBER:i0:,@,igmp,@ESTRING::,@@IPv4:i1,@,@IPv4:i3:,@,@ESTRING::@</pattern>
					<pattern>@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING:s1:,@@ESTRING::,@pass,@ESTRING::,@6,@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@NUMBER:i0:,@,@ESTRING::,@@IPv6:i1:,@,@IPv6:i3:,@,@NUMBER:i2:,@,@NUMBER:i4:,@</pattern>
					<pattern>@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING:s1:,@@ESTRING::,@pass,@ESTRING::,@6,@ESTRING::,@@ESTRING::,@@ESTRING::,@Options,@NUMBER:i0:,@,@ESTRING::,@@IPv6:i1:,@,@IPv6:i3:,@,@ESTRING::@</pattern>
					<pattern>@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING:s1:,@@ESTRING::,@pass,@ESTRING::,@4,@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@NUMBER:i0:,@,@ESTRING::,@@ESTRING::,@@IPv4:i1:,@,@IPv4:i3:,@,@ESTRING::@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program='filterlog'>140,16777216,,1424282984,em1,match,pass,in,4,0x0,,128,4207,0,DF,6,tcp,52,192.168.0.3,216.58.208.66,65480,80,0,S,452276625,,8192,,mss;nop;wscale;nop;nop;sackOK</test_message>
						<test_value name='s1'>em1</test_value>
						<test_value name='i0'>6</test_value>
						<test_value name='i1'>192.168.0.3</test_value>
						<test_value name='i2'>65480</test_value>
						<test_value name='i3'>216.58.208.66</test_value>
						<test_value name='i4'>80</test_value>
					</example> 
					<example>
						<test_message program='filterlog'>5,16777216,,1000000103,em0,match,pass,in,4,0x0,,41,63030,0,none,1,icmp,107,222.233.210.210,109.88.162.79,unreachport,222.233.210.210,UDP,5387</test_message>
						<test_value name='s1'>em0</test_value>
						<test_value name='i0'>1</test_value>
						<test_value name='i1'>222.233.210.210</test_value>
						<test_value name='i2'></test_value>
						<test_value name='i3'>109.88.162.79</test_value>
						<test_value name='i4'></test_value>
					</example> 
					<example>
						<test_message program='filterlog'>141,16777216,,1424282984,em1,match,pass,in,4,0x0,,128,26522,0,DF,6,tcp,52,192.168.1.13,74.125.136.159,63408,443,0,S,942122724,,8192,,mss;nop;wscale;nop;nop;sackOK</test_message>		
						<test_value name='s1'>em1</test_value>
						<test_value name='i0'>6</test_value>
						<test_value name='i1'>192.168.1.13</test_value>
						<test_value name='i2'>63408</test_value>
						<test_value name='i3'>74.125.136.159</test_value>
						<test_value name='i4'>443</test_value>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset><ruleset name='CISCO_DENY' id='2'>
   <pattern>ossec_archive</pattern>
        <rules>
                <rule provider='ELSA' class='2' id='2'>
                <patterns>
                <pattern>@ESTRING::ASA-@@ESTRING:: Deny @@ESTRING:i0: src @@ESTRING:s0::@@IPv4:i1:@@QSTRING:i2:/ @dst @ESTRING:s1::@@ESTRING::__@@IPv4:i3:_@@ESTRING::/@@ESTRING:i4: by @access-group @QSTRING:s2:&quot;@</pattern>
                <pattern>@ESTRING::ASA-@@ESTRING:: Deny @@ESTRING:i0: src @@ESTRING:s0::@@IPv4:i1:@@QSTRING:i2:/ @dst @ESTRING:s1::@@IPv4:i3:@@ESTRING::/@@ESTRING:i4: @by access-group @QSTRING:s2:&quot;@</pattern>
                <pattern>@ESTRING::ASA-@@ESTRING:: access-list @@ESTRING:s2: denied @@ESTRING:i0: @@ESTRING:s0:/@@ESTRING::__@@IPv4:i1:_@@ESTRING::(@@ESTRING:i2:)@ -&gt; @ESTRING:s1:/@@IPv4:i3:@@QSTRING:i4:()@ hit</pattern>
                <pattern>@ESTRING::ASA-@@ESTRING:: access-list @@ESTRING:s2: denied @@ESTRING:i0: @@ESTRING:s0:/@@IPv4:i1:@@QSTRING:i2:()@ -&gt; @ESTRING:s1:/@@IPv4:i3:@@QSTRING:i4:()@ hit</pattern>
                <pattern>@ESTRING::ASA-@@ESTRING:: Deny inbound @@ESTRING:i0: from @@ESTRING:i1:/@@ESTRING:i2: to @@ESTRING:i3:/@@ESTRING:i4: @</pattern>
                <pattern>@ESTRING::ASA-@@ESTRING::Inbound @@ESTRING:i0: @@ESTRING:: from @@ESTRING:i1:/@@ESTRING:i2: to @@ESTRING:i3:/@@ESTRING:i4: @</pattern>
                </patterns>
                <examples>
                        <example>
                        <test_message program='ossec_archive'>2015 Jul 04 15:21:14 ossec-&gt;10.1.2.3 Jul 04 2015 15:21:14: %ASA-1-106100: access-list INSIDE denied udp INSIDE/IP__192.1.2.3__TEST-DNS-SERVER-1(62341) -&gt; OUTSIDE/1.1.1.1(53) hit-cnt 1 first hit [0x17e24468, 0xeddf9cf4]</test_message>
                        <test_value name='i0'>udp</test_value>
                        <test_value name='i1'>192.1.2.3</test_value>
                        <test_value name='i2'>62341</test_value>
                        <test_value name='i3'>1.1.1.1</test_value>
                        <test_value name='i4'>53</test_value>
                        <test_value name='s0'>INSIDE</test_value>
                        <test_value name='s1'>OUTSIDE</test_value>
                        <test_value name='s2'>INSIDE</test_value>
                        </example>
                        <example>
                        <test_message program='ossec_archive'>2015 Jul 06 01:26:35 ossec--&gt;10.1.2.3 Jul 06 2015 01:26:35: %ASA-1-106100: access-list INSIDE denied tcp INSIDE/192.1.2.3(62341) -&gt; OUTSIDE/1.1.1.1(80) hit-cnt 2 300-second interval [0x17e24468, 0xdb1224c4]</test_message>
                        <test_value name='i0'>tcp</test_value>
                        <test_value name='i1'>192.1.2.3</test_value>
                        <test_value name='i2'>62341</test_value>
                        <test_value name='i3'>1.1.1.1</test_value>
                        <test_value name='i4'>80</test_value>
                        <test_value name='s0'>INSIDE</test_value>
                        <test_value name='s1'>OUTSIDE</test_value>
                        <test_value name='s2'>INSIDE</test_value>
                        </example>
                        <example>
                        <test_message program='ossec_archive'>2015 Jul 02 23:03:25 ossec-&gt;10.1.2.3 Jul 02 2015 23:03:25: %ASA-4-106023: Deny udp src INSIDE:10.15.16.17/1353 dst OUTSIDE:1.1.1.1/2000 by access-group &quot;INSIDE&quot; [0x0, 0x0]</test_message>
                        <test_value name='i0'>udp</test_value>
                        <test_value name='i1'>10.15.16.17</test_value>
                        <test_value name='i2'>1353</test_value>
                        <test_value name='i3'>1.1.1.1</test_value>
                        <test_value name='i4'>2000</test_value>
                        <test_value name='s0'>INSIDE</test_value>
                        <test_value name='s1'>OUTSIDE</test_value>
                        <test_value name='s2'>INSIDE</test_value>
                        </example>
                        <example>
                        <test_message program='ossec_archive'>2015 Jul 05 07:38:30 ossec-&gt;10.1.2.3 Jul 05 2015 07:38:30: %ASA-4-106023: Deny tcp src OUTSIDE:1.1.1.1/30961 dst DMZ:192.1.2.3/443 by access-group &quot;OUTSIDE&quot; [0xdc7d8c8a, 0x84a85def]</test_message>
                        <test_value name='i0'>tcp</test_value>
                        <test_value name='i1'>1.1.1.1</test_value>
                        <test_value name='i2'>30961</test_value>
                        <test_value name='i3'>192.1.2.3</test_value>
                        <test_value name='i4'>443</test_value>
                        <test_value name='s0'>OUTSIDE</test_value>
                        <test_value name='s1'>DMZ</test_value>
                        <test_value name='s2'>OUTSIDE</test_value>
                        </example>
                        <example>
                        <test_message program='ossec_archive'>2015 Jul 05 11:37:59 ossec-&gt;2015 Jul 05 07:38:30 ossec-&gt;10.1.2.3 Jul 05 2015 07:38:30: %ASA-4-106023: Deny tcp src DMZ:192.1.2.3/56409 dst INSIDE:IP__10.15.16.17__TEST-DNS-SERVER-3/49155 by access-group &quot;DMZ&quot; [0x0, 0x0]</test_message>
                        <test_value name='i0'>tcp</test_value>
                        <test_value name='i1'>192.1.2.3</test_value>
                        <test_value name='i2'>56409</test_value>
                        <test_value name='i3'>10.15.16.17</test_value>
                        <test_value name='i4'>49155</test_value>
                        <test_value name='s0'>DMZ</test_value>
                        <test_value name='s1'>INSIDE</test_value>
                        <test_value name='s2'>DMZ</test_value>
                        </example>
                        <example>
                        <test_message program='ossec_archive'>2015 Oct 11 16:33:22 ossec-colo-&gt;10.1.2.3 Oct 11 2015 16:33:22: %ASA-2-106006: Deny inbound UDP from 1.1.1.1/54741 to 192.168.1.2/161 on interface INSIDE-INT</test_message>
                        <test_value name='i0'>UDP</test_value>
                        <test_value name='i1'>1.1.1.1</test_value>
                        <test_value name='i2'>54741</test_value>
                        <test_value name='i3'>192.168.1.2</test_value>
                        <test_value name='i4'>161</test_value>
                        </example>
                        <example>
                        <test_message program='ossec_archive'>2015 Oct 10 05:03:09 ossec-colo-&gt;10.1.2.3 Oct 10 2015 05:03:08: %ASA-2-106001: Inbound TCP connection denied from 1.1.1.1/58543 to 192.168.1.2/139 flags SYN on interface INSIDE-INT</test_message>
                        <test_value name='i0'>TCP</test_value>
                        <test_value name='i1'>1.1.1.1</test_value>
                        <test_value name='i2'>58543</test_value>
                        <test_value name='i3'>192.168.1.2</test_value>
                        <test_value name='i4'>139</test_value>
                        </example>
                    </examples>
                </rule>
        </rules>
</ruleset><ruleset name='bro_rdp' id='26015'>
  <pattern>bro_rdp</pattern>
  <rules>
    <rule provider='Security_Onion' class='26015' id='26015'>
      <patterns>
        <pattern>@ESTRING::|@@ESTRING::|@@ESTRING:i0:|@@ESTRING:i1:|@@ESTRING:i2:|@@ESTRING:i3:|@@ESTRING::|@@ESTRING:s0:|@@ESTRING:s1:|@@ESTRING:s2:|@@ESTRING:s3:|@@ESTRING:s4:|@@ESTRING::|@@ESTRING:i4:|@@ESTRING:i5:|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING:s5:|@</pattern>
      </patterns>
      <examples>
        <example>
          <test_message program='bro_rdp'>1440024994.898444|CO6uo9227Q4NdsxR72|10.226.41.226|10446|10.226.24.52|3389|A70067|Success|RDP|English - United States|RDP 5.1|ISD2-KM84178|55274-OEM-0011903-00107|1152|864|15bit|RSA|1|T|High|128bit</test_message>
          <test_value name='i0'>10.226.41.226</test_value>
          <test_value name='i1'>10446</test_value>
          <test_value name='i2'>10.226.24.52</test_value>
          <test_value name='i3'>3389</test_value>
          <test_value name='s0'>Success</test_value>
          <test_value name='s1'>RDP</test_value>
          <test_value name='s2'>English - United States</test_value>
          <test_value name='s3'>RDP 5.1</test_value>
          <test_value name='s4'>ISD2-KM84178</test_value>
          <test_value name='i4'>1152</test_value>
          <test_value name='i5'>864</test_value>
          <test_value name='s5'>High</test_value>
        </example>
      </examples>
    </rule>
  </rules>
</ruleset><ruleset name='bro_conn' id='20'>
  <pattern>bro_conn</pattern>
    <rules>
      <rule class='20' id='20'>
        <patterns>
          <pattern>@ESTRING::|@@ESTRING::|@@ESTRING:i0:|@@ESTRING:i1:|@@ESTRING:i2:|@@ESTRING:i3:|@@ESTRING:i4:|@@ESTRING:s0:|@@ESTRING:s1:|@@ESTRING:s2:|@@ESTRING:i5:|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING:s3:|@@ESTRING::|@@ESTRING:s4:|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING:s5:|@</pattern>
          <pattern>@ESTRING::|@@ESTRING::|@@ESTRING:i0:|@@ESTRING:i1:|@@ESTRING:i2:|@@ESTRING:i3:|@@ESTRING:i4:|@</pattern>
        </patterns>
        <examples>
          <example>
            <test_message program='bro_conn'>1319824864.447838|g6XHk1uplZc|10.0.0.0|19427|80.175.58.76|80|tcp|...</test_message>
              <test_value name='i0'>10.0.0.0</test_value>
              <test_value name='i1'>19427</test_value>
              <test_value name='i2'>80.175.58.76</test_value>
              <test_value name='i3'>80</test_value>
              <test_value name='i4'>tcp</test_value>
           </example>
           <example>
             <test_message program='bro_conn'>1355091922.994655|fOFtbJ91cG7|192.168.1.103|52949|206.12.19.9|80|tcp|http|3.970039|2829|574725|SF|-|-|3706|ShADadFf|200|14697|403|591995|(empty)|US|RU|</test_message>
             <test_value name='i0'>192.168.1.103</test_value>
             <test_value name='i1'>52949</test_value>
             <test_value name='i2'>206.12.19.9</test_value>
             <test_value name='i3'>80</test_value>
             <test_value name='i4'>tcp</test_value>
             <test_value name='s0'>http</test_value>
             <test_value name='s1'>3.970039</test_value>
             <test_value name='s2'>2829</test_value>
             <test_value name='i5'>574725</test_value>
             <test_value name='s3'>200</test_value>
             <test_value name='s4'>403</test_value>
             <test_value name='s5'>RU</test_value>
           </example>
        </examples>
     </rule>
  </rules>
</ruleset><ruleset name='CISCO_VPN' id='36'>
   <pattern>ossec_archive</pattern>
        <rules>
                <rule provider='ELSA' class='36' id='36'>
                <patterns>
                <pattern>@ESTRING::ASA-@@ESTRING::Group &lt;@@ESTRING:s0:&gt; User &lt;@@ESTRING:s1:&gt; IP &lt;@@IPv4:i0:&gt;@</pattern>
                <pattern>@ESTRING::ASA-@@ESTRING::Group = @@ESTRING:s0:, Username = @@ESTRING:s1:, IP = @@IPv4:i0:, @</pattern>
                </patterns>
                <examples>
                        <example>
                        <test_message program='ossec_archive'>2015 Jul 04 06:49:32 ossec-&gt;10.1.2.3 Jul 04 2015 06:49:32: %ASA-3-713167: Group = CISCO_VPN, Username = CONTOSO\\bsmith, IP = 1.1.1.1, Remote peer has failed user authentication - check configured username and password</test_message>
                        <test_value name='s0'>CISCO_VPN</test_value>
                        <test_value name='s1'>CONTOSO\\bsmith</test_value>
                        <test_value name='i0'>1.1.1.1</test_value>
                        </example>
                        <example>
                        <test_message program='ossec_archive'>2015 Jul 04 06:49:32 ossec-&gt;10.1.2.3 Jul 04 2015 06:49:32: %ASA-3-713167: Group = CISCO_VPN, Username = bsmith, IP = 1.1.1.1, Remote peer has failed user authentication - check configured username and password</test_message>
                        <test_value name='s0'>CISCO_VPN</test_value>
                        <test_value name='s1'>bsmith</test_value>
                        <test_value name='i0'>1.1.1.1</test_value>
                        </example>
                        <example>
                        <test_message program='ossec_archive'>2015 Jul 04 20:10:09 ossec-&gt;10.1.2.3 Jul 04 2015 20:10:09: %ASA-6-716002: Group &lt;CISCO_ANY-Connect&gt; User &lt;bsmith@contoso.com&gt; IP &lt;1.1.1.1&gt; WebVPN session terminated: Idle Timeout.</test_message>
                        <test_value name='s0'>CISCO_ANY-Connect</test_value>
                        <test_value name='s1'>bsmith@contoso.com</test_value>
                        <test_value name='i0'>1.1.1.1</test_value>
                        </example>
                        <example>
                        <test_message program='ossec_archive'>2015 Jul 03 21:53:27 ossec-&gt;10.1.2.3 Jul 03 2015 21:53:27: %ASA-4-113019: Group = CISCO_VPN, Username = bsmith@contoso.com, IP = 1.1.1.1, Session disconnected. Session Type: IPsecOverNatT, Duration: 1h:24m:44s, Bytes xmt: 646652, Bytes rcv: 3905286, Reason: User Requested</test_message>
                        <test_value name='s0'>CISCO_VPN</test_value>
                        <test_value name='s1'>bsmith@contoso.com</test_value>
                        <test_value name='i0'>1.1.1.1</test_value>
                        </example>
                        <example>
                        <test_message program='ossec_archive'>2015 Jul 04 05:48:11 ossec-&gt;10.1.2.3 Jul 04 2015 05:48:11: %ASA-6-713228: Group = CISCO_VPN, Username = bsmith@contoso.com, IP = 1.1.1.1, Assigned private IP address 10.1.2.15 to remote user</test_message>
                        <test_value name='s0'>CISCO_VPN</test_value>
                        <test_value name='s1'>bsmith@contoso.com</test_value>
                        <test_value name='i0'>1.1.1.1</test_value>
                        </example>
                        <example>
                        <test_message program='ossec_archive'>2015 Jul 04 15:22:50 ossec-&gt;10.1.2.3 Jul 04 2015 15:22:50: %ASA-4-722051: Group &lt;CISCO_ANY-Connect&gt; User &lt;bsmith@contoso.com&gt; IP &lt;1.1.1.1&gt; IPv4 Address &lt;10.1.2.10&gt; IPv6 address &lt;::&gt; assigned to session</test_message>
                        <test_value name='s0'>CISCO_ANY-Connect</test_value>
                        <test_value name='s1'>bsmith@contoso.com</test_value>
                        <test_value name='i0'>1.1.1.1</test_value>
                        </example>
                    </examples>
                </rule>
        </rules>
</ruleset><ruleset name='bro_ssh' id='26007'>
  <pattern>bro_ssh</pattern>
  <rules>
    <rule provider='Security_Onion' class='26007' id='26007'>
      <patterns>
        <pattern>@ESTRING::|@@ESTRING::|@@ESTRING:i0:|@@ESTRING:i1:|@@ESTRING:i2:|@@ESTRING:i3:|@@ESTRING::|@@ESTRING:s0:|@@ESTRING::|@@ESTRING:s1:|@@ESTRING:s2:|@@ESTRING:s3:|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING:s4:|@@ESTRING:s5:|@@ESTRING::|@@ESTRING::@</pattern>
      </patterns>
      <examples>
        <example>
          <test_message program='bro_ssh'>1481232333.626584|CYKycoFzezsF36eH6|192.168.1.32|58641|131.103.20.168|22|2|F|1|OUTBOUND|SSH-2.0-OpenSSH_6.7|SSH-2.0-OpenSSH_5.3|aes128-ctr|hmac-md5|none|diffie-hellman-group-exchange-sha256|ssh-rsa|97:8c:1b:f2:6f:14:6b:5c:3b:ec:aa:46:46:74:7c:40|US|-|-|-|-</test_message>
          <test_value name='i0'>192.168.1.32</test_value>
          <test_value name='i1'>58641</test_value>
          <test_value name='i2'>131.103.20.168</test_value>
          <test_value name='i3'>22</test_value>
          <test_value name='s0'>F</test_value>
          <test_value name='s1'>OUTBOUND</test_value>
          <test_value name='s2'>SSH-2.0-OpenSSH_6.7</test_value>
          <test_value name='s3'>SSH-2.0-OpenSSH_5.3</test_value>
          <test_value name='s4'>US</test_value>
          <test_value name='s5'>-</test_value>
        </example>
      </examples>
    </rule>
  </rules>
</ruleset><ruleset name='CISCO_BOTNET' id='12002'>
   <pattern>ossec_archive</pattern>
        <rules>
                <rule provider='ELSA' class='12002' id='12002'>
                <patterns>
                        <pattern>@ESTRING::ASA-4-338@@ESTRING:: blacklisted @@ESTRING:i0: @@ESTRING:::@@ESTRING::__@@IPv4:i1:_@@ESTRING::/@@ESTRING:i2: (@@ESTRING::OUTSIDE:@@ESTRING:i3:/@@ESTRING:i4: (@@ESTRING::dynamic list: @@ESTRING:s0:,@@ESTRING::threat-level: @@ESTRING:s1:,@@ESTRING::category: @@ANYSTRING:s2:@</pattern>
                        <pattern>@ESTRING::ASA-4-338@@ESTRING:: blacklisted @@ESTRING:i0: @@ESTRING:::@@ESTRING:i1:/@@ESTRING:i2: (@@ESTRING::OUTSIDE:@@ESTRING:i3:/@@ESTRING:i4: (@@ESTRING::dynamic list: @@ESTRING:s0:,@@ESTRING::threat-level: @@ESTRING:s1:,@@ESTRING::category: @@ANYSTRING:s2:@</pattern>
                        <pattern>@ESTRING::ASA-4-338@@ESTRING:: greylisted @@ESTRING:i0: @@ESTRING:::@@ESTRING::__@@IPv4:i1:_@@ESTRING::/@@ESTRING:i2: (@@ESTRING::OUTSIDE:@@ESTRING:i3:/@@ESTRING:i4: (@@ESTRING::dynamic list: @@ESTRING:s0:,@@ESTRING::threat-level: @@ESTRING:s1:,@@ESTRING::category: @@ANYSTRING:s2:@</pattern>
                        <pattern>@ESTRING::ASA-4-338@@ESTRING:: greylisted @@ESTRING:i0: @@ESTRING:::@@ESTRING:i1:/@@ESTRING:i2: (@@ESTRING::OUTSIDE:@@ESTRING:i3:/@@ESTRING:i4: (@@ESTRING::dynamic list: @@ESTRING:s0:,@@ESTRING::threat-level: @@ESTRING:s1:,@@ESTRING::category: @@ANYSTRING:s2:@</pattern>
                </patterns>
                <examples>
                        <example>
                                <test_message program='ossec_archive'>2016 Oct 09 00:37:27 ossec-colo-&gt;10.1.1.2 Oct 09 2016 00:37:26: %ASA-4-338202: Dynamic Filter monitored greylisted UDP traffic from DMZ:10.1.1.1/59962 (10.1.1.1/59962) to OUTSIDE:1.1.1.1/53 (1.1.1.1/53), destination 1.1.1.1 resolved from dynamic list: test.test.com, threat-level: very-high, category: Malware</test_message>
                                <test_value name='i0'>UDP</test_value>
                                <test_value name='i1'>10.1.1.1</test_value>
                                <test_value name='i2'>59962</test_value>
                                <test_value name='i3'>1.1.1.1</test_value>
                                <test_value name='i4'>53</test_value>
                                <test_value name='s0'>test.test.com</test_value>
                                <test_value name='s1'>very-high</test_value>
                                <test_value name='s2'>Malware</test_value>
                        </example>
                        <example>
                                <test_message program='ossec_archive'>2016 Oct 07 03:34:42 ossec-colo-&gt;10.1.1.2 Oct 07 2016 03:34:41: %ASA-4-338006: Dynamic Filter dropped blacklisted TCP traffic from INSIDE:10.1.1.1/60239 (10.1.1.1/60239) to OUTSIDE:1.1.1.1/80 (1.1.1.1/80), destination 1.1.1.1 resolved from dynamic list: test.test.com, threat-level: very-high, category: Malware</test_message>
                                <test_value name='i0'>TCP</test_value>
                                <test_value name='i1'>10.1.1.1</test_value>
                                <test_value name='i2'>60239</test_value>
                                <test_value name='i3'>1.1.1.1</test_value>
                                <test_value name='i4'>80</test_value>
                                <test_value name='s0'>test.test.com</test_value>
                                <test_value name='s1'>very-high</test_value>
                                <test_value name='s2'>Malware</test_value>
                        </example>
                        <example>
                                <test_message program='ossec_archive'>2015 Nov 03 19:57:07 ossec-colo-&gt;10.1.1.2 Oct 08 2016 22:37:54: %ASA-4-338002: Dynamic Filter monitored blacklisted TCP traffic from INSIDE:10.1.1.1/59293 (10.1.1.1/59293) to OUTSIDE:1.1.1.1/80 (1.1.1.1/80), destination 1.1.1.1 resolved from dynamic list: test.test.com, threat-level: very-high, category: Malware</test_message>
                                <test_value name='i0'>TCP</test_value>
                                <test_value name='i1'>10.1.1.1</test_value>
                                <test_value name='i2'>59293</test_value>
                                <test_value name='i3'>1.1.1.1</test_value>
                                <test_value name='i4'>80</test_value>
                                <test_value name='s0'>test.test.com</test_value>
                                <test_value name='s1'>very-high</test_value>
                                <test_value name='s2'>Malware</test_value>
                        </example>
                        <example>
                                <test_message program='ossec_archive'>2016 Oct 11 15:35:22 ossec-colo-&gt;10.1.1.2 Oct 11 2016 15:35:20: %ASA-4-338002: Dynamic Filter monitored blacklisted UDP traffic from INSIDE:IP__10.1.1.1__BLAH-SERVER-1/58845 (IP__10.1.1.1__BLAH-SERVER-1/58845) to OUTSIDE:1.1.1.1/53 (1.1.1.1/53), destination 1.1.1.1 resolved from dynamic list: test.test.com, threat-level: very-high, category: Malware</test_message>
                                <test_value name='i0'>UDP</test_value>
                                <test_value name='i1'>10.1.1.1</test_value>
                                <test_value name='i2'>58845</test_value>
                                <test_value name='i3'>1.1.1.1</test_value>
                                <test_value name='i4'>53</test_value>
                                <test_value name='s0'>test.test.com</test_value>
                                <test_value name='s1'>very-high</test_value>
                                <test_value name='s2'>Malware</test_value>
                        </example>
                    </examples>
                </rule>
        </rules>
</ruleset><ruleset name='bro_files' id='26004'>
  <pattern>bro_files</pattern>
  <rules>
    <rule provider='Security_Onion' class='26004' id=''>
      <patterns>
        <pattern>@ESTRING::|@@ESTRING::|@@ESTRING:s0:|@@ESTRING:s1:|@@ESTRING::|@@ESTRING:s2:|@@ESTRING::|@@ESTRING::|@@ESTRING:s3:|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING:i0:|@@ESTRING:i1:|@@ESTRING:i2:|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING:s4:|@@ESTRING:s5:|@@ESTRING::|@@ESTRING::@</pattern>
      </patterns>
      <examples>
        <example>
          <test_message program='bro_files'>1383923319.119506|FTry8K3ieMrV1QUPn2|91.189.91.15|192.168.4.204|Ctb0Yv1hADRWfy1Azi|HTTP|0|MD5,SHA1|application/x-bzip2|-|0.019398|F|F|36108|36108|0|0|F|-|332d000fadab5132ad02ce39ee28db19|7d7d4694925ebec1e18d0c8eeb6b7286a4f518b9|-|-</test_message>
          <test_value name='s0'>91.189.91.15</test_value>
          <test_value name='s1'>192.168.4.204</test_value>
          <test_value name='s2'>HTTP</test_value>
          <test_value name='s3'>application/x-bzip2</test_value>
          <test_value name='i0'>36108</test_value>
          <test_value name='i1'>36108</test_value>
          <test_value name='i2'>0</test_value>
          <test_value name='s4'>332d000fadab5132ad02ce39ee28db19</test_value>
          <test_value name='s5'>7d7d4694925ebec1e18d0c8eeb6b7286a4f518b9</test_value>
        </example>
      </examples>
    </rule>
  </rules>
</ruleset><ruleset name='bro_ftp' id='26003'>
  <pattern>bro_ftp</pattern>
  <rules>
    <rule provider='Security_Onion' class='26003' id=''>
      <patterns>
        <pattern>@ESTRING::|@@ESTRING::|@@ESTRING:i0:|@@ESTRING:i1:|@@ESTRING:i2:|@@ESTRING:i3:|@@ESTRING::|@@ESTRING::|@@ESTRING:s0:|@@ESTRING:s1:|@@ESTRING:s2:|@@ESTRING::|@@ESTRING:i4:|@@ESTRING:s3:|@@ESTRING::|@@ESTRING::|@@ESTRING::@</pattern>
      </patterns>
      <examples>
        <example>
          <test_message program='bro_ftp'>1481292235.047413|CKDnGH1oOwkjKWnnAh|172.16.150.20|1367|66.32.119.38|21|jack|hidden|STOR|ftp://66.32.119.38/./1.txt|application/x-rar|-|226|Transfer complete.|-|-|-|-|FjZnCN1shh4C6dSLsj</test_message>
          <test_value name='i0'>172.16.150.20</test_value>
          <test_value name='i1'>1367</test_value>
          <test_value name='i2'>66.32.119.38</test_value>
          <test_value name='i3'>21</test_value>
          <test_value name='s0'>STOR</test_value>
          <test_value name='s1'>ftp://66.32.119.38/./1.txt</test_value>
          <test_value name='s2'>application/x-rar</test_value>
          <test_value name='i4'>226</test_value>
          <test_value name='s3'>Transfer complete.</test_value>
        </example>
      </examples>
    </rule>
  </rules>
</ruleset><ruleset>
                <pattern>bro_radius</pattern>
                <rules>
                        <rule class='26012' id='26012'>
                                <patterns>
					<pattern>@ESTRING::|@@ESTRING::|@@ESTRING:i0:|@@ESTRING:i1:|@@ESTRING:i2:|@@ESTRING:i3:|@@ESTRING:s0:|@@ESTRING:s1:|@@ESTRING:i4:|@@ESTRING:s2:|@@ESTRING:s3:@</pattern>
                                </patterns>
                                <examples>
                                        <example>
						<test_message program='bro_radius'>MESSAGE=1416329517.552658|CMi27H1K0v5bex0dwf|10.0.0.1|1645|10.0.0.100|1812|John.McGuirk|00:14:22:e9:54:5e|-|-|success</test_message>
                                                <test_value name='i0'>10.0.0.1</test_value>
                                                <test_value name='i1'>1645</test_value>
                                                <test_value name='i2'>10.0.0.100</test_value>
                                                <test_value name='i3'>1812</test_value>
                                                <test_value name='s0'>John.McGuirk</test_value>
                                                <test_value name='s1'>00:14:22:e9:54:5e</test_value>
                                                <test_value name='i4'>-</test_value>
                                                <test_value name='s2'>-</test_value>
                                                <test_value name='s3'>success</test_value>
                                        </example>
                                </examples>
                        </rule>
                </rules>
        </ruleset><ruleset name='bro_dhcp' id='26005'>
  <pattern>bro_dhcp</pattern>
  <rules>
    <rule provider='Security_Onion' class='26005' id=''>
      <patterns>
        <pattern>@ESTRING::|@@ESTRING::|@@ESTRING:i0:|@@ESTRING:i1:|@@ESTRING:i2:|@@ESTRING:i3:|@@ESTRING:s0:|@@ESTRING:i4:|@@ESTRING:i5:|@@ESTRING::@</pattern>
      </patterns>
      <examples>
        <example>
          <test_message program='bro_dhcp'>1383924349.866451|CSkyT134YyBJGhE174|192.168.4.192|68|192.168.4.254|67|00:0c:29:2d:3d:00|192.168.4.192|1800.000000|4142852124</test_message>
          <test_value name='i0'>192.168.4.192</test_value>
          <test_value name='i1'>68</test_value>
          <test_value name='i2'>192.168.4.254</test_value>
          <test_value name='i3'>67</test_value>
          <test_value name='s0'>00:0c:29:2d:3d:00</test_value>
          <test_value name='i4'>192.168.4.192</test_value>
          <test_value name='i5'>1800.000000</test_value>
        </example>
      </examples>
    </rule>
  </rules>
</ruleset><ruleset name='bro_intel' id='26009'>
  <pattern>bro_intel</pattern>
  <rules>
    <rule provider='Security_Onion' class='26009' id='26009'>
      <patterns>
        <pattern>@ESTRING::|@@ESTRING::|@@ESTRING:i0:|@@ESTRING:i1:|@@ESTRING:i2:|@@ESTRING:i3:|@@ESTRING:s0:|@@ESTRING:s1:|@@ESTRING:s2:|@@ESTRING::|@@ESTRING::|@@ESTRING:s3:|@</pattern>
      </patterns>
      <examples>
        <example>
          <test_message program='bro_intel'>1391104904.213081|C4lG181iOhPyUt50k8|172.24.248.101|52490|199.7.91.13|53|-|-|-|travel.msnhome.org|Intel::DOMAIN|DNS::IN_REQUEST|nsm.local-eth1-1|Mandiant APT1 Report</test_message>
          <test_message program='bro_intel'>1481139311.423700|Cj061w4HkGlt8jMm3|10.0.3.15|1029|192.168.1.1|53|www.honeynet.org|Intel::DOMAIN|DNS::IN_REQUEST|bro|Intel::DOMAIN|Test Domain|-|-|-</test_message>
          <test_value name='i0'>10.0.3.15</test_value>
          <test_value name='i1'>1029</test_value>
          <test_value name='i2'>192.168.1.1</test_value>
          <test_value name='i3'>53</test_value>
          <test_value name='s0'>www.honeynet.org</test_value>
          <test_value name='s1'>Intel::DOMAIN</test_value>
          <test_value name='s2'>DNS::IN_REQUEST</test_value>
          <test_value name='s3'>Test Domain</test_value>
        </example>
      </examples>
    </rule>
  </rules>
</ruleset><ruleset name='bro_syslog' id='26001'>
  <pattern>bro_syslog</pattern>
  <rules>
    <rule provider='Security_Onion' class='26001' id=''>
      <patterns>
        <pattern>@ESTRING::|@@ESTRING::|@@ESTRING:i0:|@@ESTRING:i1:|@@ESTRING:i2:|@@ESTRING:i3:|@@ESTRING::|@@ESTRING:s0:|@@ESTRING:s1:|@@ESTRING:s2:@</pattern>
      </patterns>
      <examples>
        <example>
          <test_message program='bro_syslog'>1375124439.324082|qPgVFtswmy3|172.16.12.1|514|172.16.12.131|514|udp|LOCAL0|INFO|Jul 29 19:00:39 pf: 00:00:00.000017 rule 1/0(match): block in on em7: (tos 0x0, ttl 112, id 10335, offset 0, flags [none], proto UDP (17), length 56)</test_message>
          <test_value name='i0'>172.16.12.1</test_value>
          <test_value name='i1'>514</test_value>
          <test_value name='i2'>172.16.12.131</test_value>
          <test_value name='i3'>514</test_value>
          <test_value name='s0'>LOCAL0</test_value>
          <test_value name='s1'>INFO</test_value>
          <test_value name='s2'>Jul 29 19:00:39 pf: 00:00:00.000017 rule 1/0(match): block in on em7: (tos 0x0, ttl 112, id 10335, offset 0, flags [none], proto UDP (17), length 56)</test_value>
        </example>
      </examples>
    </rule>
  </rules>
</ruleset><ruleset name='HIPS' id='12000'>
<pattern>ossec_archive</pattern>
<rules>
    <rule provider='ELSA' class='12000' id='12000'>
        <patterns>
            <pattern>@ESTRING::SymantecServer-&gt;@@ESTRING::SymantecServer @@ESTRING::: @@ESTRING:s0:,@@ESTRING::application: @@ESTRING:s2:,@@ESTRING::Local: @@IPv4:i0:@@ESTRING::Remote: ,Remote: @@IPv4:i2:@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING:i4:,@@ESTRING::User: @@ESTRING:s1:,@@ESTRING::Local Port @@NUMBER:i1:,@@ESTRING::Remote Port @@NUMBER:i3:,@@ESTRING::CIDS Signature string: @@ESTRING:s4:,@@ESTRING::Intrusion URL: @@ESTRING:s3:,@</pattern>
            <pattern>@ESTRING::SymantecServer-&gt;@@ESTRING::SymantecServer @@ESTRING::: @@ESTRING:s0:,@@ESTRING::MD5=@@ESTRING:s5:,@@ESTRING:s4:,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING:s2:,@@ESTRING::,@@ESTRING::,@@ESTRING:s3:,@@ESTRING::User: @@ESTRING:s1:,@@ESTRING::File size (bytes): @@NUMBER:i5:,@</pattern>
            <pattern>@ESTRING::SymantecServer-&gt;@@ESTRING::SymantecServer @@ESTRING::: @@ESTRING:s0:,@@ESTRING::,@@ESTRING::&quot;,@@ESTRING:s4:,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING:s2:,@@ESTRING::,@@ESTRING::,@@ESTRING:s3:,@@ESTRING::: @@ESTRING:s1:,@@ESTRING::,@@ESTRING::,@@ESTRING::): @@NUMBER:i5:,@</pattern>
            <pattern>@ESTRING::SymantecServer-&gt;@@ESTRING::SymantecServer @@ESTRING::: @@ESTRING:s0:,@@ESTRING::,@@ESTRING::,@@ESTRING:s4:,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING:s2:,@@ESTRING::,@@ESTRING::,@@ESTRING:s3:,@@ESTRING::: @@ESTRING:s1:,@@ESTRING::,@@ESTRING::,@@ESTRING::): @@NUMBER:i5:,@</pattern>
            <pattern>@ESTRING::SymantecServer-&gt;@@ESTRING::SymantecServer @@ESTRING::IP Address: @@IPv4:i0:@@ESTRING::Computer name: @@ESTRING:s0:,@@ESTRING::Risk name: @@ESTRING:s4:,@@ESTRING::,@@ESTRING:s2:,@@ESTRING::User: @@ESTRING:s1:,@@ESTRING::Application hash: @@ESTRING:s5:,@</pattern>
            <pattern>@ESTRING::SymantecServer-&gt;@@ESTRING::SymantecServer @@ESTRING::IP Address: @@IPv4:i0:@@ESTRING::Computer name: @@ESTRING:s0:,@@ESTRING::Risk name: @@ESTRING:s4:,@@ESTRING::,@@ESTRING:s2:,@@ESTRING::User: @@ESTRING:s1:,@</pattern>
            <pattern>@ESTRING::SymantecServer-&gt;@@ESTRING::SymantecServer @@ESTRING::: @@ESTRING:s0:,@@ESTRING::IPS,&quot;@@ESTRING:s4: File : &apos;@@ESTRING:s2:&apos;@</pattern>
            <pattern>@ESTRING::MALWAREBYTES@@ESTRING::HostName=@@ESTRING:s0:; @@ESTRING::IPAddress=@@IPv4:i0:@@ESTRING::ThreatName=@@ESTRING:s4:; @@ESTRING::LogonUser=@@ESTRING:s1:; @@ESTRING::Attacked application: @@ESTRING:s3:; @@ESTRING::Parent process name: @@ESTRING:s2:; @@ESTRING::Source=MBAE@@ESTRING::PayloadChecksum=;@</pattern>
            <pattern>@ESTRING::MALWAREBYTES@@ESTRING::HostName=@@ESTRING:s0:; @@ESTRING::IPAddress=@@IPv4:i0:@@ESTRING::ObjectScanned=@@ESTRING:s2:; @@ESTRING::ThreatName=@@ESTRING:s4:; @@ESTRING::LogonUser=@@ESTRING:s1:; @@ESTRING::Attacked application: @@ESTRING:s3:; @@ESTRING::Source=MBAE@@ESTRING::PayloadChecksum=@@ESTRING:s5:; @</pattern>
            <pattern>@ESTRING::MALWAREBYTES@@ESTRING::HostName=@@ESTRING:s0:; @@ESTRING::IPAddress=@@IPv4:i0:@@ESTRING::ObjectScanned=@@IPv4:i2:@@ESTRING::ThreatName=@@ESTRING:s4:; @@ESTRING::IPBLOCK@@ESTRING::Port: @@NUMBER:i1:, @@ESTRING::Process: @@ESTRING:s2:; @@ESTRING::LogonUser=@@ESTRING:s1:; @</pattern>
            <pattern>@ESTRING::MALWAREBYTES@@ESTRING::HostName=@@ESTRING:s0:; @@ESTRING::IPAddress=@@IPv4:i0:@@ESTRING::ObjectScanned=@@ESTRING:s2:; @@ESTRING::ThreatName=@@ESTRING:s4:; @@ESTRING::DETECTION@@ESTRING::LogonUser=@@ESTRING:s1:; @</pattern>
        </patterns>
        <examples>
            <example>
                <test_message program='ossec_archive'>2015 Nov 12 20:58:57 SymantecServer-&gt;10.0.0.1 Nov 12 14:49:49 SymantecServer SERVER01: CLIENT01,Category: 2,IPS,&quot;[Intrusion prevention submission] Information submitted to Symantec about file. File : &apos;\\??\\C:\\windows\\system32\\mshtml.dll&apos;,&quot;</test_message>
                <test_value name='s0'>CLIENT01</test_value>
                <test_value name='s2'>\\??\\C:\\windows\\system32\\mshtml.dll</test_value>
                <test_value name='s4'>[Intrusion prevention submission] Information submitted to Symantec about file.</test_value>
            </example>
            <example>
                <test_message program='ossec_archive'>2015 Nov 11 17:58:18 SymantecServer-&gt;10.0.0.1 Nov 11 11:49:56 SymantecServer SERVER01: Compressed File,IP Address: 10.0.0.5,Computer name: CLIENT01,Source: Scheduled Scan,Risk name: Trojan.Gen.2,Occurrences: 1,D:\\E-mails 03- 07-15 to 06-11-15\\stuff here\\stuff there.msg,&apos;Still contains 1 infected items&apos;,Actual action: Quarantined,Requested action: Quarantined,Secondary action: Left alone,Event time: 2015-11-11 17:47:42,Inserted: 2015-11-11 17:49:56,End: 2015-11-11 17:47:42,Last update time: 2015-11-11 17:49:56,Domain: Default,Group: My Company\\Client Machines,Server: SERVER01,User: user01,Source computer: ,Source IP: ,Disposition: Good,Download site: null,Web domain: null,Downloaded by: null,Prevalence: Reputation was not used in this detection.,Confidence: Reputation was not used in this detection.,URL Tracking Status: Off,,First Seen: Reputation was not used in this detection.,Sensitivity: Low,MDS,Application hash: ,Hash type: SHA1,Company name: ,Application name: ,Application version: ,Application type: -1,F</test_message>
                <test_value name='i0'>10.0.0.5</test_value>
                <test_value name='s0'>CLIENT01</test_value>
                <test_value name='s1'>user01</test_value>
                <test_value name='s2'>D:\\E-mails 03- 07-15 to 06-11-15\\stuff here\\stuff there.msg</test_value>
                <test_value name='s3'></test_value>
                <test_value name='s4'>Trojan.Gen.2</test_value>
            </example>
            <example>
                <test_message program='ossec_archive'>2015 Nov 12 21:29:12 SymantecServer-&gt;10.0.0.1 Nov 12 15:17:16 SymantecServer SERVER01: CLIENT01,[SID: 28878] System Infected: Downloader.Upatre Activity 19 attack blocked. Traffic has been blocked for this application: C:\\WINDOWS\\SYSWOW64\\SVCHOST.EXE,Local: 10.0.0.5,Local: 000000000000,Remote: ,Remote: 87.233.175.114,Remote: 000000000000,Inbound,TCP,Intrusion ID: 0,Begin: 2015-11-11 08:15:29,End: 2015-11-11 08:15:38,Occurrences: 2,Application: C:/WINDOWS/SYSWOW64/SVCHOST.EXE,Location: Remote Policy,User: user01,Domain: CONTOSO,Local Port 52853,Remote Port 443,CIDS Signature ID: 28878,CIDS Signature string: System Infected: Downloader.Upatre Activity 19,CIDS Signature SubID: 65766,Intrusion URL: ,Intrusion Payload URL:</test_message>
                <test_value name='i0'>10.0.0.5</test_value>
                <test_value name='i1'>52853</test_value>
                <test_value name='i2'>87.233.175.114</test_value>
                <test_value name='i3'>443</test_value>
                <test_value name='i4'>TCP</test_value>
                <test_value name='s0'>CLIENT01</test_value>
                <test_value name='s1'>user01</test_value>
                <test_value name='s2'>C:\\WINDOWS\\SYSWOW64\\SVCHOST.EXE</test_value>&gt;
                <test_value name='s4'>System Infected: Downloader.Upatre Activity 19</test_value>
            </example>
            <example>
                <test_message program='ossec_archive'>2015 Nov 13 08:00:04 SymantecServer-&gt;10.0.0.1 Nov 13 01:44:30 SymantecServer SERVER01: CLIENT01,[SID: 27892] Web Attack: Malicious File Download 24 attack blocked. Traffic has been blocked for this application: C:\\PROGRAM FILES (X86)\\GOOGLE\\CHROME\\APPLICATION\\CHROME.EXE,Local: 10.0.0.5,Local: 000000000000,Remote: ,Remote: 83.147.162.230,Remote: 000000000000,Inbound,TCP,Intrusion ID: 0,Begin: 2015-11-12 16:30:37,End: 2015-11-12 16:30:37,Occurrences: 1,Application: C:/PROGRAM FILES (X86)/GOOGLE/CHROME/APPLICATION/CHROME.EXE,Location: Remote Policy,User: user01,Domain: CONTOSO,Local Port 52159,Remote Port 80,CIDS Signature ID: 27892,CIDS Signature string: Web Attack: Malicious File Download 24,CIDS Signature SubID: 69836,Intrusion URL: adrotate.se/?placement=401027&amp;cookie=1&amp;random=90546&amp;domain=bfd69dd9.se,Intrusion Payload URL:</test_message>
                <test_value name='i0'>10.0.0.5</test_value>
                <test_value name='i1'>52159</test_value>
                <test_value name='i2'>83.147.162.230</test_value>
                <test_value name='i3'>80</test_value>
                <test_value name='i4'>TCP</test_value>
                <test_value name='s0'>CLIENT01</test_value>
                <test_value name='s1'>user01</test_value>
                <test_value name='s2'>C:\\PROGRAM FILES (X86)\\GOOGLE\\CHROME\\APPLICATION\\CHROME.EXE</test_value>
                <test_value name='s3'>adrotate.se/?placement=401027&amp;cookie=1&amp;random=90546&amp;domain=bfd69dd9.se</test_value>
                <test_value name='s4'>Web Attack: Malicious File Download 24</test_value>
            </example>
            <example>
                <test_message program='ossec_archive'>2015 Nov 11 05:27:09 SymantecServer-&gt;10.0.0.1 Nov 10 23:25:29 SymantecServer SERVER01: CLIENT01,Blocked, - Caller MD5=b96c17b5dc1424d56eea3a99e97428cd,File Delete,Begin: 2015-11-09 20:44:20,End: 2015-11-09 20:44:22,Rule: Windows processes protection | [AC19-1.1] Block writing code,1528,C:/Windows/System32/spoolsv.exe,0,No Module Name,C:/Windows/System32/spool/drivers/x64/3/Old/1/mxdwdrv.dll,User: SYSTEM,Domain: CONTOSO,Action Type: ,File size (bytes): 715776,Device ID: IDE\\DiskHITACHI_HTS723232A7A364_________________EC2ZB70B\\4&amp;183b99bf&amp;0&amp;0.0.0</test_message>
                <test_value name='i5'>715776</test_value>
                <test_value name='s0'>CLIENT01</test_value>
                <test_value name='s1'>SYSTEM</test_value>
                <test_value name='s2'>C:/Windows/System32/spoolsv.exe</test_value>
                <test_value name='s3'>C:/Windows/System32/spool/drivers/x64/3/Old/1/mxdwdrv.dll</test_value>
                <test_value name='s4'>File Delete</test_value>
                <test_value name='s5'>b96c17b5dc1424d56eea3a99e97428cd</test_value>
            </example>
            <example>
                <test_message program='ossec_archive'>2015 Nov 15 10:17:10 (SERVER01) 10.0.0.1-&gt;\\ProgramData/logs/mbytes_adm151115.log MALWAREBYTES ClientSecurityLog ID=1246852; ClientID=328ACDF8-4BA5-4562-8C06-89A954DA75AF; HostName=CLIENT01; Domain=contoso.com; MacAddress=B4-B5-2F-AA-55-B4; IPAddress=10.0.0.5; Time=Jul 28 2015 7:42AM; ThreatLevel=1; ObjectTypeScanned=0; ObjectScanned=; ThreatName=Exploit memory HeapSpray attempt blocked; Event=DETECTION; Action=1; Operation=BLOCK; IsResolved=1; LogonUser=user01; Data=data; Description=Attacked application: C:\\Program Files (x86)\\Mozilla Firefox\\firefox.exe; Parent process name: explorer.exe; Layer: Application Hardening; API ID: 900; Address: 0x20200000; Module: ; AddressType: ; StackTop: 0x06AA0000; StackBottom: 0x06A9C000; StackPointer: ; Extra: ; Application=Mozilla Firefox; ApplicationFullPath=C:\\Program Files (x86)\\Mozilla Firefox\\firefox.exe; Source=MBAE; Payload=; PayloadChecksum=; PayloadUrl=; PayloadProc=</test_message>
                <test_value name='i0'>10.0.0.5</test_value>
                <test_value name='s0'>CLIENT01</test_value>
                <test_value name='s1'>user01</test_value>
                <test_value name='s2'>explorer.exe</test_value>
                <test_value name='s3'>C:\\Program Files (x86)\\Mozilla Firefox\\firefox.exe</test_value>
                <test_value name='s4'>Exploit memory HeapSpray attempt blocked</test_value>
            </example>
            <example>
                <test_message program='ossec_archive'>2015 Nov 15 11:30:18 (SERVER01) 10.0.0.1-&gt;\\ProgramData/logs/mbytes_adm151115.log MALWAREBYTES ClientSecurityLog ID=1252508; ClientID=045E1A2A-EA54-4F32-8539-76E3897E6CAE; HostName=CLIENT01; Domain=contoso.com; MacAddress=BE-92-FF-DB-DA-63; IPAddress=10.0.0.5; Time=Nov 12 2015 5:23AM; ThreatLevel=1; ObjectTypeScanned=3; ObjectScanned=C:\\PROGRAM FILES (X86)\\FOXIT SOFTWARE\\FOXIT PHANTOMPDF\\plugins\\phc.dll; ThreatName=Exploit payload file blocked; Event=DETECTION; Action=1; Operation=BLOCK; IsResolved=1; LogonUser=user01; Data=data; Description=Attacked application: C:\\PROGRAM FILES (X86)\\FOXIT SOFTWARE\\FOXIT PHANTOMPDF\\FOXITPHANTOMPDF.EXE; Parent process name: explorer.exe; Layer: Application Behavior Protection; API ID: 301; Address: ; Module: ; AddressType: ; StackTop: ; StackBottom: ; StackPointer: ; Extra: ; Application=FOXITPHANTOMPDF.EXE; ApplicationFullPath=C:\\PROGRAM FILES (X86)\\FOXIT SOFTWARE\\FOXIT PHANTOMPDF\\FOXITPHANTOMPDF.EXE; Source=MBAE; Payload=C:\\PROGRAM FILES (X86)\\FOXIT SOFTWARE\\FOXIT PHANTOMPDF\\plugins\\phc.dll; PayloadChecksum=BE8981EEB84FD419661C6A441568750C; PayloadUrl=; PayloadProc=</test_message>
                <test_value name='i0'>10.0.0.5</test_value>
                <test_value name='s0'>CLIENT01</test_value>
                <test_value name='s1'>user01</test_value>
                <test_value name='s2'>C:\\PROGRAM FILES (X86)\\FOXIT SOFTWARE\\FOXIT PHANTOMPDF\\plugins\\phc.dll</test_value>
                <test_value name='s3'>C:\\PROGRAM FILES (X86)\\FOXIT SOFTWARE\\FOXIT PHANTOMPDF\\FOXITPHANTOMPDF.EXE</test_value>
                <test_value name='s4'>Exploit payload file blocked</test_value>
                <test_value name='s5'>BE8981EEB84FD419661C6A441568750C</test_value>
            </example>
            <example>
                <test_message program='ossec_archive'>2015 Nov 11 05:07:24 (SERVER01) 10.0.0.1-&gt;\\ProgramData/logs/mbytes_adm151111.log MALWAREBYTES ClientSecurityLog ID=1009446; ClientID=4ABA24B5-A6BE-4576-B1B4-50E8CC947221; HostName=CLIENT01; Domain=contoso.com; MacAddress=E8-B1-FC-F2-B3-C2; IPAddress=10.0.0.5; Time=Nov 11 2015 11:19AM; ThreatLevel=0; ObjectTypeScanned=0; ObjectScanned=121.123.120.93; ThreatName=Blocked web site; Event=IPBLOCK; Action=1; Operation=Type: outgoing, Port: 52807, Process: 360se.exe; IsResolved=1; LogonUser=user01; Data=data; Description=121.123.120.93 (Type: outgoing, Port: 52807, Process: 360se.exe); Application=; ApplicationFullPath=; Source=MBAM; Payload=; PayloadChecksum=; PayloadUrl=; PayloadProc=</test_message>
                <test_value name='i0'>10.0.0.5</test_value>
                <test_value name='i1'>52807</test_value>
                <test_value name='i2'>121.123.120.93</test_value>
                <test_value name='s0'>CLIENT01</test_value>
                <test_value name='s1'>user01</test_value>
                <test_value name='s2'>360se.exe</test_value>
                <test_value name='s4'>Blocked web site</test_value>
            </example>
            <example>
                <test_message program='ossec_archive'>2015 Nov 11 03:37:34 (SERVER01) 10.0.0.1-&gt;\\ProgramData/logs/mbytes_adm151111.log MALWAREBYTES ClientSecurityLog ID=1004085; ClientID=7E8D58A3-7DF6-4502-AF1F-B205A34C0F0F; HostName=CLIENT01; Domain=contoso.com; MacAddress=6C-B8-14-A0-6B-B4; IPAddress=10.0.0.5; Time=Nov 11 2015  9:05AM; ThreatLevel=1; ObjectTypeScanned=2; ObjectScanned=C:\\Users\\user01\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Extensions\\cigiagpbkapepgklncnajbakkpkopmam\\0.1_0; ThreatName=PUP.Optional.CrossRider; Event=DETECTION; Action=2; Operation=QUARANTINE; IsResolved=1; LogonUser=user01; Data=data; Description=No description; Application=; ApplicationFullPath=; Source=MBAM; Payload=; PayloadChecksum=; PayloadUrl=; PayloadProc=</test_message>
                <test_value name='i0'>10.0.0.5</test_value>
                <test_value name='s0'>CLIENT01</test_value>
                <test_value name='s1'>user01</test_value>
                <test_value name='s2'>C:\\Users\\user01\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Extensions\\cigiagpbkapepgklncnajbakkpkopmam\\0.1_0</test_value>
                <test_value name='s4'>PUP.Optional.CrossRider</test_value>
            </example>
            <example>
                <test_message program='ossec_archive'>2015 Nov 12 04:43:29 SymantecServer-&gt;10.0.0.1 Nov 11 22:28:25 SymantecServer SERVER01: CLIENT01,Blocked,&quot;[AC2-1.1] List all applications you want to block below, by clicking the Add button.&quot;,Create Process,Begin: 2015-11-10 05:43:25,End: 2015-11-10 05:43:25,Rule: Block applications from running | [AC2-1.1] Block these applications,4400,C:/Program Files (x86)/Internet Explorer/iexplore.exe,0,No Module Name,C:/Program Files (x86)/Google/Google Toolbar/GoogleToolbarUser_32.exe,User: user01,Domain: CONTOSO,Action Type: ,File size (bytes): 309704,Device ID: SCSI\\Disk&amp;Ven_ATA&amp;Prod_MTFDDAK256MAM-1K\\4&amp;35303def&amp;0&amp;000000</test_message>
                <test_value name='i5'>309704</test_value>
                <test_value name='s0'>CLIENT01</test_value>
                <test_value name='s1'>user01</test_value>
                <test_value name='s2'>C:/Program Files (x86)/Internet Explorer/iexplore.exe</test_value>
                <test_value name='s3'>C:/Program Files (x86)/Google/Google Toolbar/GoogleToolbarUser_32.exe</test_value>
                <test_value name='s4'>Create Process</test_value>
            </example>
            <example>
                <test_message program='ossec_archive'>2015 Nov 12 04:43:36 SymantecServer-&gt;10.0.0.1 Nov 11 22:40:25 SymantecServer SERVER01: CLIENT01,Blocked,[AC17-1.1] Prevent registration of new Toolbars,Registry Write,Begin: 2015-10-29 10:48:29,End: 2015-10-29 10:48:29,Rule: Prevent registration of new Toolbars | [AC17-1.1] Prevent registration of new Toolbars,32704,C:/Program Files (x86)/Google/Google Toolbar/Component/GoogleToolbarManager_32479C6A88E27044.exe,0,No Module Name,/REGISTRY/MACHINE/SOFTWARE/Microsoft/Internet Explorer/Toolbar,User: SYSTEM,Domain: CONTOSO,Action Type: ,File size (bytes): 0,Device ID: </test_message>
                <test_value name='i5'>0</test_value>
                <test_value name='s0'>CLIENT01</test_value>
                <test_value name='s1'>SYSTEM</test_value>
                <test_value name='s2'>C:/Program Files (x86)/Google/Google Toolbar/Component/GoogleToolbarManager_32479C6A88E27044.exe</test_value>
                <test_value name='s3'>/REGISTRY/MACHINE/SOFTWARE/Microsoft/Internet Explorer/Toolbar</test_value>
                <test_value name='s4'>Registry Write</test_value>
            </example>
            <example>
                <test_message program='ossec_archive'>2015 Nov 12 04:43:33 SymantecServer-&gt;10.27.201.97 Nov 11 22:35:05 SymantecServer drtexw97: CLIENT01,Blocked,[AC10-2.1] Block access to autorun.inf,File Read,Begin: 2015-11-11 11:04:30,End: 2015-11-11 11:04:30,Rule: All Applications | [AC10-2.1] Autorun.inf,8656,C:/Windows/explorer.exe,0,No Module Name,F:/autorun.inf,User: user01,Domain: CONTOSO,Action Type: ,File size (bytes): 0,Device ID: USBSTOR\\Disk&amp;Ven_Lexar&amp;Prod_USB_Flash_Drive&amp;Rev_1100\\AAKWACBQXXQIM4U1&amp;0</test_message>
                <test_value name='i5'>0</test_value>
                <test_value name='s0'>CLIENT01</test_value>
                <test_value name='s1'>user01</test_value>
                <test_value name='s2'>C:/Windows/explorer.exe</test_value>
                <test_value name='s3'>F:/autorun.inf</test_value>
                <test_value name='s4'>File Read</test_value>
            </example>
            <example>
                <test_message program='ossec_archive'>2015 Nov 12 19:43:30 SymantecServer-&gt;10.27.201.97 Nov 12 13:29:48 SymantecServer SERVER01: CLIENT01,Blocked,[AC1-2.1] Block process,Registry Write,Begin: 2015-11-04 12:23:46,End: 2015-11-04 12:23:46,Rule: Protect client files and registry keys | [AC1-2.1] Client services,2452,C:/Windows/SysWOW64/wbem/WmiPrvSE.exe,0,No Module Name,/REGISTRY/MACHINE/SYSTEM/CurrentControlSet/services/SRTSP/Performance,User: SYSTEM,Domain: CONTOSO,Action Type: ,File size (bytes): 0,Device ID: </test_message>
                <test_value name='i5'>0</test_value>
                <test_value name='s0'>CLIENT01</test_value>
                <test_value name='s1'>SYSTEM</test_value>
                <test_value name='s2'>C:/Windows/SysWOW64/wbem/WmiPrvSE.exe</test_value>
                <test_value name='s3'>/REGISTRY/MACHINE/SYSTEM/CurrentControlSet/services/SRTSP/Performance</test_value>
                <test_value name='s4'>Registry Write</test_value>
            </example>
        </examples>
    </rule>
</rules>
</ruleset><ruleset name='SYSMON' id='777'>
    <pattern>ossec_archive</pattern>
    <rules>
       <rule provider='DefensiveDepth-SYSMON3' class='10777' id='10777'>
                        <patterns>
                                <pattern>@NUMBER::@@ESTRING::(@@ESTRING::)@ @IPv4::@-&gt;WinEvtLog @ESTRING::(@@NUMBER::):@): @ESTRING:::@ SYSTEM: NT AUTHORITY: @ESTRING:s0::@ @ESTRING:: SequenceNumber:@ @NUMBER::@ @ESTRING:: SourceProcessGuid:@ {@ESTRING:s1:}@ @ESTRING:: SourceImage: @@ESTRING:s2:  TargetProcessGuid: {@@ESTRING:s3:}@@ESTRING:: TargetImage: @@ESTRING:s4:  NewThreadId:@</pattern>
                                <pattern>@NUMBER::@@ESTRING::(@@ESTRING::)@ @IPv4::@-&gt;WinEvtLog @ESTRING::(@@NUMBER::):@): @ESTRING:::@ SYSTEM: NT AUTHORITY: @ESTRING:s0:: @@ESTRING:: SourceProcessGuid:@ {@ESTRING:s1:}@ @ESTRING:: SourceImage: @@ESTRING:s2:  TargetProcessGuid: {@@ESTRING:s3:}@@ESTRING:: TargetImage: @@ESTRING:s4:  NewThreadId:@@ESTRING:: StartAddress:@@ESTRING:: StartModule: @@ESTRING:s5:  StartFunction:@</pattern>
                        </patterns>
                        <examples>
                                <example>
                                        <test_message program='ossec_archive'>2015 Jun 02 02:18:10 (windows7_x64) 192.168.142.6-&gt;WinEvtLog 2015 Jun 01 15:53:02 WinEvtLog: Microsoft-Windows-Sysmon/Operational: INFORMATION(8): Microsoft-Windows-Sysmon: SYSTEM: NT AUTHORITY: WIN-KTL39CHEPFC: CreateRemoteThread detected:  SequenceNumber: 599  UtcTime: 6/1/2015 09:53:02.371 PM  SourceProcessGuid: {F17228B0-CB16-556C-0000-0010A6A90000}  SourceProcessId: 468  SourceImage: C:\Windows\System32\csrss.exe  TargetProcessGuid: {F17228B0-CC30-556C-0000-0010B6510500}  TargetProcessId: 1668  TargetImage: C:\Windows\System32\cmd.exe  NewThreadId: 756</test_message>
                                                <test_value name='s0'>WIN-KTL39CHEPFC</test_value>
                                                <test_value name='s1'>F17228B0-CB16-556C-0000-0010A6A90000</test_value>
                                                <test_value name='s2'>C:\Windows\System32\csrss.exe</test_value>
                                                <test_value name='s3'>F17228B0-CC30-556C-0000-0010B6510500</test_value>
                                                <test_value name='s4'>C:\Windows\System32\cmd.exe</test_value>
                                </example>
                                <example>
                                        <test_message program='ossec_archive'>2015 Aug 08 16:41:28 (james_dell) 192.168.1.101-&gt;WinEvtLog 2015 Aug 08 10:41:25 WinEvtLog: Microsoft-Windows-Sysmon/Operational: INFORMATION(8): Microsoft-Windows-Sysmon: SYSTEM: NT AUTHORITY: james-laptop: CreateRemoteThread detected:  UtcTime: 2015-08-08 16:41:25.215  SourceProcessGuid: {16F5F390-BD09-55BF-0000-001019A80300}  SourceProcessId: 2688  SourceImage: C:\Windows\System32\wbem\WmiPrvSE.exe  TargetProcessGuid: {16F5F390-3135-55C6-0000-0010C123FC1A}  TargetProcessId: 225012  TargetImage: C:\Windows\System32\wbem\WmiApSrv.exe  NewThreadId: 226380  StartAddress: 0x00007FFE7EA30710  StartModule: C:\Windows\SYSTEM32\ntdll.dll  StartFunction: </test_message>
                                                <test_value name='s0'>james-laptop</test_value>
                                                <test_value name='s1'>16F5F390-BD09-55BF-0000-001019A80300</test_value>
                                                <test_value name='s2'>C:\Windows\System32\wbem\WmiPrvSE.exe</test_value>
                                                <test_value name='s3'>16F5F390-3135-55C6-0000-0010C123FC1A</test_value>
                                                <test_value name='s4'>C:\Windows\System32\wbem\WmiApSrv.exe</test_value>
                                                <test_value name='s5'>C:\Windows\SYSTEM32\ntdll.dll</test_value>
                                </example>
                        </examples>
                </rule>
        <rule provider='DefensiveDepth' class='10778' id='10778'>
            <patterns>
                <pattern>@NUMBER::@@ESTRING::(@@ESTRING::)@ @IPv4::@-&gt;WinEvtLog @ESTRING::Microsoft-Windows-Sysmon/Operational: INFORMATION(1):@@ESTRING:::@@ESTRING:::@@ESTRING:::@ @ESTRING:s0::@@ESTRING::{@@ESTRING:s1:}@@ESTRING::Image: @@ESTRING:s2:  CommandLine: @@ESTRING::CurrentDirectory: @@ESTRING::User: @@ESTRING:s3:  LogonGuid:@@ESTRING::Hashes: @@ESTRING:s4: @@ESTRING::ParentImage: @@ESTRING:s5:  ParentCommandLine:@</pattern>
            </patterns>
            <examples>
                <example>
                                    <test_message program='ossec_archive'>2015 Jul 13 13:27:17 (windows7_x64) 192.168.142.6-&gt;WinEvtLog 2015 Jul 13 07:27:16 WinEvtLog: Microsoft-Windows-Sysmon/Operational: INFORMATION(1): Microsoft-Windows-Sysmon: SYSTEM: NT AUTHORITY: WIN-KTL39CHEPFC: Process Create:  SequenceNumber: 472  UtcTime: 7/13/2015 01:27:16.823 PM  ProcessGuid: {F17228B0-BCB4-55A3-0000-001024551800}  ProcessId: 2208  Image: C:\Windows\System32\notepad.exe  CommandLine: notepad  CurrentDirectory: C:\Users\tester\  User: WIN-KTL39CHEPFC\tester  LogonGuid: {F17228B0-B2C7-55A3-0000-0020E54F0700}  LogonId: 0x74fe5  TerminalSessionId: 1  IntegrityLevel: Medium  Hashes: SHA1=7EB0139D2175739B3CCB0D1110067820BE6ABD29  ParentProcessGuid: {F17228B0-BCB2-55A3-0000-001089501800}  ParentProcessId: 3004  ParentImage: C:\Windows\System32\cmd.exe  ParentCommandLine: &quot;C:\Windows\system32\cmd.exe&quot;</test_message>
                                                <test_value name='s0'>WIN-KTL39CHEPFC</test_value>
                                                <test_value name='s1'>F17228B0-BCB4-55A3-0000-001024551800</test_value>
                                                <test_value name='s2'>C:\Windows\System32\notepad.exe</test_value>
                                                <test_value name='s3'>WIN-KTL39CHEPFC\tester</test_value>
                                                <test_value name='s4'>SHA1=7EB0139D2175739B3CCB0D1110067820BE6ABD29</test_value>
                                                <test_value name='s5'>C:\Windows\System32\cmd.exe</test_value>
                </example>
            </examples>
        </rule>
        <rule provider='DefensiveDepth' class='10779' id='10779'>
            <patterns>
                <pattern>@NUMBER::@@ESTRING::(@@ESTRING::)@ @IPv4::@-&gt;WinEvtLog @ESTRING::(@@NUMBER::):@): @ESTRING:::@@ESTRING:::@@ESTRING:::@ @ESTRING:s0::@@ESTRING::{@@ESTRING:s1:}@@ESTRING::Image: @@ESTRING:s2: User: @@ESTRING:s3: Protocol: @@ESTRING::: @@ESTRING:s4: @@ESTRING::SourceIp: @@ESTRING:: @@ESTRING::SourcePort: @@ESTRING:i0: @@ESTRING::DestinationIp: @@ESTRING:s5: @@ESTRING::DestinationPort: @@ESTRING:i1: @</pattern>
            </patterns>
            <examples>
                <example>
                    <test_message program='ossec_archive'>2014 Dec 02 20:28:31 (10.0.15.14) 10.0.15.14-&gt;WinEvtLog 2014 Dec 02 15:26:08 WinEvtLog: Microsoft-Windows-Sysmon/Operational:INFORMATION(3): Microsoft-Windows-Sysmon: SYSTEM: NT AUTHORITY: WIN-U93G48C7BOP: Network connection detected: UtcTime: 12/1/2014 9:03 PM ProcessGuid: {00000000-D426-547C-0000-00103DB40000} ProcessId: 868 Image: C:\Windows\system32\svchost.exe User: NT AUTHORITY\NETWORK SERVICE Protocol: udp Initiated: true SourceIsIpv6: true SourceIp: a00:f0e:0:0:1822:ad8d:1e0:ffff SourceHostname: SourcePort: 60352 SourcePortName: DestinationIsIpv6: true DestinationIp: a00:f01:7200:6500:6100:2000:4300:6f00 DestinationHostname: DestinationPort: 53 DestinationPortName: domain</test_message>
                    <test_value name='s0'>WIN-U93G48C7BOP</test_value>
                    <test_value name='s1'>00000000-D426-547C-0000-00103DB40000</test_value>
                    <test_value name='s2'>C:\Windows\system32\svchost.exe</test_value>
                    <test_value name='s3'>NT AUTHORITY\NETWORK SERVICE</test_value>
                    <test_value name='s4'>true</test_value>
                    <test_value name='i0'>60352</test_value>
                    <test_value name='s5'>a00:f01:7200:6500:6100:2000:4300:6f00</test_value>
                    <test_value name='i1'>53</test_value>
                </example>
            </examples>
        </rule>
       <rule provider='DefensiveDepth' class='10782' id='10782'>
                        <patterns>
                                <pattern>@NUMBER::@@ESTRING::(@@ESTRING::)@ @IPv4::@-&gt;WinEvtLog @ESTRING::Microsoft-Windows-Sysmon/Operational: INFORMATION(7): Microsoft-Windows-Sysmon: SYSTEM: NT AUTHORITY: @@ESTRING:s0:: @@ESTRING::ProcessGuid: {@@ESTRING:s1:} @@ESTRING:: Image: @@ESTRING:s2:  ImageLoaded: @@ESTRING:s3:  Hashes: @@ESTRING:s4: @@ESTRING:: Signed: @@ESTRING:s5: @</pattern>
                        </patterns>
                        <examples>
                                <example>
                                        <test_message program='ossec_archive'>2016 Jul 26 03:30:18 (win8-test) 192.168.1.76-&gt;WinEvtLog 2016 Jul 26 20:14:35 WinEvtLog: Microsoft-Windows-Sysmon/Operational: INFORMATION(7): Microsoft-Windows-Sysmon: SYSTEM: NT AUTHORITY: WIN-VL5U1V07CA7: Image loaded:  UtcTime: 2016-07-27 02:14:34.620  ProcessGuid: {B8CD0A89-D195-5796-0000-0010DDF71B00}  ProcessId: 3520  Image: C:\Windows\Sysmon.exe  ImageLoaded: C:\Windows\System32\FWPUCLNT.DLL  Hashes: SHA1=26DE7E214FE056327469E86D5D38AC744FB353FA,IMPHASH=89B1C5BA3C0EC10428AC86A1628A90EF  Signed: true  Signature: Microsoft Windows</test_message>
                                                <test_value name='s0'>WIN-VL5U1V07CA7</test_value>
                                                <test_value name='s1'>B8CD0A89-D195-5796-0000-0010DDF71B00</test_value>
                                                <test_value name='s2'>C:\Windows\Sysmon.exe</test_value>
                                                <test_value name='s3'>C:\Windows\System32\FWPUCLNT.DLL</test_value>
                                                <test_value name='s4'>SHA1=26DE7E214FE056327469E86D5D38AC744FB353FA,IMPHASH=89B1C5BA3C0EC10428AC86A1628A90EF</test_value>
                                                <test_value name='s5'>true</test_value>
                                </example>
                        </examples>
                </rule>
                 <rule provider='DefensiveDepth' class='10783' id='10783'>
                        <patterns>
                                <pattern>@NUMBER::@@ESTRING::(@@ESTRING::)@ @IPv4::@-&gt;WinEvtLog @ESTRING::Microsoft-Windows-Sysmon/Operational: INFORMATION(2): Microsoft-Windows-Sysmon: SYSTEM: NT AUTHORITY: @@ESTRING:s0:: @@ESTRING::ProcessGuid: {@@ESTRING:s1:} @@ESTRING:: Image: @@ESTRING:s2:  TargetFilename: @@ESTRING:s3:  CreationUtcTime: @@ESTRING:s4:  PreviousCreationUtcTime: @@ESTRING:s5:@</pattern>
                        </patterns>
                        <examples>
                                <example>
                                        <test_message program='ossec_archive'>2016 Jul 26 03:31:00 (win8-test) 192.168.1.76-&gt;WinEvtLog 2016 Jul 26 20:15:16 WinEvtLog: Microsoft-Windows-Sysmon/Operational: INFORMATION(2): Microsoft-Windows-Sysmon: SYSTEM: NT AUTHORITY: WIN-VL5U1V07CA7: File creation time changed:  UtcTime: 2016-07-27 02:15:16.727  ProcessGuid: {B8CD0A89-CDA9-5796-0000-001005E50500}  ProcessId: 3620  Image: C:\Program Files (x86)\Google\Chrome\Application\chrome.exe  TargetFilename: C:\Users\james\AppData\Roaming\Microsoft\Windows\Recent\CustomDestinations\6R7AY6B552FSY7NMWD0S.temp  CreationUtcTime: 2016-05-10 13:30:19.910  PreviousCreationUtcTime: 2016-07-27 02:15:16.727</test_message>
                                                <test_value name='s0'>WIN-VL5U1V07CA7</test_value>
                                                <test_value name='s1'>B8CD0A89-CDA9-5796-0000-001005E50500</test_value>
                                                <test_value name='s2'>C:\Program Files (x86)\Google\Chrome\Application\chrome.exe</test_value>
                                                <test_value name='s3'>C:\Users\james\AppData\Roaming\Microsoft\Windows\Recent\CustomDestinations\6R7AY6B552FSY7NMWD0S.temp</test_value>
                                </example>
                        </examples>
                </rule>
                 <rule provider='DefensiveDepth' class='10784' id='10784'>
                        <patterns>
                                <pattern>@NUMBER::@@ESTRING::(@@ESTRING::)@ @IPv4::@-&gt;WinEvtLog @ESTRING::Microsoft-Windows-Sysmon/Operational: INFORMATION(5): Microsoft-Windows-Sysmon: SYSTEM: NT AUTHORITY: @@ESTRING:s0:: @@ESTRING::ProcessGuid: {@@ESTRING:s1:} @@ESTRING:: Image: @@ESTRING:s2:@</pattern>
                        </patterns>
                        <examples>
                                <example>
                                        <test_message program='ossec_archive'>2016 Jul 26 03:32:14 (win8-test) 192.168.1.76-&gt;WinEvtLog 2016 Jul 26 20:16:31 WinEvtLog: Microsoft-Windows-Sysmon/Operational: INFORMATION(5): Microsoft-Windows-Sysmon: SYSTEM: NT AUTHORITY: WIN-VL5U1V07CA7: Process terminated:  UtcTime: 2016-07-27 02:16:31.060  ProcessGuid: {B8CD0A89-D602-5796-0000-001087702400}  ProcessId: 3424  Image: C:\Windows\System32\taskhost.exe</test_message>
                                                <test_value name='s0'>WIN-VL5U1V07CA7</test_value>
                                                <test_value name='s1'>B8CD0A89-D602-5796-0000-001087702400</test_value>
                                                <test_value name='s2'>C:\Windows\System32\taskhost.exe</test_value>
                                </example>
                        </examples>
                </rule>
                <rule provider='DefensiveDepth' class='10785' id='10785'>
                        <patterns>
                                <pattern>@NUMBER::@@ESTRING::(@@ESTRING::)@ @IPv4::@-&gt;WinEvtLog @ESTRING::Microsoft-Windows-Sysmon/Operational: INFORMATION(6): Microsoft-Windows-Sysmon: SYSTEM: NT AUTHORITY: @@ESTRING:s0:: @@ESTRING:: ImageLoaded: @@ESTRING:s1:  Hashes: @@ESTRING:s2: @@ESTRING:: Signed: @@ESTRING:s3: @@ESTRING:: Signature: @@ANYSTRING:s4:@</pattern>
                        </patterns>
                        <examples>
                                <example>
                                        <test_message program='ossec_archive'>2016 Jul 28 03:44:40 (win8-test) 192.168.1.76-&gt;WinEvtLog 2016 Jul 29 17:03:04 WinEvtLog: Microsoft-Windows-Sysmon/Operational: INFORMATION(6): Microsoft-Windows-Sysmon: SYSTEM: NT AUTHORITY: WIN-VL5U1V07CA7: Driver loaded:  UtcTime: 2016-07-29 23:02:45.306  ImageLoaded: C:\Windows\System32\drivers\Ndu.sys  Hashes: SHA1=BA3773A62C2E67533E1C75E48DB6E62D8A92A1AA,IMPHASH=0CB044FF22A5D4FEEC3D7063EC18FF35  Signed: true  Signature: Microsoft Windows</test_message>
                                                <test_value name='s0'>WIN-VL5U1V07CA7</test_value>
                                                <test_value name='s1'>C:\Windows\System32\drivers\Ndu.sys</test_value>
                                                <test_value name='s2'>SHA1=BA3773A62C2E67533E1C75E48DB6E62D8A92A1AA,IMPHASH=0CB044FF22A5D4FEEC3D7063EC18FF35</test_value>
                                                <test_value name='s3'>true</test_value>
                                                <test_value name='s4'>Microsoft Windows</test_value>
                                </example>
                        </examples>
                </rule>
                 <rule provider='DefensiveDepth' class='10786' id='10786'>
                        <patterns>
                                <pattern>@NUMBER::@@ESTRING::(@@ESTRING::)@ @IPv4::@-&gt;WinEvtLog @ESTRING::Microsoft-Windows-Sysmon/Operational: INFORMATION(9): Microsoft-Windows-Sysmon: SYSTEM: NT AUTHORITY: @@ESTRING:s0:: @@ESTRING::ProcessGuid: {@@ESTRING:s1:} @@ESTRING:: Image: @@ESTRING:s2:  Device: @@ANYSTRING:s3:@</pattern>
                        </patterns>
                        <examples>
                                <example>
                                        <test_message program='ossec_archive'>2016 Jul 28 04:29:02 (win8-test) 192.168.1.76-&gt;WinEvtLog 2016 Jul 29 17:47:50 WinEvtLog: Microsoft-Windows-Sysmon/Operational: INFORMATION(9): Microsoft-Windows-Sysmon: SYSTEM: NT AUTHORITY: WIN-VL5U1V07CA7: RawAccessRead detected:  UtcTime: 2016-07-29 23:47:50.526  ProcessGuid: {B8CD0A89-EAC9-579B-0000-001030BD0100}  ProcessId: 1436  Image: C:\Program Files\Windows Defender\MsMpEng.exe  Device: \Device\HarddiskVolume1</test_message>
                                                <test_value name='s0'>WIN-VL5U1V07CA7</test_value>
                                                <test_value name='s1'>B8CD0A89-EAC9-579B-0000-001030BD0100</test_value>
                                                <test_value name='s2'>C:\Program Files\Windows Defender\MsMpEng.exe</test_value>
                                                <test_value name='s3'>\Device\HarddiskVolume1</test_value>
                                </example>
                        </examples>
                </rule>
                <rule provider='DefensiveDepth' class='10787' id='10787'>
                        <patterns>
                                <pattern>@NUMBER::@@ESTRING::(@@ESTRING::)@ @IPv4::@-&gt;WinEvtLog @ESTRING::Microsoft-Windows-Sysmon/Operational: INFORMATION(10): Microsoft-Windows-Sysmon: SYSTEM: NT AUTHORITY: @@ESTRING:s0:: @@ESTRING:: SourceProcessGUID: {@@ESTRING:s1:} @@ESTRING:: SourceImage: @@ESTRING:s2:  TargetProcessGUID: {@@ESTRING:s3:} @@ESTRING:: TargetImage: @@ESTRING:s4:  GrantedAccess:@@ESTRING:: CallTrace: @@ANYSTRING::@</pattern>
                        </patterns>
                        <examples>
                                <example>
                                        <test_message program='ossec_archive'>2016 Jul 30 15:23:09 (win8-test) 192.168.1.76-&gt;WinEvtLog 2016 Jul 30 12:18:39 WinEvtLog: Microsoft-Windows-Sysmon/Operational: INFORMATION(10): Microsoft-Windows-Sysmon: SYSTEM: NT AUTHORITY: WIN-VL5U1V07CA7: Process accessed:  UtcTime: 2016-07-30 18:18:39.109  SourceProcessGUID: {B8CD0A89-ED98-579C-0000-001001CC0100}  SourceProcessId: 1500  SourceThreadId: 2024  SourceImage: C:\Program Files\Windows Defender\MsMpEng.exe  TargetProcessGUID: {B8CD0A89-ED97-579C-0000-00106D9B0100}  TargetProcessId: 1304  TargetImage: C:\Program Files (x86)\ossec-agent\ossec-agent.exe  GrantedAccess: 0x101000  CallTrace: C:\Windows\SYSTEM32\ntdll.dll+9091a|C:\Windows\system32\KERNELBASE.dll+2e5e|C:\ProgramData\Microsoft\Windows Defender\Definition Updates\{BF09301C-3DC5-498A-A66A-483CEC6AA846}\mpengine.dll+9e99c|C:\ProgramData\Microsoft\Windows Defender\Definition Updates\{BF09301C-3DC5-498A-A66A-483CEC6AA846}\mpengine.dll+9e8ac|C:\ProgramData\Microsoft\Windows Defender\Definition Updates\{BF09301C-3DC5-498A-A66A-483CEC6AA846}\mpengine.dll+9e841|C:\ProgramData\Microsoft\Windows Defender\Definition Updates\{BF09301C-3DC5-498A-A66A-483CEC6AA846}\mpengine.dll+56ca6d|C:\ProgramData\Microsoft\Windows Defender\Definition Updates\{BF09301C-3DC5-498A-A66A-483CEC6AA846}\mpengine.dll+38b3d8|C:\ProgramData\Microsoft\Windows Defender\Definition Updates\{BF09301C-3DC5-498A-A66A-483CEC6AA846}\mpengine.dll+1abd31|C:\ProgramData\Microsoft\Windows Defender\Definition Updates\{BF09301C-3DC5-498A-A66A-483CEC6AA846}\mpengine.dll+1a8c43|C:\ProgramData\Microsoft\Windows Defender\Definition Updates\{BF09301C-3DC5-498A-A66A-483CEC6AA846}\mpengine.dll+1a7ca8|C:\ProgramData\Microsoft\Windows Defender\Definition Updates\{BF09301C-3DC5-498A-A66A-483CEC6AA846}\mpengine.dll+1a7abe|C:\ProgramData\Microsoft\Windows Defender\Definition Updates\{BF09301C-3DC5-498A-A66A-483CEC6AA846}\mpengine.dll+1aa0cf|C:\ProgramData\Microsoft\Windows Defender\Definition Updates\{BF09301C-3DC5-498A-A66A-483CEC6AA846}\mpengine.dll+1aec46|C:\ProgramData\Microsoft\Windows Defender\Definition Updates\{BF09301C-3DC5-498A-A66A-483CEC6AA846}\mpengine.dll+1f9d5f|C:\ProgramData\Microsoft\Windows Defender\Definition Updates\{BF09301C-3DC5-498A-A66A-483CEC6AA846}\mpengine.dll+1ae4d3|C:\ProgramData\Microsoft\Windows Defender\Definition Updates\{BF09301C-3DC5-498A-A66A-483CEC6AA846}\mpengine.dll+1ae7da|C:\ProgramData\Microsoft\Windows Defender\Definition Updates\{BF09301C-3DC5-498A-A66A-483CEC6AA846}\mpengine.dll+50147|C:\ProgramData\Microsoft\Windows Defender\Definition Updates\{BF09301C-3DC5-498A-A66A-483CEC6AA846}\mpengine.dll+73413|C:\ProgramData\Microsoft\Windows Defender\Definition Updates\{BF09301C-3DC5-498A-A66A-483CEC6AA846}\mpengine.dll+2b7f00|C:\ProgramData\Microsoft\Windows Defender\Definition Updates\{BF09301C-3DC5-498A-A66A-483CEC6AA846}\mpengine.dll+410be7|C:\ProgramData\Microsoft\Windows Defender\Definition Updates\{BF09301C-3DC5-498A-A66A-483CEC6AA846}\mpengine.dll+350168|C:\ProgramData\Microsoft\Windows Defender\Definition Updates\{BF09301C-3DC5-498A-A66A-483CEC6AA846}\mpengine.dll+956c7|C:\ProgramData\Microsoft\Windows Defender\Definition Updates\{BF09301C-3DC5-498A-A66A-483CEC6AA846}\mpengine.dll+9564e|C:\Program Files\Windows Defender\mpsvc.dll+18253</test_message>
                                                <test_value name='s0'>WIN-VL5U1V07CA7</test_value>
                                                <test_value name='s1'>B8CD0A89-ED98-579C-0000-001001CC0100</test_value>
                                                <test_value name='s2'>C:\Program Files\Windows Defender\MsMpEng.exe</test_value>
                                                <test_value name='s3'>B8CD0A89-ED97-579C-0000-00106D9B0100</test_value>
                                                <test_value name='s4'>C:\Program Files (x86)\ossec-agent\ossec-agent.exe</test_value>
                                </example>
                        </examples>
                </rule>
    </rules>
</ruleset><ruleset name='WIN-PROCESS-TRACKING' id='780'>
<pattern>ossec_archive</pattern>
<rules>
    <rule provider='DefensiveDepth' class='10780' id='10780'>
        <patterns>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::-&gt;@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::A new process has been created@@ESTRING::Target Subject:@@ESTRING::Account Name:  @@ESTRING:s1: @@ESTRING::New Process Name: @@ESTRING:s2:  @@ESTRING::Token Elevation Type: @@ESTRING:s3:  @@ESTRING::Creator Process Name: @@ESTRING:s4:  @@ESTRING::Process Command Line: @@ESTRING:s5:  @</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::-&gt;@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::A new process has been created@@ESTRING::Account Name:  @@ESTRING:s1:  @@ESTRING::New Process Name: @@ESTRING:s2:  @@ESTRING::Token Elevation Type: @@ESTRING:s3:  @</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::-&gt;@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::A process has exited@@ESTRING::Account Name:  @@ESTRING:s1:  @@ESTRING::Process Name: @@ESTRING:s2:  @@ESTRING::Exit Status: @</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::-&gt;@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::An operation was attempted on a privileged object@@ESTRING::Account Name:  @@ESTRING:s1: @@ESTRING::Process Name: @@ESTRING:s2:  @</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::-&gt;@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::The state of a transaction has changed@@ESTRING::Account Name:  @@ESTRING:s1: @@ESTRING::Process Name:  @@ANYSTRING:s2:@</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::-&gt;@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::A privileged service was called@@ESTRING::Account Name:  @@ESTRING:s1: @@ESTRING::Process Name: @@ESTRING:s2:  @</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::-&gt;@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::A logon was attempted using explicit credentials@@ESTRING::Account Whose Credentials Were Used@@ESTRING::Account Name:  @@ESTRING:s1:  @@ESTRING::Process Name:  @@ESTRING:s2:  @@ESTRING::Network Address: @@IPv4:i1: @</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::-&gt;@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::A logon was attempted using explicit credentials@@ESTRING::Account Whose Credentials Were Used@@ESTRING::Account Name:  @@ESTRING:s1:  @@ESTRING::Process Name:  @@ESTRING:s2:  @</pattern>
        </patterns>
        <examples>
            <example>
                <test_message program='ossec_archive'>2015 Nov 03 19:57:01 (SERVER01) 10.1.1.1-&gt;WinEvtLog 2015 Nov 03 12:56:57 WinEvtLog: Security: AUDIT_SUCCESS(4688): Microsoft-Windows-Security-Auditing: (no user): no domain: SERVER01.contoso.com: A new process has been created. Subject:  Security ID:  S-1-5-18  Account Name:  SERVER01$  Account Domain:  CONTOSO  Logon ID:  0x3e7  Process Information:  New Process ID:  0x1994  New Process Name: C:\\Windows\\System32\\conhost.exe  Token Elevation Type: %%1936  Creator Process ID: 0x1f4</test_message>
                <test_value name='i0'>4688</test_value>
                <test_value name='s0'>SERVER01.contoso.com</test_value>
                <test_value name='s1'>SERVER01$</test_value>
                <test_value name='s2'>C:\\Windows\\System32\\conhost.exe</test_value>
                <test_value name='s3'>%%1936</test_value>
            </example>
            <example>
                <test_message program='ossec_archive'>2016 Sep 29 18:33:39 (SERVER01) 10.1.1.1-&gt;WinEvtLog 2016 Sep 29 13:00:44 WinEvtLog: Security: AUDIT_SUCCESS(4688): Microsoft-Windows-Security-Auditing: (no user): no domain: WINTEST: A new process has been created.    Creator Subject:   Security ID:  S-1-5-18   Account Name:  WINTEST$   Account Domain:  WORKGROUP   Logon ID:  0x3E7    Target Subject:   Security ID:  S-1-5-21-1799166368-2267426087-2432483420-1000   Account Name:  admin   Account Domain:  WINTEST   Logon ID:  0x3A5F9    Process Information:   New Process ID:  0x1874   New Process Name: C:\\Program Files\\WindowsApps\\microsoft.windowscommunicationsapps_17.7167.40817.0_x64__8wekyb3d8bbwe\\HxTsr.exe   Token Elevation Type: %%1938   Mandatory Label:  S-1-16-4096   Creator Process ID: 0x290   Creator Process Name: C:\\Windows\\System32\\svchost.exe   Process Command Line: &quot;C:\\Program Files\\WindowsApps\\microsoft.windowscommunicationsapps_17.7167.40817.0_x64__8wekyb3d8bbwe\\HxTsr.exe&quot; -ServerName:Hx.IPC.Server    Token Elevation Type indicates the type of token that was assigned to the new process in accordance with User Account Control policy.    Type 1 is a full token with no privileges removed or groups disabled.  A full token is only used if User Account Control is disabled or if the user is the built-in Administrator account or a service account.    Type 2 is an elevated token with no privileges removed or groups disabled.  An elevated token is used when User Account Control is enabled and the user chooses to start the program using Run as administrator.  An elevated token is also used when an application is configured to always require administrative privilege or to always require maximum privilege, and the user is a member of the Administrators group.    Type 3 is a limited token with administrative privileges removed and administrative groups disabled.  The limited token is used when User Account Control is enabled, the application does not require administrative privilege, and the user does not choose to start the program using Run as administrator.</test_message>
                <test_value name='i0'>4688</test_value>
                <test_value name='s0'>WINTEST</test_value>
                <test_value name='s1'>admin</test_value>
                <test_value name='s2'>C:\\Program Files\\WindowsApps\\microsoft.windowscommunicationsapps_17.7167.40817.0_x64__8wekyb3d8bbwe\\HxTsr.exe</test_value>
                <test_value name='s3'>%%1938</test_value>
                <test_value name='s4'>C:\\Windows\\System32\\svchost.exe</test_value>
                <test_value name='s5'>&quot;C:\\Program Files\\WindowsApps\\microsoft.windowscommunicationsapps_17.7167.40817.0_x64__8wekyb3d8bbwe\\HxTsr.exe&quot; -ServerName:Hx.IPC.Server</test_value>
            </example>
            <example>
                <test_message program='ossec_archive'>2015 Nov 03 19:57:01 (SERVER01) 10.1.1.1-&gt;WinEvtLog 2015 Nov 03 13:56:57 WinEvtLog: Security: AUDIT_SUCCESS(4689): Microsoft-Windows-Security-Auditing: (no user): no domain: SERVER01.contoso.com: A process has exited. Subject:  Security ID:  S-1-5-18  Account Name:  user01  Account Domain:  CONTOSO  Logon ID:  0x3e7  Process Information:  Process ID: 0x1804  Process Name: C:\\Program Files (x86)\\PostgreSQL\\8.4\\bin\\postgres.exe  Exit Status: 0xFFFFFFFF</test_message>
                <test_value name='i0'>4689</test_value>
                <test_value name='s0'>SERVER01.contoso.com</test_value>
                <test_value name='s1'>user01</test_value>
                <test_value name='s2'>C:\\Program Files (x86)\\PostgreSQL\\8.4\\bin\\postgres.exe</test_value>
            </example>
            <example>
                <test_message program='ossec_archive'>2015 Nov 03 19:57:02 (SERVER01) 10.1.1.1-&gt;WinEvtLog 2015 Nov 03 21:56:57 WinEvtLog: Security: AUDIT_SUCCESS(4674): Microsoft-Windows-Security-Auditing: (no user): no domain: SERVER01.contoso.com: An operation was attempted on a privileged object. Subject:  Security ID:  S-1-5-21-1202660629-2052111302-682003330-5406  Account Name:  user01  Account Domain:  CONTOSO  Logon ID:  0x20b21e  Object:  Object Server: Security  Object Type: -  Object Name: -  Object Handle: 0xce8  Process Information:  Process ID: 0x161c  Process Name: C:\\Windows\\System32\\wbem\\WmiPrvSE.exe  Requested Operation:  Desired Access: 2031619  Privileges:  SeTakeOwnershipPrivilege</test_message>
                <test_value name='i0'>4674</test_value>
                <test_value name='s0'>SERVER01.contoso.com</test_value>
                <test_value name='s1'>user01</test_value>
                <test_value name='s2'>C:\\Windows\\System32\\wbem\\WmiPrvSE.exe</test_value>
            </example>
            <example>
                <test_message program='ossec_archive'>2015 Nov 03 19:57:04 (SERVER01) 10.1.1.1-&gt;WinEvtLog 2015 Nov 03 13:56:59 WinEvtLog: Security: AUDIT_SUCCESS(4985): Microsoft-Windows-Security-Auditing: (no user): no domain: SERVER01.contoso.com: The state of a transaction has changed. Subject:  Security ID:  S-1-5-18  Account Name:  user01  Account Domain:  CONTOSO  Logon ID:  0x3e7  Transaction Information:  RM Transaction ID: {09298C36-7B75-11E5-A2FD-005056A96845}  New State:  48  Resource Manager: {A8278C32-83AD-11E1-93DE-005056A90011}  Process Information:  Process ID:  0x388  Process Name:  C:\\Windows\\System32\\svchost.exe</test_message>
                <test_value name='i0'>4985</test_value>
                <test_value name='s0'>SERVER01.contoso.com</test_value>
                <test_value name='s1'>user01</test_value>
                <test_value name='s2'>C:\\Windows\\System32\\svchost.exe</test_value>
            </example>
            <example>
                <test_message program='ossec_archive'>2015 Nov 03 19:57:02 (SERVER01) 10.1.1.1-&gt;WinEvtLog 2015 Nov 03 20:57:00 WinEvtLog: Security: AUDIT_FAILURE(4673): Microsoft-Windows-Security-Auditing: (no user): no domain: SERVER01.contoso.com: A privileged service was called. Subject:  Security ID:  S-1-5-21-1202660629-2052111302-682003330-62996  Account Name:  user01  Account Domain:  CONTOSO  Logon ID:  0x5ae35c17  Service:  Server: Security  Service Name: -  Process:  Process ID: 0x2bc8  Process Name: C:\\Windows\\System32\\lsass.exe  Service Request Information:  Privileges:  SeTcbPrivilege</test_message>
                <test_value name='i0'>4673</test_value>
                <test_value name='s0'>SERVER01.contoso.com</test_value>
                <test_value name='s1'>user01</test_value>
                <test_value name='s2'>C:\\Windows\\System32\\lsass.exe</test_value>
            </example>
            <example>
                <test_message program='ossec_archive'>2015 Nov 03 19:57:01 (SERVER01) 10.1.1.1-&gt;WinEvtLog 2015 Nov 03 17:55:52 WinEvtLog: Security: AUDIT_SUCCESS(4648): Microsoft-Windows-Security-Auditing: (no user): no domain: SERVER01.contoso.com: A logon was attempted using explicit credentials. Subject:  Security ID:  S-1-5-18  Account Name:  SERVER01$  Account Domain:  CONTOSO  Logon ID:  0x3e7  Logon GUID:  {00000000-0000-0000-0000-000000000000}  Account Whose Credentials Were Used:  Account Name:  user01  Account Domain:  CONTOSO  Logon GUID:  {00000000-0000-0000-0000-000000000000}  Target Server:  Target Server Name: SERVER01  Additional Information: host/SERVER01  Process Information:  Process ID:  0x1020  Process Name:  F:\\Program Files\\Microsoft\\Exchange Server\\V14\\Bin\\MSExchangeMailSubmission.exe  Network Information:  Network Address: -  Port:   -  This event is generated when a process attempts to log on an account by explicitly specifying that accounts credentials.  This most commonly occurs in batch-type configurations such as scheduled tasks, or when using the RUNAS command.</test_message>
                <test_value name='i0'>4648</test_value>
                <test_value name='s0'>SERVER01.contoso.com</test_value>
                <test_value name='s1'>user01</test_value>
                <test_value name='s2'>F:\\Program Files\\Microsoft\\Exchange Server\\V14\\Bin\\MSExchangeMailSubmission.exe</test_value>
            </example>
            <example>
                <test_message program='ossec_archive'>2015 Nov 03 19:57:02 (SERVER01) 10.1.1.1-&gt;WinEvtLog 2015 Nov 03 20:56:59 WinEvtLog: Security: AUDIT_SUCCESS(4648): Microsoft-Windows-Security-Auditing: (no user): no domain: SERVER01.contoso.com: A logon was attempted using explicit credentials. Subject:  Security ID:  S-1-5-18  Account Name:  SERVER01$  Account Domain:  CONTOSO  Logon ID:  0x3e7  Logon GUID:  {00000000-0000-0000-0000-000000000000}  Account Whose Credentials Were Used:  Account Name:  user01  Account Domain:  CONTOSO  Logon GUID:  {00000000-0000-0000-0000-000000000000}  Target Server:  Target Server Name: localhost  Additional Information: localhost  Process Information:  Process ID:  0x228  Process Name:  C:\\Windows\\System32\\lsass.exe  Network Information:  Network Address: 192.168.1.1  Port:   58643  This event is generated when a process attempts to log on an account by explicitly specifying that accounts credentials.  This most commonly occurs in batch-type configurations such as scheduled tasks, or when using the RUNAS command.</test_message>
                <test_value name='i0'>4648</test_value>
                <test_value name='s0'>SERVER01.contoso.com</test_value>
                <test_value name='s1'>user01</test_value>
                <test_value name='s2'>C:\\Windows\\System32\\lsass.exe</test_value>
                <test_value name='i1'>192.168.1.1</test_value>
            </example>
        </examples>
    </rule>
    </rules>
</ruleset><ruleset name='WINDOWS' id='4'>
<pattern>ossec_archive</pattern>
<rules>
    <rule provider='ELSA' class='4' id='4'>
        <patterns>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::-&gt;@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::A user account was locked out.@@ESTRING::Account Domain:  @@ESTRING:s2:  @@ESTRING::Account That Was Locked Out: @@ESTRING::Account Name:  @@ESTRING:s1: @@ESTRING::Caller Computer Name: @@ANYSTRING:s0:@</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::-&gt;@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::A user account was locked out.@@ESTRING::Account Domain:  @@ESTRING:s2:  @@ESTRING::Account That Was Locked Out: @@ESTRING::Account Name:  @@ESTRING:s1:  @</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::-&gt;@@ESTRING::(@@ESTRING:i0:): @@ESTRING:: The domain controller attempted to validate the credentials for an account.@@ESTRING::Logon Account: @@ESTRING:s1: Source Workstation: @@ESTRING:s0: Error@</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::-&gt;@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @An account was successfully logged on. @ESTRING::Account Name:@@ESTRING::Account Name:  @@ESTRING:s1:  @@ESTRING::Account Domain:  @@ESTRING:s2:  @@ESTRING::Source Network Address: @@IPv4:i1: @</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::-&gt;@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @An account was successfully logged on. @ESTRING::Account Name:@@ESTRING::Account Name:  @@ESTRING:s1:  @@ESTRING::Account Domain:  @@ESTRING:s2:  @</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::-&gt;@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @An account failed to log on. @ESTRING::Account Name:@@ESTRING::Account Name:  @@ESTRING:s1:  Account Domain:  @@ESTRING:s2:  Failure@@ESTRING::Source Network Address: @@IPv4:i1: Source Port:@</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::-&gt;@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @An account failed to log on. @ESTRING::Account Name:@@ESTRING::Account Name:  @@ESTRING:s1:  Account Domain:  @@ESTRING:s2:  Failure@</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::-&gt;@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @A Kerberos authentication ticket (TGT) was requested. @ESTRING::Account Name:  @@ESTRING:s1:  Supplied Realm Name: @@ESTRING:s2:  @@ESTRING::ffff:@@IPv4:i1: @</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::-&gt;@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @A Kerberos authentication ticket (TGT) was requested. @ESTRING::Account Name:  @@ESTRING:s1:  Supplied Realm Name: @@ESTRING:s2:  @</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::-&gt;@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @Kerberos pre-authentication failed.@ESTRING::Account Name:  @@ESTRING:s1:  Service Information: @@ESTRING::ffff:@@IPv4:i1: @</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::-&gt;@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @Kerberos pre-authentication failed.@ESTRING::Account Name:  @@ESTRING:s1:  Service Information: @</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::-&gt;@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @A Kerberos service ticket was renewed.@ESTRING::Account Name:  @@ESTRING:s1:  Account Domain:  @@ESTRING:s2:  Service Information: @@ESTRING::ffff:@@IPv4:i1: @</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::-&gt;@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @A Kerberos service ticket was renewed.@ESTRING::Account Name:  @@ESTRING:s1:  Account Domain:  @@ESTRING:s2:  Service Information: @@ESTRING::Client Address:  @@IPv4:i1: @</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::-&gt;@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @A Kerberos service ticket was renewed.@ESTRING::Account Name:  @@ESTRING:s1:  Account Domain:  @@ESTRING:s2:  Service Information: @</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::-&gt;@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @A computer account was changed.@ESTRING::Account Name:  @@ESTRING:s1:  Account Domain:  @@ESTRING:s2:  Logon@</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::-&gt;@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @A user account was changed.@ESTRING::Account Name:@@ESTRING::Account Name:  @@ESTRING:s1:  Account Domain:  @@ESTRING:s2:  Changed Attributes: @</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::-&gt;@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING:: @@ESTRING:s1: @@ESTRING:s2: @@ESTRING:: @File @IPv4:i1:@@ESTRING:: @@ESTRING:: @@ESTRING:s3: @@ESTRING:s4: 0x@</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::-&gt;@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING:: @@ESTRING:s1: @@ESTRING:s2: @@ESTRING:: @File @ESTRING:: @@ESTRING:: @@ESTRING:s3: @@ESTRING:s4: 0x@</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::-&gt;@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::Login succeeded for user &apos;@@ESTRING:s2:\\@@ESTRING:s1:&apos;. @@ESTRING::CLIENT: @@IPv4:i1:]@</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::-&gt;@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::Login succeeded for user &apos;@@ESTRING:s2:\\@@ESTRING:s1:&apos;. @</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::-&gt;@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::Login succeeded for user &apos;@@ESTRING:s1:&apos;. @@ESTRING::CLIENT: @@IPv4:i1:]@</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::-&gt;@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::Login succeeded for user &apos;@@ESTRING:s1:&apos;. @</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::-&gt;@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @Network Policy Server @ESTRING::\\@@ESTRING:s1:  Account Domain:   @@ESTRING:s2:  Fully@@ESTRING::Client IP Address:   @@IPv4:i1: @</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::-&gt;@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @Network Policy Server @ESTRING::Account Name:   @@ESTRING:s1:  Account Domain:   @@ESTRING:s2:  Fully@@ESTRING::Client IP Address:   @@IPv4:i1: @</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::-&gt;@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::A network share object was accessed.@@ESTRING::Account Name:  @@ESTRING:s1: @@ESTRING::Account Domain:  @@ESTRING:s2: @@ESTRING::Source Address:  File  Source Port:  @@IPv4:i1: @</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::-&gt;@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::User Name: |@@ESTRING:s1:    |@@ESTRING::Domain: |@@ESTRING:s2:    |@@ESTRING::Source Network Address: @@IPv4:i1: @</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::-&gt;@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::User Name: |@@ESTRING:s1:    |@@ESTRING::Domain: |@@ESTRING:s2:    |@@ESTRING::Client Address: |@@IPv4:i1: |@</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::-&gt;@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::User Name: |@@ESTRING:s1:    |@@ESTRING::Domain: |@@ESTRING:s2:    |@</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::-&gt;@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::User Name: @@ESTRING:s1:    |@@ESTRING::Domain: |@@ESTRING:s2:    |@@ESTRING::Source Network Address: @@IPv4:i1: @</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::-&gt;@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::User Name: @@ESTRING:s1:    |@@ESTRING::Domain: |@@ESTRING:s2:    |@@ESTRING::Client Address: |@@IPv4:i1: |@</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::-&gt;@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::User Name: @@ESTRING:s1:    |@@ESTRING::Domain: |@@ESTRING:s2:    |@</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::-&gt;@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::Primary User Name: @@ESTRING:s1:    |@@ESTRING::Primary Domain: @@ESTRING:s2:    |@</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::-&gt;@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::Account Name:  @@ESTRING:s1:  @@ESTRING::Account Domain:  @@ESTRING:s2:  @@ESTRING::ffff:@@IPv4:i1: @</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::-&gt;@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::Account Name:  @@ESTRING:s1:  @@ESTRING::Account Domain:  @@ESTRING:s2:  @</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::-&gt;@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::Source Network Address: @@IPv4:i1: @</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::-&gt;@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::ffff:@@IPv4:i1: @</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::-&gt;@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::Client Address: |@@IPv4:i1: @</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::-&gt;@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::Client Address: @@IPv4:i1: @</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::-&gt;@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::User Name: @@ESTRING:s1: |@@ESTRING::Domain: |@@ESTRING:s2: |@@ESTRING::Source Network Address: - @</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::-&gt;@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::User Name: @@ESTRING:s1: |@@ESTRING::Domain: |@@ESTRING:s2: |Logon ID:@</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::-&gt;WinEvtLog@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @</pattern>
        </patterns>
        <examples>
             <example>
                <test_message program='ossec_archive'>2017 Jan 29 19:22:29 (TEST) 1.1.1.1-&gt;WinEvtLog 2017 Jan 29 13:22:26 WinEvtLog: Security: AUDIT_SUCCESS(5140): Microsoft-Windows-Security-Auditing: (no user): no domain: test.contoso.com: A network share object was accessed.  Subject:  Security ID:  S-1-5-21-126432666-12709346926-3688153413-10989949  Account Name:  USER01  Account Domain:  DOMAIN01  Logon ID:  0xdfa34d2  Network Information:   Source Address:  File  Source Port:  10.1.1.13   Share Name:   63305</test_message>
                <test_value name='i0'>5140</test_value>
                <test_value name='s0'>test.contoso.com</test_value>
                <test_value name='s1'>USER01</test_value>
                <test_value name='s2'>DOMAIN01</test_value>
                <test_value name='i1'>10.1.1.13</test_value>
            </example>
            <example>
                <test_message program='ossec_archive'>2015 Nov 03 19:57:01 (SERVER01) 10.1.1.1-&gt;WinEvtLog 2015 Nov 03 20:56:58 WinEvtLog: Security: AUDIT_SUCCESS(4776): Microsoft-Windows-Security-Auditing: (no user): no domain: SERVER01.contoso.com: The domain controller attempted to validate the credentials for an account. Authentication Package: MICROSOFT_AUTHENTICATION_PACKAGE_V1_0 Logon Account: user01 Source Workstation: WORKSTATION01 Error Code: 0x0</test_message>
                <test_value name='i0'>4776</test_value>
                <test_value name='s0'>WORKSTATION01</test_value>
                <test_value name='s1'>user01</test_value>
            </example>
            <example>
                <test_message program='ossec_archive'>2015 Jul 10 06:29:11 (SERVER01) 10.1.2.3-&gt;WinEvtLog 2015 Jul 10 08:29:07 WinEvtLog: Security: AUDIT_SUCCESS(4740): Microsoft-Windows-Security-Auditing: (no user): no domain: server01.eu.d-rco.com: 0x8000000000000000    message: A user account was locked out.  Subject:  Security ID:  S-1-5-18  Account Name:  SERVER01$  Account Domain:  CONTOSO  Logon ID:  0x3e7  Account That Was Locked Out:  Security ID:  S-1-5-21-1202660629-2052111302-682003330-7883  Account Name:  bsmith  Additional Information:  Caller Computer Name: WORKSTATION01</test_message>
                <test_value name='i0'>4740</test_value>
                <test_value name='s2'>CONTOSO</test_value>
                <test_value name='s1'>bsmith</test_value>
                <test_value name='s0'>WORKSTATION01</test_value>
            </example>
            <example>
                <test_message program='ossec_archive'>2015 Jul 09 16:31:49 (SERVER01) 10.1.2.3-&gt;WinEvtLog 2015 Jul 09 11:31:48 WinEvtLog: Security: AUDIT_SUCCESS(576): Security: bsmith: CONTOSO: SERVER01: Special privileges assigned to new logon:    |User Name: bsmith    |Domain: |CONTOSO    |Logon ID: |(0x0,0x53140A55)    |Privileges: SeSecurityPrivilege  |||SeBackupPrivilege  |||SeRestorePrivilege  |||SeTakeOwnershipPrivilege  |||SeDebugPrivilege  |||SeSystemEnvironmentPrivilege  |||SeLoadDriverPrivilege  |||SeImpersonatePrivilege                                 </test_message>
                <test_value name='i0'>576</test_value>
                <test_value name='s0'>SERVER01</test_value>
                <test_value name='s1'>bsmith</test_value>
                <test_value name='s2'>CONTOSO</test_value>
            </example>
            <example>
                <test_message program='ossec_archive'>2015 Jul 09 16:31:38 (SERVER01) 10.1.2.3-&gt;WinEvtLog 2015 Jul 09 22:08:29 WinEvtLog: Security: AUDIT_SUCCESS(540): Security: bsmith: CONTOSO: SERVER01: Successful Network Logon:    |User Name: bsmith    |Domain: |CONTOSO    |Logon ID: |(0x0,0x2019C1A7)    |Logon Type: 3    |Logon Process: Kerberos    |Authentication Package: Kerberos    |Workstation Name:     |Logon GUID: {df727ffc-0e96-accd-6ea3-89a59e1e94d1}    |Caller User Name: -    |Caller Domain: -    |Caller Logon ID: -    |Caller Process ID: -    |Transited Services: -    |Source Network Address: 192.1.2.3    |Source Port: 64116        </test_message>
                <test_value name='i0'>540</test_value>
                <test_value name='s0'>SERVER01</test_value>
                <test_value name='s1'>bsmith</test_value>
                <test_value name='s2'>CONTOSO</test_value>
                <test_value name='i1'>192.1.2.3</test_value>
            </example>
            <example>
                <test_message program='ossec_archive'>2015 Jul 09 20:35:29 (SERVER01) 10.1.2.3-&gt;WinEvtLog 2015 Jul 09 22:35:28 WinEvtLog: Security: AUDIT_SUCCESS(6278): Microsoft-Windows-Security-Auditing: (no user): no domain: SERVER01.contoso.com: Network Policy Server granted full access to a user because the host met the defined health policy. User:  Security ID:   S-1-5-21-1202633329-2052111302-682003330-42024  Account Name:   CONTOSO\\bsmith  Account Domain:   CONTOSO  Fully Qualified Account Name: CONTOSO\\bsmith  Client Machine:  Security ID:   S-1-0-0  Account Name:   -  Fully Qualified Account Name: -  OS-Version:   -  Called Station Identifier:  e05f.b9ab.84b0  Calling Station Identifier:  28b2.bcce.6306  NAS:  NAS IPv4 Address:  192.1.2.3  NAS IPv6 Address:  -  NAS Identifier:   WAP1  NAS Port-Type:   Wireless - IEEE 802.11  NAS Port:   414635  RADIUS Client:  Client Friendly Name:  WAP1  Client IP Address:   192.1.2.3  Authentication Details:  Proxy Policy Name:  Use Windows authentication for all users  Network Policy Name:  Wifi Validation  Authentication Provider:  Windows  Authentication Server:  SERVER01.contoso.com  Authentication Type:  PEAP  EAP Type:   Microsoft: Secured password (EAP-MSCHAP v2)  Account Session Identifier:  -  Quarantine Information:  Result:    Full Access  Extended-Result:   -  Session Identifier:   -  Help URL:   -  System Health Validator Result(s): - </test_message>
                <test_value name='i0'>6278</test_value>
                <test_value name='s0'>SERVER01.contoso.com</test_value>
                <test_value name='s1'>bsmith</test_value>
                <test_value name='s2'>CONTOSO</test_value>
                <test_value name='i1'>192.1.2.3</test_value>
            </example>
            <example>
                <test_message program='ossec_archive'>2015 Jul 09 16:31:47 (SERVER01) 10.1.2.3-&gt;WinEvtLog 2015 Jul 09 12:31:43 WinEvtLog: Security: AUDIT_FAILURE(4625): Microsoft-Windows-Security-Auditing: (no user): no domain: SERVER01.contoso.com: An account failed to log on. Subject:  Security ID:  S-1-0-0  Account Name:  -  Account Domain:  -  Logon ID:  0x0  Logon Type:   3  Account For Which Logon Failed:  Security ID:  S-1-0-0  Account Name:  bsmith  Account Domain:  WRKSTATION01  Failure Information:  Failure Reason:  %%2313  Status:   0xc000006d  Sub Status:  0xc0000064  Process Information:  Caller Process ID: 0x0  Caller Process Name: -  Network Information:  Workstation Name: WRKSTATION01  Source Network Address: 192.1.2.3  Source Port:  55575  Detailed Authentication Information:  Logon Process:  NtLmSsp   Authentication Package: NTLM  Transited Services: -  Package Name (NTLM only): -  Key Length:  0  This event is generated when a logon request fails. It is generated on the computer where access was attempted.</test_message>
                <test_value name='i0'>4625</test_value>
                <test_value name='s0'>SERVER01.contoso.com</test_value>
                <test_value name='s1'>bsmith</test_value>
                <test_value name='s2'>WRKSTATION01</test_value>
                <test_value name='i1'>192.1.2.3</test_value>
            </example>
            <example>
                <test_message program='ossec_archive'>2015 Jul 09 16:31:34 (SERVER01) 10.1.2.3-&gt;WinEvtLog 2015 Jul 09 12:31:34 WinEvtLog: Application: AUDIT_SUCCESS(18454): MSSQL$TEST: (no user): no domain: SERVER01.contoso.com: Login succeeded for user &apos;bsmith&apos;. Connection made using SQL Server authentication. [CLIENT: 192.1.2.3]</test_message>
                <test_value name='i0'>18454</test_value>
                <test_value name='s0'>SERVER01.contoso.com</test_value>
                <test_value name='s1'>bsmith</test_value>
                <test_value name='i1'>192.1.2.3</test_value>
            </example>
            <example>
                <test_message program='ossec_archive'>2015 Jul 09 16:32:01 (DROLNW215VM) 10.1.2.3-&gt;WinEvtLog 2015 Jul 09 12:32:00 WinEvtLog: Application: AUDIT_SUCCESS(18453): MSSQL$TEST: cpcprogramadmin: CONTOSO: SERVER01.contoso.com: Login succeeded for user &apos;CONTOSO\\bsmith&apos;. Connection made using Windows authentication. [CLIENT: 192.1.2.3]</test_message>
                <test_value name='i0'>18453</test_value>
                <test_value name='s0'>SERVER01.contoso.com</test_value>
                <test_value name='s2'>CONTOSO</test_value>
                <test_value name='s1'>bsmith</test_value>
                <test_value name='i1'>192.1.2.3</test_value>
            </example>
            <example>
                <test_message program='ossec_archive'>2015 Jul 09 16:31:36 (SERVER01) 10.1.2.3-&gt;WinEvtLog 2015 Jul 09 10:31:32 WinEvtLog: Security: AUDIT_SUCCESS(4656): Microsoft-Windows-Security-Auditing: (no user): no domain: SERVER01.contoso.com: A handle to an object was requested. Subject:  Security ID:  S-1-5-18  Account Name:  SERVER01$  Account Domain:  CONTOSO  Logon ID:  0x3e7  Object:  Object Server:  Security  Object Type:  File  Object Name:  \\Device\\Floppy0  Handle ID:  0x280  Process Information:  Process ID:  0  Process Name:  0xbac  Access Request Information:  Transaction ID:  {00000000-0000-0000-0000-000000000000}  Accesses:  %%1538  ||||%%1541  ||||%%4416  ||||%%4419  ||||%%4423  ||||  Access Mask:  -  Privileges Used for Access Check: 0x120089  Restricted SID Count: -</test_message>
                <test_value name='i0'>4656</test_value>
                <test_value name='s0'>SERVER01.contoso.com</test_value>
                <test_value name='s1'>SERVER01$</test_value>
                <test_value name='s2'>CONTOSO</test_value>
            </example>
            <example>
                <test_message program='ossec_archive'>2015 Jul 06 09:11:55 (SERVER01) 10.1.2.3-&gt;WinEvtLog 2015 Jul 06 11:11:51 WinEvtLog: Security: AUDIT_SUCCESS(5145): Microsoft-Windows-Security-Auditing: (no user): no domain: SERVER01.contoso.com: S-1-5-21-1202660629-2052111302-682003330-36208 BSmith CONTOSO 0xd07fc77 File ::1 53216 \\\\*\\share1$ \\??\\E:\\shared stuff\\this\\stuff.doc 0x120089 %%1538</test_message>
                <test_value name='i0'>5145</test_value>
                <test_value name='s0'>SERVER01.contoso.com</test_value>
                <test_value name='s1'>BSmith</test_value>
                <test_value name='s2'>CONTOSO</test_value>
                <test_value name='s3'>\\\\*\\share1$</test_value>
                <test_value name='s4'>\\??\\E:\\shared stuff\\this\\stuff.doc</test_value>
            </example>
            <example>
                <test_message program='ossec_archive'>2015 Jul 06 09:11:55 (SERVER01) 10.1.2.3-&gt;WinEvtLog 2015 Jul 06 11:11:51 WinEvtLog: Security: AUDIT_SUCCESS(5145): Microsoft-Windows-Security-Auditing: (no user): no domain: SERVER01.contoso.com: S-1-5-21-1202660629-2052111302-682003330-36208 BSmith CONTOSO 0xd07fc77 File 192.1.2.3 53216 \\\\*\\share1$ \\??\\E:\\shared stuff\\this\\stuff.doc 0x120089 %%1538</test_message>
                <test_value name='i0'>5145</test_value>
                <test_value name='s0'>SERVER01.contoso.com</test_value>
                <test_value name='s1'>BSmith</test_value>
                <test_value name='s2'>CONTOSO</test_value>
                <test_value name='i1'>192.1.2.3</test_value>
                <test_value name='s3'>\\\\*\\share1$</test_value>
                <test_value name='s4'>\\??\\E:\\shared stuff\\this\\stuff.doc</test_value>
            </example>
            <example>
                <test_message program='ossec_archive'>2015 Jul 09 16:31:34 (SERVER01) 10.1.2.3-&gt;WinEvtLog 2015 Jul 09 18:31:31 WinEvtLog: Security: AUDIT_SUCCESS(4770): Microsoft-Windows-Security-Auditing: (no user): no domain: SERVER01.contoso.com: A Kerberos service ticket was renewed. Account Information:  Account Name:  bsmith@contoso.com  Account Domain:  contoso.com  Service Information:  Service Name:  krbtgt  Service ID:  S-1-5-21-1233360629-2052111302-682003330-502  Network Information:  Client Address:  192.1.2.3  Client Port:  2214  Additional Information:  Ticket Options:  0x2  Ticket Encryption Type: 0x12  Ticket options and encryption types are defined in RFC 4120.</test_message>
                <test_value name='i0'>4770</test_value>
                <test_value name='s0'>SERVER01.contoso.com</test_value>
                <test_value name='s1'>bsmith@contoso.com</test_value>
                <test_value name='s2'>contoso.com</test_value>
                <test_value name='i1'>192.1.2.3</test_value>
            </example>
            <example>
                <test_message program='ossec_archive'>2015 Jul 09 17:31:29 (SERVER01) 10.1.2.3-&gt;WinEvtLog 2015 Jul 09 12:31:27 WinEvtLog: Security: AUDIT_SUCCESS(4738): Microsoft-Windows-Security-Auditing: (no user): no domain: SERVER01.contoso.com: A user account was changed. Subject:  Security ID:  S-1-5-7  Account Name:  ANONYMOUS LOGON  Account Domain:  NT AUTHORITY  Logon ID:  0x3e6  Target Account:  Security ID:  S-1-5-21-1433339735-357464061-2299825339-102091  Account Name:  bsmith  Account Domain:  CONTOSO  Changed Attributes:  SAM Account Name: -  Display Name:  -  User Principal Name: -  Home Directory:  -  Home Drive:  -  Script Path:  -  Profile Path:  -  User Workstations: -  Password Last Set: 7/9/2015 12:31:27 PM  Account Expires:  -  Primary Group ID: -  AllowedToDelegateTo: -  Old UAC Value:  -  New UAC Value:  -  User Account Control: -  User Parameters: -  SID History:  -  Logon Hours:  -  Additional Information:  Privileges:  -</test_message>
                <test_value name='i0'>4738</test_value>
                <test_value name='s0'>SERVER01.contoso.com</test_value>
                <test_value name='s1'>bsmith</test_value>
                <test_value name='s2'>CONTOSO</test_value>
            </example>
            <example>
                <test_message program='ossec_archive'>2015 Jul 09 16:43:11 (SERVER01) 10.1.2.3-&gt;WinEvtLog 2015 Jul 09 12:13:08 WinEvtLog: Security: AUDIT_SUCCESS(4742): Microsoft-Windows-Security-Auditing: (no user): no domain: SERVER01.contoso.com: A computer account was changed. Subject:  Security ID:  S-1-5-21-1434109735-357333061-2299825339-41471  Account Name:  bsmith  Account Domain:  CONTOSO  Logon ID:  0x1c9d8892  Computer Account That Was Changed:  Security ID:  S-1-5-21-1434109735-357333061-2299825339-90727  Account Name:  WORKSTATION01$  Account Domain:  CONTOSO  Changed Attributes:  SAM Account Name: -  Display Name:  -  User Principal Name: -  Home Directory:  -  Home Drive:  -  Script Path:  -  Profile Path:  -  User Workstations: -  Password Last Set: 7/9/2015 12:13:07 PM  Account Expires:  -  Primary Group ID: -  AllowedToDelegateTo: -  Old UAC Value:  -  New UAC Value:  -  User Account Control: -  User Parameters: -  SID History:  -  Logon Hours:  -  DNS Host Name:  WORKSTATION01.contoso.com  Service Principal Names:   ||HOST/WORKSTATION01.contoso.com  ||RestrictedKrbHost/WORKSTATION01.contoso.com  ||HOST/WORKSTATION01  ||RestrictedKrbHost/WORKSTATION01  Additional Information:  Privileges:  -</test_message>
                <test_value name='i0'>4742</test_value>
                <test_value name='s0'>SERVER01.contoso.com</test_value>
                <test_value name='s1'>bsmith</test_value>
                <test_value name='s2'>CONTOSO</test_value>
            </example>
            <example>
                <test_message program='ossec_archive'>2015 Jul 09 16:31:34 (SERVER01) 10.1.2.3-&gt;WinEvtLog 2015 Jul 09 18:31:32 WinEvtLog: Security: AUDIT_SUCCESS(4769): Microsoft-Windows-Security-Auditing: bsmith@contoso.com: EU.D-RCO.COM: SERVER01.contoso.com: A Kerberos service ticket was requested. Account Information:  Account Name:  bsmith@contoso.com  Account Domain:  contoso.com  Logon GUID:  {05774B76-805E-F391-B402-4C6F56704155}  Service Information:  Service Name:  CONTOSO.COM  Service ID:  S-1-5-21-1202660629-2052111302-683453330-0  Network Information:  Client Address:  ::ffff:192.1.2.3  Client Port:  2111  Additional Information:  Ticket Options:  0x40810000  Ticket Encryption Type: 0x17  Failure Code:  0x0  Transited Services: -  This event is generated every time access is requested to a resource such as a computer or a Windows service.  The service name indicates the resource to which access was requested.</test_message>
                <test_value name='i0'>4769</test_value>
                <test_value name='s0'>SERVER01.contoso.com</test_value>
                <test_value name='s1'>bsmith@contoso.com</test_value>
                <test_value name='s2'>contoso.com</test_value>
                <test_value name='i1'>192.1.2.3</test_value>
            </example>
            <example>
                <test_message program='ossec_archive'>2015 Jul 09 16:50:01 (SERVER01) 10.1.2.3-&gt;WinEvtLog 2015 Jul 09 11:50:00 WinEvtLog: Security: AUDIT_FAILURE(529): Security: SYSTEM: NT AUTHORITY: SERVER01: Logon Failure:    |Reason: |Unknown user name or bad password    |User Name: bsmith    |Domain: |CONTOSO    |Logon Type: 4    |Logon Process: Advapi      |Authentication Package: Negotiate    |Workstation Name: SERVER01    |Caller User Name: SERVER01$    |Caller Domain: CONTOSO    |Caller Logon ID: (0x0,0x3E7)    |Caller Process ID: 892    |Transited Services: -    |Source Network Address: 192.1.2.3    |Source Port: -    </test_message>
                <test_value name='i0'>529</test_value>
                <test_value name='s0'>SERVER01</test_value>
                <test_value name='s1'>bsmith</test_value>
                <test_value name='s2'>CONTOSO</test_value>
                <test_value name='i1'>192.1.2.3</test_value>
            </example>
            <example>
                <test_message program='ossec_archive'>2015 Jul 09 17:11:16 (SERVER01) 10.1.2.3-&gt;WinEvtLog 2015 Jul 09 13:11:16 WinEvtLog: Security: AUDIT_SUCCESS(528): Security: bsmith: CONTOSO: SERVER01: Successful Logon:    |User Name: bsmith    |Domain: |CONTOSO    |Logon ID: |(0x0,0x7BD160D0)    |Logon Type: 10    |Logon Process: User32      |Authentication Package: Negotiate    |Workstation Name: SERVER01    |Logon GUID: {b498dd3f-589d-8e7c-2244-121599544f51}    |Caller User Name: SERVER01$    |Caller Domain: CONTOSO    |Caller Logon ID: (0x0,0x3E7)    |Caller Process ID: 9036    |Transited Services: -    |Source Network Address: 192.1.2.3    |Source Port: 53432    </test_message>
                <test_value name='i0'>528</test_value>
                <test_value name='s0'>SERVER01</test_value>
                <test_value name='s1'>bsmith</test_value>
                <test_value name='s2'>CONTOSO</test_value>
                <test_value name='i1'>192.1.2.3</test_value>
            </example>
            <example>
                <test_message program='ossec_archive'>2015 Jul 09 16:31:35 (drolnwdc2) 10.1.2.3-&gt;WinEvtLog 2015 Jul 09 12:31:32 WinEvtLog: Security: AUDIT_SUCCESS(4624): Microsoft-Windows-Security-Auditing: bsmith: CONTOSO: SERVER01.contoso.com: An account was successfully logged on. Subject:  Security ID:  S-1-0-0  Account Name:  -  Account Domain:  -  Logon ID:  0x0  Logon Type:   3  New Logon:  Security ID:  S-1-5-21-1434133335-357464061-2299825339-78091  Account Name:  bsmith  Account Domain:  CONTOSO  Logon ID:  0x8c7c79e1  Logon GUID:  {33754E17-B333-0F6F-AAD6-E1BFEE3E6DBE}  Process Information:  Process ID:  0x0  Process Name:  -  Network Information:  Workstation Name:   Source Network Address: 192.1.2.3  Source Port:  61237  Detailed Authentication Information:  Logon Process:  Kerberos  Authentication Package: Kerberos  Transited Services: -  Package Name (NTLM only): -  Key Length:  0  This event is generated when a logon session is created. It is generated on the computer that was accessed.</test_message>
                <test_value name='i0'>4624</test_value>
                <test_value name='s0'>SERVER01.contoso.com</test_value>
                <test_value name='s1'>bsmith</test_value>
                <test_value name='s2'>CONTOSO</test_value>
                <test_value name='i1'>192.1.2.3</test_value>
            </example>
            <example>
                <test_message program='ossec_archive'>2015 Jul 09 16:31:37 (SERVER01) 10.1.2.3-&gt;WinEvtLog 2015 Jul 09 11:31:34 WinEvtLog: Security: AUDIT_SUCCESS(4768): Microsoft-Windows-Security-Auditing: (no user): no domain: SERVER01.contoso.com: A Kerberos authentication ticket (TGT) was requested. Account Information:  Account Name:  bsmith  Supplied Realm Name: CONTOSO  User ID:   S-1-5-21-1434109735-357464061-2299825339-97083  Service Information:  Service Name:  krbtgt  Service ID:  S-1-5-21-1434109735-357464061-2299837639-502  Network Information:  Client Address:  ::ffff:192.1.2.3  Client Port:  65256  Additional Information:  Ticket Options:  0x40810010  Result Code:  0x0  Ticket Encryption Type: 0x12  Pre-Authentication Type: 2  Certificate Information:  Certificate Issuer Name:    Certificate Serial Number:   Certificate Thumbprint:    Certificate information is only provided if a certificate was used for pre-authentication.  Pre-authentication types, ticket options, encryption types and result codes are defined in RFC 4120.</test_message>
                <test_value name='i0'>4768</test_value>
                <test_value name='s0'>SERVER01.contoso.com</test_value>
                <test_value name='s1'>bsmith</test_value>
                <test_value name='s2'>CONTOSO</test_value>
                <test_value name='i1'>192.1.2.3</test_value>
            </example>
            <example>
                <test_message program='ossec_archive'>2015 Jul 09 16:31:37 (SERVER01) 10.1.2.3-&gt;WinEvtLog 2015 Jul 09 13:33:52 WinEvtLog: Security: AUDIT_SUCCESS(673): Security: SYSTEM: NT AUTHORITY: SERVER01: Service Ticket Request:    |User Name: |bsmith@contoso.com    |User Domain: |contoso.com    |Service Name: |TEST$    |Service ID: |%{S-1-5-21-209686433-1210347603-2226485991-8004}    |Ticket Options: |0x40810000    |Ticket Encryption Type: 0x17    |Client Address: |192.1.2.3    |Failure Code: |-    |Logon GUID: |{dec9dac4-9930-8dff-2d75-27a7100037aa}    |Transited Services: -          </test_message>
                <test_value name='i0'>673</test_value>
                <test_value name='s0'>SERVER01</test_value>
                <test_value name='s1'>bsmith@contoso.com</test_value>
                <test_value name='s2'>contoso.com</test_value>
                <test_value name='i1'>192.1.2.3</test_value>
            </example>
            <example>
                <test_message program='ossec_archive'>2015 Jul 09 16:31:34 (SERVER01) 10.1.2.3-&gt;WinEvtLog 2015 Jul 09 18:31:30 WinEvtLog: Security: AUDIT_FAILURE(4771): Microsoft-Windows-Security-Auditing: (no user): no domain: SERVER01.contoso.com: Kerberos pre-authentication failed. Account Information:  Security ID:  S-1-5-21-1063978684-905172004-2179356134-4512  Account Name:  bsmith  Service Information:  Service Name:  krbtgt/CONTOSO.COM  Network Information:  Client Address:  ::ffff:192.1.2.3  Client Port:  57911  Additional Information:  Ticket Options:  0x40810010  Failure Code:  0x12  Pre-Authentication Type: 0  Certificate Information:  Certificate Issuer Name:    Certificate Serial Number:    Certificate Thumbprint:    Certificate information is only provided if a certificate was used for pre-authentication.  Pre-authentication types, ticket options and failure codes are defined in RFC 4120.  If the ticket was malformed or damaged during transit and could not be decrypted, then many fields in this event might not be present.</test_message>
                <test_value name='i0'>4771</test_value>
                <test_value name='s0'>SERVER01.contoso.com</test_value>
                <test_value name='s1'>bsmith</test_value>
                <test_value name='i1'>192.1.2.3</test_value>
            </example>
        </examples>
    </rule>
</rules>
</ruleset><ruleset name='bro_weird' id='26000'>
  <pattern>bro_weird</pattern>
  <rules>
    <rule provider='Security_Onion' class='26000' id=''>
      <patterns>
        <pattern>@ESTRING::|@@ESTRING::|@@ESTRING:i0:|@@ESTRING:i1:|@@ESTRING:i2:|@@ESTRING:i3:|@@ESTRING:s0:|@@ESTRING:s1:|@@ESTRING:s2:|@@ESTRING:s3:@</pattern>
      </patterns>
      <examples>
        <example>
          <test_message program='bro_weird'>1375126169.694954|9rhrNop4vR3|172.16.1.9|55534|192.168.9.4|80|above_hole_data_without_any_acks|-|F|so-hq-2-eth2</test_message>
          <test_value name='i0'>172.16.1.9</test_value>
          <test_value name='i1'>55534</test_value>
          <test_value name='i2'>192.168.9.4</test_value>
          <test_value name='i3'>80</test_value>
          <test_value name='s0'>above_hole_data_without_any_acks</test_value>
          <test_value name='s1'>-</test_value>
          <test_value name='s2'>F</test_value>
          <test_value name='s3'>so-hq-2-eth2</test_value>
        </example>
      </examples>
    </rule>
  </rules>
</ruleset><ruleset>
                <pattern>bro_snmp</pattern>
                <rules>
                        <rule class='26011' id='26011'>
                                <patterns>
                                        <pattern>@ESTRING::|@@ESTRING::|@@ESTRING:i0:|@@ESTRING:i1:|@@ESTRING:i2:|@@ESTRING:i3:|@@ESTRING:s0:|@@ESTRING:s1:|@@ESTRING:s2:|@@ESTRING:i4:|@@ESTRING::|@@ESTRING:i5:|@@ESTRING::|@@ESTRING:s3:|@@ESTRING:s4:@</pattern>
                                </patterns>
                                <examples>
                                        <example>
						<test_message program='bro_snmp'>MESSAGE=1415311140.085077|ZZZOWu1ZZzzzQSVzzz|10.1.2.3|14224|1.1.6.2|162|0.000000|1|XXxxYYzz|789|14|803|0|-|1405533183.353428</test_message>
                                                <test_value name='i0'>10.1.2.3</test_value>
                                                <test_value name='i1'>14224</test_value>
                                                <test_value name='i2'>1.1.6.2</test_value>
                                                <test_value name='i3'>162</test_value>
                                                <test_value name='s0'>0.000000</test_value>
                                                <test_value name='s1'>1</test_value>
                                                <test_value name='s2'>XXxxYYzz</test_value>
                                                <test_value name='i4'>789</test_value>
                                                <test_value name='i5'>803</test_value>
                                                <test_value name='s3'>-</test_value>
                                                <test_value name='s4'>1405533183.353428</test_value>
                                        </example>
                                </examples>
                        </rule>
                </rules>
        </ruleset><ruleset>
                <pattern>bro_x509</pattern>
                <rules>
                        <rule class='26010' id='26010'>
                                <patterns>
                                        <pattern>@ESTRING::|@@ESTRING::|@@ESTRING:i0:|@@ESTRING:s0:|@@ESTRING:s1:|@@ESTRING:s2:|@@ESTRING::|@@ESTRING::|@@ESTRING:s3:|@@ESTRING:s4:|@@ESTRING:s5:|@@ESTRING:i1:|@@ESTRING::|@@ESTRING::|@@ANYSTRING::@</pattern>
                                </patterns>
                                <examples>
                                        <example>
						<test_message program='bro_x509'>MESSAGE=1415311199.833031|F3VSq0483VV4thwTR7|3|1D8583A4A355533105C783EAF328F16D|CN=www.amazon.com,O=Amazon.com Inc.,L=Seattle,ST=Washington,C=US|CN=VeriSign Class 3 Secure Server CA - G3,OU=Terms of use at https://www.verisign.com/rpa (c)10,OU=VeriSign Trust Network,O=VeriSign, Inc.,C=US|1393459200.000000|1425167999.000000|rsaEncryption|sha1WithRSAEncryption|rs|2048|65537|-|uedata.amazon.com,amazon.com,amzn.com,www.amzn.com,www.amazon.com|-|-|-|F|-</test_message>
                                                <test_value name='i0'>3</test_value>
                                                <test_value name='s0'>1D8583A4A355533105C783EAF328F16D</test_value>
                                                <test_value name='s1'>CN=www.amazon.com,O=Amazon.com Inc.,L=Seattle,ST=Washington,C=US</test_value>
                                                <test_value name='s2'>CN=VeriSign Class 3 Secure Server CA - G3,OU=Terms of use at https://www.verisign.com/rpa (c)10,OU=VeriSign Trust Network,O=VeriSign, Inc.,C=US</test_value>
                                                <test_value name='s3'>rsaEncryption</test_value>
                                                <test_value name='s4'>sha1WithRSAEncryption</test_value>
                                                <test_value name='s5'>rs</test_value>
                                                <test_value name='i1'>2048</test_value>
                                        </example>
                                </examples>
                        </rule>
                </rules>
        </ruleset><ruleset>
                <pattern>bro_ssl</pattern>
                <rules>
                        <rule class='18' id='18'>
                                <patterns>
                                        <pattern>@ESTRING::|@@ESTRING::|@@ESTRING:i0:|@@ESTRING:i1:|@@ESTRING:i2:|@@ESTRING:i3:|@@ESTRING:s2:|@@ESTRING:s3:|@@ESTRING::|@@ESTRING:s0:|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING:s1:|@@ESTRING::|@@ANYSTRING::@</pattern>
                                </patterns>
                                <examples>
                                        <example>
						<test_message program='bro_ssl'>1436016829.925795|Cxv4932gV6K9jqa59c|192.168.137.62|50399|173.194.116.111|443|TLSv10|TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA|secp256r1|www.google.at|F|-|-|T|FIBC8e4vBsWOhjH0j3,Fc304f4t38UZkr4Xd3,Fa3gjca6mOcXkNpxl|(empty)|CN=*.google.at,O=Google Inc,L=Mountain View,ST=California,C=US|CN=Google Internet Authority G2,O=Google Inc,C=US|-|-|certificate has expired</test_message>
                                                <test_value name='i0'>192.168.137.62</test_value>
                                                <test_value name='i1'>50399</test_value>
                                                <test_value name='i2'>173.194.116.111</test_value>
                                                <test_value name='i3'>443</test_value>
                                                <test_value name='s0'>www.google.at</test_value>
                                                <test_value name='s1'>CN=*.google.at,O=Google Inc,L=Mountain View,ST=California,C=US</test_value>
                                                <test_value name='s2'>TLSv10</test_value>
                                                <test_value name='s3'>TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA</test_value>
                                        </example>
                                </examples>
                        </rule>
                </rules>
        </ruleset><ruleset name='CISCO_TEARDOWN' id='3'>
   <pattern>ossec_archive</pattern>
        <rules>
                <rule provider='ELSA' class='3' id='3'>
                <patterns>
                <pattern>@ESTRING::ASA-@@ESTRING:: Teardown @@ESTRING:i0: @@ESTRING:: for @@ESTRING:s0::@@IPv4:i1:@@QSTRING:i2:/(@@ESTRING:: to @@ESTRING:s1::@@IPv4:i3:@@ESTRING::/@@ESTRING:i4: @duration @ESTRING:s2: @bytes @ESTRING:i5: @</pattern>
                <pattern>@ESTRING::ASA-@@ESTRING:: Teardown @@ESTRING:i0: @@ESTRING:: for @@ESTRING:s0::@@IPv4:i1:@@QSTRING:i2:/ @to @ESTRING:s1::@@ESTRING::__@@IPv4:i3:_@@ESTRING::/@@ESTRING:i4: @duration @ESTRING:s2: @bytes @ESTRING:i5:@</pattern>
                <pattern>@ESTRING::ASA-@@ESTRING:: Teardown @@ESTRING:i0: @@ESTRING:: for @@ESTRING:s0::@@IPv4:i1:@@QSTRING:i2:/ @to @ESTRING:s1::@@IPv4:i3:@@ESTRING::/@@ESTRING:i4: @duration @ESTRING:s2: @bytes @ESTRING:i5: @</pattern>
                <pattern>@ESTRING::ASA-@@ESTRING:: Teardown @@ESTRING:i0: @@ESTRING:: for @@ESTRING:s0::@@IPv4:i1:@@QSTRING:i2:/ @to @ESTRING:s1::@@IPv4:i3:@@ESTRING::/@@ESTRING:i4: @duration @ESTRING:s2: @bytes @ESTRING:i5:@</pattern>
                </patterns>
                <examples>
                        <example>
                        <test_message program='ossec_archive'>2015 Jul 05 11:38:00 ossec-&gt;10.1.2.3 Jul 05 2015 13:37:59: %ASA-6-302016: Teardown UDP connection 982861325 for outside-test:192.1.2.3/53 to inside:10.5.6.7/62350 duration 0:02:01 bytes 36</test_message>
                        <test_value name='i0'>UDP</test_value>
                        <test_value name='i1'>192.1.2.3</test_value>
                        <test_value name='i2'>53</test_value>
                        <test_value name='i3'>10.5.6.7</test_value>
                        <test_value name='i4'>62350</test_value>
                        <test_value name='i5'>36</test_value>
                        <test_value name='s0'>outside-test</test_value>
                        <test_value name='s1'>inside</test_value>
                        <test_value name='s2'>0:02:01</test_value>
                        </example>
                        <example>
                        <test_message program='ossec_archive'>2015 Jul 05 11:38:00 ossec-&gt;10.1.2.3 Jul 05 2015 11:37:59: %ASA-6-302014: Teardown TCP connection 750288225 for OUTSIDE:192.1.2.3/64393(LOCAL\\bsmith@contoso.com) to INSIDE:10.1.2.15/445 duration 0:02:32 bytes 16058 TCP Reset-O (bsmith@contoso.com)</test_message>
                        <test_value name='i0'>TCP</test_value>
                        <test_value name='i1'>192.1.2.3</test_value>
                        <test_value name='i2'>64393</test_value>
                        <test_value name='i3'>10.1.2.15</test_value>
                        <test_value name='i4'>445</test_value>
                        <test_value name='i5'>16058</test_value>
                        <test_value name='s0'>OUTSIDE</test_value>
                        <test_value name='s1'>INSIDE</test_value>
                        <test_value name='s2'>0:02:32</test_value>
                        </example>
                        <example>
                        <test_message program='ossec_archive'>2015 Jul 05 11:37:59 ossec&gt;10.1.2.3 Jul 05 2015 11:37:59: %ASA-4-302014: Teardown TCP connection 2066296 for INSIDE:192.1.2.3/445 to OUTSIDE:1.1.1.1/56381 duration 0:00:40 bytes 323 SYN Timeout</test_message>
                        <test_value name='i0'>TCP</test_value>
                        <test_value name='i1'>192.1.2.3</test_value>
                        <test_value name='i2'>445</test_value>
                        <test_value name='i3'>1.1.1.1</test_value>
                        <test_value name='i4'>56381</test_value>
                        <test_value name='i5'>323</test_value>
                        <test_value name='s0'>INSIDE</test_value>
                        <test_value name='s1'>OUTSIDE</test_value>
                        <test_value name='s2'>0:00:40</test_value>
                        </example>
                        <example>
                        <test_message program='ossec_archive'>2015 Jul 05 11:37:59 ossec-&gt;10.1.2.3 Jul 05 2015 11:37:59: %ASA-6-302016: Teardown UDP connection 4232125765 for OUTSIDE:1.1.1.1/53 to INSIDE:IP__192.1.2.3__TEST-DNS-SERVER-1/60855 duration 0:00:40 bytes 323</test_message>
                        <test_value name='i0'>UDP</test_value>
                        <test_value name='i1'>1.1.1.1</test_value>
                        <test_value name='i2'>53</test_value>
                        <test_value name='i3'>192.1.2.3</test_value>
                        <test_value name='i4'>60855</test_value>
                        <test_value name='i5'>323</test_value>
                        <test_value name='s0'>OUTSIDE</test_value>
                        <test_value name='s1'>INSIDE</test_value>
                        <test_value name='s2'>0:00:40</test_value>
                        </example>
                    </examples>
                </rule>
        </rules>
</ruleset>
    <ruleset name='BIND'>
        <pattern>BIND</pattern>
        <pattern>named</pattern>
        <rules>
            <rule provider='Certego' class='11081' id='11081'>
                <patterns>
                    <pattern>@ESTRING::client @@ESTRING:i0:#@@NUMBER:i1:@:@ESTRING::query@: @ESTRING:s0: @@ESTRING:s1: @@ESTRING:s2: @@ESTRING:: @(@ESTRING:i2:)@</pattern>
                    <pattern>@ESTRING::client @@ESTRING:i0:#@@NUMBER:i1:@ (@ESTRING::)@:@ESTRING::query@: @ESTRING:s0: @@ESTRING:s1: @@ESTRING:s2: @@ESTRING:: @(@ESTRING:i2:)@</pattern>
                </patterns>
                <examples>
                    <example>
                        <test_message program='BIND-DNS'>02-Nov-2012 15:49:58.516 queries: info: client 198.211.94.24#55557: query: 174.2.219.178.in-addr.arpa IN PTR + (198.211.94.23)</test_message>
                        <test_values>
                            <test_value name='i0'>198.211.94.24</test_value>
                            <test_value name='i1'>55557</test_value>
                            <test_value name='s0'>174.2.219.178.in-addr.arpa</test_value>
                            <test_value name='s1'>IN</test_value>
                            <test_value name='s2'>PTR</test_value>
                            <test_value name='i2'>198.211.94.23</test_value>
                        </test_values>
                    </example>
                    <example>
                        <test_message program='BIND-DNS'>02-Nov-2012 16:01:27.731 client 10.10.10.185#49999 (10.10.10.185): query: p.twitter.com IN A + (10.10.210.210)</test_message>
                        <test_values>
                            <test_value name='i0'>10.10.10.185</test_value>
                            <test_value name='i1'>49999</test_value>
                            <test_value name='s0'>p.twitter.com</test_value>
                            <test_value name='s1'>IN</test_value>
                            <test_value name='s2'>A</test_value>
                            <test_value name='i2'>10.10.210.210</test_value>
                        </test_values>
                    </example>
                    <example>
                        <test_message program='named'>23-Jan-2015 18:10:46.196 queries: info: client 127.0.0.1#49552 (client01.domain.local): view private: query: p.twitter.com IN A + (127.0.0.1)</test_message>
                        <test_values>
                            <test_value name='i0'>127.0.0.1</test_value>
                            <test_value name='i1'>49552</test_value>
                            <test_value name='s0'>p.twitter.com</test_value>
                            <test_value name='s1'>IN</test_value>
                            <test_value name='s2'>A</test_value>
                            <test_value name='i2'>127.0.0.1</test_value>
                        </test_values>
                    </example>
                </examples>
            </rule>
        </rules>
    </ruleset>
<ruleset name='bro_software' id='26006'>
  <pattern>bro_software</pattern>
  <rules>
    <rule provider='Security_Onion' class='26006' id='26006'>
      <patterns>
        <pattern>@ESTRING::|@@ESTRING:i0:|@@ESTRING:i1:|@@ESTRING:s0:|@@ESTRING:s1:|@@ESTRING:i2:|@@ESTRING:i3:|@@ESTRING:i4:|@@ESTRING:i5:|@@ESTRING:s2:|@@ESTRING:s3:@</pattern>
      </patterns>
      <examples>
        <example>
          <test_message program='bro_software'>1385320827.690575|192.168.146.133|-|HTTP::BROWSER|MSIE|6|0|-|-|-|Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.2; SV1; .NET CLR 1.1.4322; .NET CLR 2.0.50727; .NET CLR 3.0.04506.648; .NET CLR 3.5.21022; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729; InfoPath.2)</test_message>
          <test_value name='i0'>192.168.146.133</test_value>
          <test_value name='i1'>-</test_value>
          <test_value name='s0'>HTTP::BROWSER</test_value>
          <test_value name='s1'>MSIE</test_value>
          <test_value name='i2'>6</test_value>
          <test_value name='i3'>0</test_value>
          <test_value name='i4'>-</test_value>
          <test_value name='i5'>-</test_value>
          <test_value name='s2'>-</test_value>
          <test_value name='s3'>Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.2; SV1; .NET CLR 1.1.4322; .NET CLR 2.0.50727; .NET CLR 3.0.04506.648; .NET CLR 3.5.21022; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729; InfoPath.2)</test_value>
        </example>
      </examples>
    </rule>
  </rules>
</ruleset>
	<ruleset name='FWSM' id='2'>
		<pattern>%FWSM</pattern>
		<rules>
			<rule provider='ELSA' class='2' id='2'>
				<patterns>
					<pattern>Deny@QSTRING:i0: @src@QSTRING:s0: :@@IPv4:i1:@/@NUMBER:i2:@ dst@QSTRING:s1: :@@IPv4:i3:@/@NUMBER:i4:@ by access-group @QSTRING:s2:&quot;@</pattern>
					<pattern>Deny @ESTRING:: @@ESTRING:i0: @src @ESTRING:s0::@@IPv4:i1:@/@NUMBER:i2:@ dst @ESTRING:s1::@@IPv4:i3:@/@NUMBER:i4:@</pattern>
					<pattern>Shunned packet: @IPv4:i1:@ ==&gt; @IPv4:i3:@ on interface @ANYSTRING:s0:@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program='%FWSM-3-106010'>Deny inbound tcp src OUTSIDE:2.116.180.66/3116 dst INSIDE:10.0.0.0/445</test_message>
						<test_values>
							<test_value name='i0'>tcp</test_value>
							<test_value name='s0'>OUTSIDE</test_value>
							<test_value name='i1'>2.116.180.66</test_value>
							<test_value name='i2'>3116</test_value>
							<test_value name='s1'>INSIDE</test_value>
							<test_value name='i3'>10.0.0.0</test_value>
							<test_value name='i4'>445</test_value>
						</test_values>
					</example>
				</examples>
			</rule>
			<rule provider='ELSA' class='3' id='3'>
				<patterns>
					<pattern>Teardown@QSTRING:i0: @connection @NUMBER::@ for@QSTRING:s0: :@@IPv4:i1:@/@NUMBER:i2:@ to@QSTRING:s1: :@@IPv4:i3:@/@NUMBER:i4:@ duration@QSTRING:s2: @bytes @NUMBER:i5:@</pattern>
				</patterns>
			</rule>
			<rule provider='ELSA' class='7' id='7'>
				<patterns>
					<pattern>@IPv4:i0:@ Accessed URL @IPv4:i1:@:@ESTRING::/@/@ESTRING:s1:/@@ANYSTRING:s2:@</pattern>
					<pattern>@IPv4:i0:@ Accessed URL @IPv4:i1:@:@ESTRING::/@/@ESTRING:s1:/@</pattern>
					<pattern>Access denied URL @ESTRING::/@/@ESTRING:s1:/@@ESTRING:s2: @SRC @IPv4:i0:@ DEST @IPv4:i1:@ on interface </pattern>
				</patterns>
				<examples>
					<example>
						<test_message program='%FWSM-5-304001'>192.168.1.1 Accessed URL 10.0.0.0:http://www.example.com/wp-content/plugins/wp-spamfree/img/wpsf-img.php</test_message>
						<test_values>
							<test_value name='i0'>192.168.1.1</test_value>
							<test_value name='i1'>10.0.0.0</test_value>
							<test_value name='s1'>www.example.com</test_value>
							<test_value name='s2'>wp-content/plugins/wp-spamfree/img/wpsf-img.php</test_value>
						</test_values>
					</example>
					<example>
						<test_message program='FWSM-5-304002'>Access denied URL http://www.example.com/feedout/content SRC 192.168.1.1 DEST 72.246.55.49 on interface inside</test_message>
							<test_values>
								<test_value name='s1'>www.example.com</test_value>
								<test_value name='s2'>feedout/content</test_value>
								<test_value name='i0'>192.168.1.1</test_value>
								<test_value name='i1'>72.246.55.49</test_value>
							</test_values>
					</example>
				</examples>
			</rule>
			<rule provider='ELSA' class='36' id='36'>
				<patterns>
					<pattern>Group =@QSTRING:s0: ,@ Username =@QSTRING:s1: ,@ IP = @IPv4:i0:@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program='%FWSM-4-113019'>Group = Produccion, Username = pepe, IP = 10.245.102.86, Session disconnected. Session Type: IPsecOverNatT, Duration: 1h:38m:44s, Bytes xmt: 24545367, Bytes rcv: 3046464, Reason: Lost Service</test_message>
						<test_value name='i0'>10.245.102.86</test_value>
						<test_value name='s0'>Produccion</test_value>
						<test_value name='s1'>pepe</test_value>
					</example>
					<example>
						<test_message program='%FWSM-4-113019'>Group = Acceso, Username = juan, IP = 10.229.201.171, Session disconnected. Session Type: IPsecOverNatT, Duration: 0h:05m:56s, Bytes xmt: 122161, Bytes rcv: 28794, Reason: User Requested</test_message>
						<test_value name='i0'>10.229.201.171</test_value>
						<test_value name='s0'>Acceso</test_value>
						<test_value name='s1'>juan</test_value>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name='ASA' id='2_ASA'>
		<pattern>%ASA</pattern>
		<rules>
			<rule provider='ELSA' class='2' id='2'>
				<patterns>
					<pattern>Inbound @ESTRING:i0: @connection denied from @ESTRING:i1:/@@ESTRING:i2: @to @ESTRING:i3:/@@ESTRING:i4: @@ESTRING::interface @@ANYSTRING:s0:@</pattern>
					<pattern>Deny@QSTRING:i0: @src@QSTRING:s0: :@@IPv4:i1:@/@NUMBER:i2:@ dst@QSTRING:s1: :@@IPv4:i3:@/@NUMBER:i4:@ by access-group @QSTRING:s2:&quot;@</pattern>
					<pattern>Deny @ESTRING:i0: @src @ESTRING:s0::@@IPv4:i1:@/@NUMBER:i2:@ dst @ESTRING:s1::@@IPv4:i3:@/@NUMBER:i4:@ by access-group @ESTRING:s2: @</pattern>
					<pattern>Deny @ESTRING:i0: @src @ESTRING:s0::@@IPv4:i1:@/@NUMBER:i2:@ dst @ESTRING:s1::@@ESTRING::/@@NUMBER:i4:@ by access-group @ESTRING:s2: @</pattern>
					<pattern>Deny @ESTRING:i0: @src @ESTRING:s0::@@ESTRING::/@@NUMBER:i2:@ dst @ESTRING:s1::@@IPv4:i3:@/@NUMBER:i4:@ by access-group @ESTRING:s2: @</pattern>
					<pattern>Deny @ESTRING:i0: @src @ESTRING:s0::@@IPv4:i1:@ dst @ESTRING:s1::@@IPv4:i3:@ (type @NUMBER::@, code @NUMBER::@) by access-group @ESTRING:s2: @</pattern>
					<pattern>Shunned packet: @IPv4:i1:@ ==&gt; @IPv4:i3:@ on interface @ANYSTRING:s0:@</pattern>
					<pattern>Deny @ESTRING:i0: @@ESTRING::from @@ESTRING:s0:-@@ESTRING:i1:-@@ESTRING::/@@ESTRING:i2: @to @ESTRING:s1:-@@ESTRING:i3:-@@ESTRING::/@@ESTRING:i4: @</pattern>
					<pattern>Deny inbound @ESTRING:i0: @from @ESTRING:i1:/@@ESTRING:i2: @to @ESTRING:i3:/@@ESTRING:i4: @on interface @ANYSTRING:s0:@</pattern>
					<pattern>Deny outbound @ESTRING:i0: @from @ESTRING:i1:/@@ESTRING:i2: @to @ESTRING:i3:/@@ESTRING:i4: @on interface @ANYSTRING:s0:@</pattern>
					<pattern>Deny IP spoof @ESTRING::to @@ESTRING:i3: @on interface @ANYSTRING:s0:@</pattern>
					<pattern>Deny inbound @ESTRING:i0: @src @ESTRING:s0::@@ESTRING:i1: @dst @ESTRING:s1::@@ESTRING:i3: @</pattern>
					<pattern>Deny @ESTRING:i0: @@ESTRING::from @@ESTRING:i1:/@@ESTRING:i2: @to @ESTRING:i3:/@@ESTRING:i4: @@ESTRING::interface @@ANYSTRING:s0:@</pattern>
					<pattern>Deny IP from @ESTRING:i1: @to @ESTRING:i3: @</pattern>
					<pattern>@ESTRING:i0: @access discarded from @ESTRING:i1:/@@NUMBER:i2:@ to @ESTRING:s0::@@ESTRING:i3:/@</pattern>
				</patterns>
			</rule>
			<rule provider='ELSA' class='3' id='3'>
				<patterns>
					<pattern>Teardown@QSTRING:i0: @connection @NUMBER::@ for@QSTRING:s0: :@@IPv4:i1:@/@NUMBER:i2:@ to@QSTRING:s1: :@@IPv4:i3:@/@NUMBER:i4:@ duration@QSTRING:s2: @bytes @NUMBER:i5:@</pattern>
					<pattern>access-list @ESTRING:: @permitted @ESTRING:i0: @@ESTRING:s0:/@@ESTRING:i1:(@@NUMBER:i2:@) -&gt; @ESTRING:s1:/@@ESTRING:i3:(@@NUMBER:i4:@) hit-cnt @NUMBER:i5:@</pattern>
					<pattern>@ESTRING:i0: @access permitted from @ESTRING:i1:/@@NUMBER:i2:@ to @ESTRING:s0::@@ESTRING:i3:/@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program='%ASA-7-106100'>access-list access_out permitted tcp INSIDE/10.221.221.21(52427) -&gt; OUTSIDE/10.222.222.22(80) hit-cnt 1 first hit [0x487d4278, 0x0]</test_message>
						<test_value name='i0'>tcp</test_value>
						<test_value name='i1'>10.221.221.21</test_value>
						<test_value name='i2'>52427</test_value>
						<test_value name='i3'>10.222.222.22</test_value>
						<test_value name='i4'>80</test_value>
						<test_value name='i5'>1</test_value>
						<test_value name='s0'>INSIDE</test_value>
						<test_value name='s1'>OUTSIDE</test_value>
					</example>
					<example>
						<test_message program='%ASA-6-302013'>Built inbound TCP connection 740617324 for inside:10.21.21.221/4087 (10.21.21.221/4087) to CWWAN:172.17.6.80/8192 (172.17.6.80/8192)</test_message>
						<test_value name='i0'>tcp</test_value>
						<test_value name='i1'>10.221.221.21</test_value>
						<test_value name='i2'>4087</test_value>
						<test_value name='i3'>172.17.6.80</test_value>
						<test_value name='i4'>8192</test_value>
						<test_value name='s0'>INSIDE</test_value>
						<test_value name='s1'>OUTSIDE</test_value>
					</example>
				</examples>
			</rule>
			<rule provider='ELSA' class='7' id='7'>
				<patterns>
					<pattern>@IPv4:i0:@ Accessed URL @IPv4:i1:@:@ESTRING::/@/@ESTRING:s1:/@@ANYSTRING:s2:@</pattern>
					<pattern>@IPv4:i0:@ Accessed URL @IPv4:i1:@:@ESTRING::/@/@ESTRING:s1:/@</pattern>
					<pattern>Access denied URL @ESTRING::/@/@ESTRING:s1:/@@ESTRING:s2: @SRC @IPv4:i0:@ DEST @IPv4:i1:@ on interface </pattern>
				</patterns>
				<examples>
					<example>
						<test_message program='%ASA-5-304001'>192.168.1.1 Accessed URL 10.0.0.0:http://www.example.com/wp-content/plugins/wp-spamfree/img/wpsf-img.php</test_message>
						<test_values>
							<test_value name='i0'>192.168.1.1</test_value>
							<test_value name='i1'>10.0.0.0</test_value>
							<test_value name='s1'>www.example.com</test_value>
							<test_value name='s2'>wp-content/plugins/wp-spamfree/img/wpsf-img.php</test_value>
						</test_values>
					</example>
					<example>
						<test_message program='ASA-5-304002'>Access denied URL http://www.example.com/feedout/content SRC 192.168.1.1 DEST 72.246.55.49 on interface inside</test_message>
							<test_values>
								<test_value name='s1'>www.example.com</test_value>
								<test_value name='s2'>feedout/content</test_value>
								<test_value name='i0'>192.168.1.1</test_value>
								<test_value name='i1'>72.246.55.49</test_value>
							</test_values>
					</example>
				</examples>
			</rule>
			<rule provider='ELSA' class='36' id='36'>
				<patterns>
					<pattern>Group =@QSTRING:s0: ,@ Username =@QSTRING:s1: ,@ IP = @IPv4:i0:@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program='%ASA-4-113019'>Group = Produccion, Username = pepe, IP = 10.245.102.86, Session disconnected. Session Type: IPsecOverNatT, Duration: 1h:38m:44s, Bytes xmt: 24545367, Bytes rcv: 3046464, Reason: Lost Service</test_message>
						<test_value name='i0'>10.245.102.86</test_value>
						<test_value name='s0'>Produccion</test_value>
						<test_value name='s1'>pepe</test_value>
					</example>
					<example>
						<test_message program='%ASA-4-113019'>Group = Acceso, Username = juan, IP = 10.229.201.171, Session disconnected. Session Type: IPsecOverNatT, Duration: 0h:05m:56s, Bytes xmt: 122161, Bytes rcv: 28794, Reason: User Requested</test_message>
						<test_value name='i0'>10.229.201.171</test_value>
						<test_value name='s0'>Acceso</test_value>
						<test_value name='s1'>juan</test_value>
					</example>
				</examples>
			</rule>
			<rule provider='ELSA' class='38' id='38'>
				<patterns>
					<pattern>FTP connection from @ESTRING:s0::@@ESTRING:i0:/@@NUMBER:i1:@ to @ESTRING:s1::@@ESTRING:i2:/@@NUMBER:i3:@, user @ESTRING:s2: @@ESTRING:s3: @@ANYSTRING:s4:@</pattern>
				</patterns>
			</rule>
			<rule provider='ELSA' class='39' id='39'>
				<patterns>
					<pattern>Cleared @ESTRING:i0: @urgent flag from @ESTRING:s0::@@ESTRING:i1:/@@NUMBER:i2:@ to @ESTRING:s1::@@ESTRING:i3:/@@NUMBER:i4:@</pattern>
					<pattern>regular translation creation failed for @ESTRING:i0: @src @ESTRING:s0::@@ESTRING:i1: @dst @ESTRING:s1::@@ESTRING:i3: @(type @NUMBER:i2:@, code @NUMBER:i4:@</pattern>
				</patterns>
			</rule>
		</rules>
	</ruleset>
	<ruleset name='PIX' id='2_PIX'>
		<pattern>%PIX</pattern>
		<rules>
			<rule provider='ELSA' class='2' id='2'>
				<patterns>
					<pattern>Deny@QSTRING:i0: @src@QSTRING:s0: :@@IPv4:i1:@/@NUMBER:i2:@ dst@QSTRING:s1: :@@IPv4:i3:@/@NUMBER:i4:@ by access-group @QSTRING:s2:&quot;@</pattern>
					<pattern>Shunned packet: @IPv4:i1:@ ==&gt; @IPv4:i3:@ on interface @ANYSTRING:s0:@</pattern>
				</patterns>
			</rule>
			<rule provider='ELSA' class='3' id='3'>
				<patterns>
					<pattern>Teardown@QSTRING:i0: @connection @NUMBER::@ for@QSTRING:s0: :@@IPv4:i1:@/@NUMBER:i2:@ to@QSTRING:s1: :@@IPv4:i3:@/@NUMBER:i4:@ duration@QSTRING:s2: @bytes @NUMBER:i5:@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program='%PIX-6-302014'>Teardown TCP connection 2050472353 for outside:10.65.200.34/1252 to inside:10.0.0.0/135 duration 0:00:00 bytes 1476 TCP FINs</test_message>
						<test_values>
							<test_value name='i0'>TCP</test_value>
							<test_value name='s0'>outside</test_value>
							<test_value name='i1'>10.65.200.34</test_value>
							<test_value name='i2'>1252</test_value>
							<test_value name='s1'>inside</test_value>
							<test_value name='i3'>10.0.0.0</test_value>
							<test_value name='i4'>135</test_value>
							<test_value name='s2'>0:00:00</test_value>
							<test_value name='i5'>1476</test_value>
						</test_values>
					</example>
				</examples>
			</rule>
			<rule provider='ELSA' class='36' id='36'>
				<patterns>
					<pattern>Group =@QSTRING:s0: ,@ Username =@QSTRING:s1: ,@ IP = @IPv4:i0:@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program='%PIX-4-113019'>Group = Produccion, Username = pepe, IP = 10.245.102.86, Session disconnected. Session Type: IPsecOverNatT, Duration: 1h:38m:44s, Bytes xmt: 24545367, Bytes rcv: 3046464, Reason: Lost Service</test_message>
						<test_value name='i0'>10.245.102.86</test_value>
						<test_value name='s0'>Produccion</test_value>
						<test_value name='s1'>pepe</test_value>
					</example>
					<example>
						<test_message program='%PIX-4-113019'>Group = Acceso, Username = juan, IP = 10.229.201.171, Session disconnected. Session Type: IPsecOverNatT, Duration: 0h:05m:56s, Bytes xmt: 122161, Bytes rcv: 28794, Reason: User Requested</test_message>
						<test_value name='i0'>10.229.201.171</test_value>
						<test_value name='s0'>Acceso</test_value>
						<test_value name='s1'>juan</test_value>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name='Cisco IOS XE Translations' id='3'>
		<pattern>%IOSXE-6-PLATFORM</pattern>
		<rules>
			<rule provider='ELSA' class='3' id='3'>
				<patterns>
					<pattern>@ESTRING::%NAT-6-LOG_TRANSLATION: Created Translation @@ESTRING:i0: @@IPv4:i1:@:@NUMBER:i2:@ @IPv4::@:@NUMBER::@ @IPv4::@:@NUMBER::@ @IPv4:i3:@:@NUMBER:i4:@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program='%IOSXE-6-PLATFORM'>F0: cpp_cp: QFP:0.0 Thread:031 TS:00000428205839105179 %NAT-6-LOG_TRANSLATION: Created Translation TCP 1.1.1.1:4227 1.1.1.1:1043 2.2.2.2:80 2.2.2.2:80 0</test_message>
						<test_values>
							<test_value name='i0'>TCP</test_value>
							<test_value name='i1'>1.1.1.1</test_value>
							<test_value name='i2'>1043</test_value>
							<test_value name='i3'>2.2.2.2</test_value>
							<test_value name='i4'>80</test_value>
						</test_values>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name='Cisco IOS XE Denies' id='2'>
		<pattern>%SEC-6-IPACCESSLOGS</pattern>
		<rules>
			<rule provider='ELSA' class='2' id='2'>
				<patterns>
					<pattern>list @ESTRING::denied @@IPv4:i3:@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program='%SEC-6-IPACCESSLOGS'>list REMOTE-MGMT denied 1.1.1.1 1 packet [0x7EAD30FB]</test_message>
						<test_values>
							<test_value name='i3'>1.1.1.1</test_value>
						</test_values>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name='Cisco IOS XE Denies' id='2'>
		<pattern>%FMANFP-6-IPACCESSLOGP</pattern>
		<rules>
			<rule provider='ELSA' class='2' id='2'>
				<patterns>
					<pattern>F@ESTRING::denied @@ESTRING:i0: @@IPv4:i1:@(@NUMBER:i2:@) -&gt; @IPv4:i3:@(@NUMBER:i4:@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program='%FMANFP-6-IPACCESSLOGP'>F0: fman_fp_image: list IPV4-INTERNET-OUTBOUND denied udp 1.1.1.1(49610) -&gt; 2.2.2.2(53), 1 packet</test_message>
						<test_values>
							<test_value name='i0'>udp</test_value>
							<test_value name='i1'>1.1.1.1</test_value>
							<test_value name='i2'>49610</test_value>
							<test_value name='i3'>2.2.2.2</test_value>
							<test_value name='i4'>53</test_value>
						</test_values>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name='Cisco IOS XE Denies' id='2'>
		<pattern>%FMANFP-6-IPV6ACCESSLOGP</pattern>
		<rules>
			<rule provider='ELSA' class='2' id='2'>
				<patterns>
					<pattern>F@ESTRING::denied @@ESTRING:i0: @@ESTRING:s0:(@@NUMBER:i2:@) -&gt; @ESTRING:s1:(@@NUMBER:i4:@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program='%FMANFP-6-IPV6ACCESSLOGP'>F0: fman_fp_image: list IPV6-INTERNET-INBOUND denied udp ffe:4e0::(38346) -&gt; ffe:4e0::(40322), 1 packet</test_message>
						<test_values>
							<test_value name='i0'>udp</test_value>
							<test_value name='s0'>ffe:4e0::</test_value>
							<test_value name='i2'>38346</test_value>
							<test_value name='s1'>ffe:4e0::</test_value>
							<test_value name='i4'>40322</test_value>
						</test_values>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name='Windows_Snare' id='4'>
		<pattern>MSWinEventLog</pattern>
		<pattern>Application</pattern>
		<pattern>Security</pattern>
		<pattern>System</pattern>
		<rules>
			<rule provider='ELSA' class='4' id='4'>
				<patterns>
					<pattern>@ESTRING::|@@ESTRING:i0:|@@ESTRING::Account Name@:  @ESTRING:s1: @@ESTRING::Account Domain@:  @ESTRING:s2: @</pattern>
					<pattern>@STRING::@ @NUMBER::@ @NUMBER::@:@NUMBER::@:@NUMBER::@ @NUMBER::@	@ESTRING:i0:	@@ESTRING:s0:	@@ESTRING:s1:	@@ESTRING:s2:	@@ESTRING:s3:	@@ESTRING:s4:	@@ESTRING:s5:	@@ESTRING::	@@ESTRING::	@</pattern>
					<pattern>@STRING::@ @NUMBER::@ @NUMBER::@:@NUMBER::@:@NUMBER::@ @NUMBER::@|@ESTRING:i0:|@@ESTRING:s0:|@@ESTRING::|@@ESTRING::|@@ESTRING:s3:|@@ESTRING:s4:|@@ESTRING:s5:|@|Logon Failure:@ESTRING::	@Reason:		@ESTRING:s2:	@User Name:	@ESTRING:s1: @</pattern>
					<pattern>@STRING::@ @NUMBER::@ @NUMBER::@:@NUMBER::@:@NUMBER::@ @NUMBER::@|@ESTRING:i0:|@@ESTRING:s0:|@@ESTRING:s1:|@@ESTRING:s2:|@@ESTRING:s3:|@@ESTRING:s4:|@@ESTRING:s5:|@@ESTRING::|@@ESTRING::|@</pattern>
					<pattern>@STRING::@ @NUMBER::@ @NUMBER::@:@NUMBER::@:@NUMBER::@ @NUMBER::@|@ESTRING:i0:|@@ESTRING:s0:|@@ESTRING:s1:|@@ANYSTRING@</pattern>
				</patterns>
			</rule>
		</rules>
	</ruleset>
	<ruleset name='Windows_evtsys' id='4'>
		<pattern>Application</pattern>
		<pattern>Security</pattern>
		<pattern>System</pattern>
		<rules>
			<rule provider='ELSA' class='4' id='4'>
				<patterns>
					<pattern>@NUMBER:i0:@: A network share object was accessed. Subject: Security ID: @ESTRING:: @Account Name: @ESTRING:s1: Account Domain@: @ESTRING:s2: Logon ID@: @ESTRING:: @Network Information: Object Type: File Source Address: @IPv4:i1:@ Source Port: @NUMBER::@ Share Information: Share Name: @ESTRING:s3: Share Path:@ @ESTRING:s4: Access Request Information:@ </pattern>
					<pattern>@NUMBER:i0:@: A network share object was accessed. Subject: Security ID: @ESTRING:: @Account Name: @ESTRING:s1: Account Domain@: @ESTRING:s2: Logon ID@: @ESTRING:: @Network Information: Object Type: File Source Address: @IPv4:i1:@ Source Port: @NUMBER::@ Share Information: Share Name: @ESTRING:s3: Share Path:@</pattern>
					<pattern>@NUMBER:i0:@: A network share object was checked to see whether client can be granted desired access. Subject: Security ID: @ESTRING:: @Account Name: @ESTRING:s1: @Account Domain: @ESTRING:s2: @Logon ID: @ESTRING:: @Network Information: Object Type: File Source Address: @ESTRING:i1: @Source Port: @NUMBER::@ Share Information: Share Name: @ESTRING:s3: @Share Path: @ESTRING:s4: @Relative Target Name: @ESTRING:s5: @Access</pattern>
					<pattern>@NUMBER:i0:@: @ESTRING::.@ Client IP address: @IPv4:s0::@</pattern>
					<pattern>@NUMBER:i0:@: @ESTRING:s0::@</pattern>
					<pattern>@NUMBER:i0:@: @ANYSTRING::@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program='Service_Control_Manager'>7035: NT AUTHORITYSYSTEM: The COH_Mon service was successfully sent a start control.</test_message>
						<test_values>
							<test_value name='i0'>7035</test_value>
							<test_value name='s0'>NT AUTHORITYSYSTEM</test_value>
						</test_values>
					</example>
					<example>
						<test_message program='SceCli'>1202: Security policies were propagated with warning. 0x4b8 : An extended error has occurred. For best results in resolving this event, log on with a non-administrative account and search http://support.microsoft.com for &quot;Troubleshooting Event 1202&apos;s&quot;.</test_message>
						<test_value name='i0'>1202</test_value>
						<test_value name='s0'>Security policies were propagated with warning. 0x4b8 </test_value>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name='Windows_evtsys' id='4'>
		<rules>
			<rule provider='ELSA' class='4' id='4'>
				<patterns>
					<pattern>@NUMBER:i0:@: @ESTRING::Account Name@@ESTRING::Account Name@:  @ESTRING:s1: @@ESTRING::Account Domain@:  @ESTRING:s2: @@ESTRING::Source Network Address@: @IPv4:i1:@</pattern>
					<pattern>@NUMBER:i0:@: A network share object was accessed. Subject: Security ID: @ESTRING:: @Account Name: @ESTRING:s1: Account Domain@: @ESTRING:s2: Logon ID@: @ESTRING:: @Network Information: Object Type: File Source Address: @IPv4:i1:@ Source Port: @NUMBER::@ Share Information: Share Name: @ESTRING:s3: Share Path:@ @ESTRING:s4: Access Request Information:@ </pattern>
					<pattern>@NUMBER:i0:@: A network share object was accessed. Subject: Security ID: @ESTRING:: @Account Name: @ESTRING:s1: Account Domain@: @ESTRING:s2: Logon ID@: @ESTRING:: @Network Information: Object Type: File Source Address: @IPv4:i1:@ Source Port: @NUMBER::@ Share Information: Share Name: @ESTRING:s3: Share Path:@</pattern>
					<pattern>@NUMBER:i0:@: A network share object was checked to see whether client can be granted desired access. Subject: Security ID: @ESTRING:: @Account Name: @ESTRING:s1: @Account Domain: @ESTRING:s2: @Logon ID: @ESTRING:: @Network Information: Object Type: File Source Address: @ESTRING:i1: @Source Port: @NUMBER::@ Share Information: Share Name: @ESTRING:s3: @Share Path: @ESTRING:s4: @Relative Target Name: @ESTRING:s5: @Access</pattern>
					<pattern>@NUMBER:i0:@: @ESTRING::.@ Client IP address: @IPv4:s0::@</pattern>
					<pattern>@NUMBER:i0:@: @ESTRING:s0::@</pattern>
					<pattern>@NUMBER:i0:@: @ANYSTRING::@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program='security-auditing'>4624: An account was successfully logged on. Subject:  Security ID:  S-1-5-18  Account Name:  MYDOMAIN-DC-1$  Account Domain:  MYDOMAIN  Logon ID:  0x3e7  Logon Type:   3  New Logon:  Security ID:  S-1-5-21-3113823999-9998615402-9997257512-9966  Account Name:  myuser  Account Domain:  MYDOMAIN  Logon ID:  0x2339f787  Logon GUID:  {00000000-0000-0000-0000-000000000000}  Process Information:  Process ID:  0x1e8  Process Name:  C:\\Windows\\System32\\lsass.exe  Network Information:  Workstation Name: MYDOMAIN-DC-1  Source Network Address: 172.24.248.117  Source Port:  54265  Detailed Authentication Information:  Logon Process:  Advapi    Authentication Package: MICROSOFT_AUTHENTICATION_PACKAGE_V1_0  Transited Services: -  Package Name (NTLM only): -  Key Length:  0  This event is generated when a logon session is created. It is generated on the computer that was accessed.</test_message>
						<test_values>
							<test_value name='i0'>4624</test_value>
							<test_value name='s1'>myuser</test_value>
							<test_value name='s2'>MYDOMAIN</test_value>
							<test_value name='i1'>172.24.248.117</test_value>
						</test_values>
					</example>
					<example>
						<test_message program='Service_Control_Manager'>7035: NT AUTHORITYSYSTEM: The COH_Mon service was successfully sent a start control.</test_message>
						<test_values>
							<test_value name='i0'>7035</test_value>
							<test_value name='s0'>NT AUTHORITYSYSTEM</test_value>
						</test_values>
					</example>
					<example>
						<test_message program='SceCli'>1202: Security policies were propagated with warning. 0x4b8 : An extended error has occurred. For best results in resolving this event, log on with a non-administrative account and search http://support.microsoft.com for &quot;Troubleshooting Event 1202&apos;s&quot;.</test_message>
						<test_value name='i0'>1202</test_value>
						<test_value name='s0'>Security policies were propagated with warning. 0x4b8 </test_value>
					</example>
					<example>
						<test_message program='security-auditing'>5140: A network share object was accessed. Subject: Security ID: S-1-5-18 Account Name: MYUSER Account Domain: MYDOMAIN Logon ID: 0x3e7 Network Information: Object Type: File Source Address: 192.168.148.5 Source Port: 49206 Share Information: Share Name: \\*\ADMIN$ Share Path: \??\C:\Windows Access Request Information: Access Mask: 0x1 Accesses: ReadData (or ListDirectory)</test_message>
						<test_value name='i0'>5140</test_value>
						<test_value name='s1'>MYUSER</test_value>
						<test_value name='s2'>MYDOMAIN</test_value>
						<test_value name='i1'>192.168.148.5</test_value>
						<test_value name='s3'>\\*\ADMIN$</test_value>
						<test_value name='s4'>\??\C:\Windows</test_value>
					</example>
					<example>
						<test_message program='security-auditing'>5140: A network share object was accessed. Subject: Security ID: S-1-5-7 Account Name: ANONYMOUS LOGON Account Domain: NT AUTHORITY Logon ID: 0x1e05bb9b Network Information: Object Type: File Source Address: 192.168.148.5 Source Port: 65518 Share Information: Share Name: \\\\*\\IPC$ Share Path: Access Request Information: Access Mask: 0x1 Accesses: ReadData (or ListDirectory)</test_message>
						<test_value name='i0'>5140</test_value>
						<test_value name='s1'>ANONYMOUS LOGON</test_value>
						<test_value name='s2'>NT AUTHORITY</test_value>
						<test_value name='i1'>192.168.148.5</test_value>
						<test_value name='s3'>\\\\*\\IPC$</test_value>
					</example>
					<example>
						<test_message program='security-auditing'>5145: A network share object was checked to see whether client can be granted desired access. Subject: Security ID: S-1-5-21-518783779-1162290680-929701000-2097 Account Name: MYUSER Account Domain: MYDOMAIN Logon ID: 0x19789189 Network Information: Object Type: File Source Address: 192.168.148.5 Source Port: 4235 Share Information: Share Name: \\*\SHARE_NAME Share Path: \??\C:\SHARE_PATH Relative Target Name: MYFILE Access Request Information: Access Mask: 0x80 Accesses: ReadAttributes Access Check Results: ReadAttributes: Granted by D:(A;;FA;;;WD)</test_message>
						<test_value name='i0'>5145</test_value>
						<test_value name='s1'>MYUSER</test_value>
						<test_value name='s2'>MYDOMAIN</test_value>
						<test_value name='i1'>192.168.148.5</test_value>
						<test_value name='s3'>\\*\SHARE_NAME</test_value>
						<test_value name='s4'>\??\C:\SHARE_PATH</test_value>
						<test_value name='s5'>MYFILE</test_value>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name='Windows_dhcp' id='4_dhcp'>
		<pattern>GenericLog</pattern>
		<rules>
			<rule provider='ELSA' class='4' id='4'>
				<patterns>
					<pattern>@NUMBER::@,@ANYSTRING::@</pattern>
					<values>
						<value name='i0'>0</value>
						<value name='s0'>dhcplog</value>
						<value name='PROGRAM'>dhcplog</value>
					</values>
				</patterns>
				<examples>
					<example>
						<test_message program='GenericLog'>30,11/16/10,12:25:04,DNS Update Request,x.x.x.x,hostname,,</test_message>
						<test_value name='i0'>0</test_value>
						<test_value name='s0'>dhcplog</test_value>
						<test_value name='PROGRAM'>dhcplog</test_value>
					</example>
					<example>
						<test_message program='GenericLog'>11,11/16/10,12:25:04,Renew,x.x.x.x,hostname,macaddr,</test_message>
						<test_value name='i0'>0</test_value>
						<test_value name='s0'>dhcplog</test_value>
						<test_value name='PROGRAM'>dhcplog</test_value>
					</example>
				</examples>
				<tags>
					<tag>4</tag>
				</tags>
			</rule>
		</rules>
	</ruleset>
	<ruleset name='Adiscon' id='4_adiscon'>
		<rules>
			<rule provider='ELSA' class='4' id='4'>
				<pattern>@ESTRING::Event ID@: @NUMBER:i0:@ &lt;Data Name=&apos;TargetUserName&apos;&gt;@ESTRING:s0:&lt;@</pattern>
				<pattern>@ESTRING::Event ID@: @NUMBER:i0:@</pattern>
				<examples>
					<example>
						<test_message program=''>Mar  9 22:35:10 IU-MSSG-ADSDC01.domain Event ID: 5157 &lt;Data Name=&apos;ProcessID&apos;&gt;180&lt;/Data&gt;&lt;Data Name=&apos;Application&apos;&gt;\device\harddiskvolume2\windows\system32\svchost.exe&lt;/Data&gt;&lt;Data Name=&apos;Direction&apos;&gt;%14592&lt;/Data&gt;&lt;Data Name=&apos;SourceAddress&apos;&gt;10.68.239.128&lt;/Data&gt;&lt;Data Name=&apos;SourcePort&apos;&gt;500&lt;/Data&gt;&lt;Data Name=&apos;DestAddress&apos;&gt;10.166.175.52&lt;/Data&gt;&lt;Data Name=&apos;DestPort&apos;&gt;500&lt;/Data&gt;&lt;Data Name=&apos;Protocol&apos;&gt;17&lt;/Data&gt;&lt;Data Name=&apos;FilterRTID&apos;&gt;73486&lt;/Data&gt;&lt;Data Name=&apos;LayerName&apos;&gt;%14610&lt;/Data&gt;&lt;Data Name=&apos;LayerRTID&apos;&gt;44&lt;/Data&gt;&lt;Data Name=&apos;RemoteUserID&apos;&gt;S-1-0-0&lt;/Data&gt;&lt;Data Name=&apos;RemoteMachineID&apos;&gt;S-1-0-0&lt;/Data&gt;</test_message>
						<test_value name='i0'>5157</test_value>
					</example>
					<example>
						<test_message program=''>Mar  9 22:35:10 IU-MSSG-ADSDC04.domain Event ID: 4769 &lt;Data Name=&apos;TargetUserName&apos;&gt;user@domain&lt;/Data&gt;&lt;Data Name=&apos;TargetDomainName&apos;&gt;domain&lt;/Data&gt;&lt;Data Name=&apos;ServiceName&apos;&gt;IU-MSSG-ADSDC04$&lt;/Data&gt;&lt;Data Name=&apos;ServiceSid&apos;&gt;S-1-5-21-1085031214-1292428093-527237240-496356&lt;/Data&gt;&lt;Data Name=&apos;TicketOptions&apos;&gt;0x40810000&lt;/Data&gt;&lt;Data Name=&apos;TicketEncryptionType&apos;&gt;0x12&lt;/Data&gt;&lt;Data Name=&apos;IpAddress&apos;&gt;::ffff:10.160.118.87&lt;/Data&gt;&lt;Data Name=&apos;IpPort&apos;&gt;54144&lt;/Data&gt;&lt;Data Name=&apos;Status&apos;&gt;0x0&lt;/Data&gt;&lt;Data Name=&apos;LogonGuid&apos;&gt;{CD66EF59-4404-F056-C1CC-5E12BE6B978E}&lt;/Data&gt;&lt;Data Name=&apos;TransmittedServices&apos;&gt;-&lt;/Data&gt;</test_message>
						<test_value name='i0'>4769</test_value>
						<test_value name='s0'>user@domain</test_value>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name='url' id='7'>
		<pattern>url</pattern>
		<rules>
			<rule provider='ELSA' class='7' id='7'>
				<patterns>
					<pattern>@IPv4:i0:@,@IPv4:i1:@,@ESTRING:s0:,@@ESTRING:s1:,@@ESTRING:s2:,@@ESTRING:s3:,@@ESTRING:s4:|@@ESTRING:s5:|@@ESTRING:i2:|@@NUMBER:i3:@|@NUMBER:i4:@</pattern>
					<pattern>@IPv4:i0:@,@IPv4:i1:@,@ESTRING:s0:,@@ESTRING:s1:,@@ESTRING:s2:,@@ESTRING:s3:,@@ESTRING:s4:|@@ESTRING:s5:|@@ESTRING:i2:|@|@NUMBER:i4:@</pattern>
					<pattern>@IPv4:i0:@,@IPv4:i1:@,@ESTRING:s0:,@@ESTRING:s1:,@@ESTRING:s2:,@@ESTRING:s3:,@@ESTRING:s4:|@@ESTRING:s5:|@@ESTRING:i2:|@</pattern>
					<pattern>@IPv4:i0:@|@IPv4:i1:@|@ESTRING:s0:|@@ESTRING:s1:|@@ESTRING:s2:|@@ESTRING:s3:|@@ESTRING:s4:|@@ESTRING:s5:|@@ESTRING:i2:|@@ESTRING:i3:|@@ESTRING:i4:|@@NUMBER:i5@</pattern>
					<pattern>@IPv4:i0:@|@IPv4:i1:@|@ESTRING:s0:|@@ESTRING:s1:|@@ESTRING:s2:|@@ESTRING:s3:|@@ESTRING:s4:|@@ESTRING:s5:|@@ESTRING:i2:|@@NUMBER:i3:@|@NUMBER:i4:@</pattern>
					<pattern>@IPv4:i0:@|@IPv4:i1:@|@ESTRING:s0:|@@ESTRING:s1:|@@ESTRING:s2:|@@ESTRING:s3:|@@ESTRING:s4:|@@ESTRING:s5:|@@ESTRING:i2:|@|@NUMBER:i4:@</pattern>
					<pattern>@IPv4:i0:@|@IPv4:i1:@|@ESTRING:s0:|@@ESTRING:s1:|@@ESTRING:s2:|@@ESTRING:s3:|@@ESTRING:s4:|@@ESTRING:s5:|@@ESTRING:i2:|@@NUMBER:i3:@|</pattern>
					<pattern>@IPv4:i0:@|@IPv4:i1:@|@ESTRING:s0:|@@ESTRING:s1:|@@ESTRING:s2:|@@ESTRING:s3:|@@ESTRING:s4:|@@ESTRING:s5:|@@ESTRING:i2:|@</pattern>
					<pattern>@ESTRING:: @@ESTRING:s1: [**] @@ESTRING:s2: [**] @@ESTRING:s4: [**] @@IPv4:i0:@:@NUMBER:i1:@ -&gt; @IPv4:i2:@:@NUMBER:i3:@</pattern>
					<pattern>@ESTRING:: @@ESTRING:s1: [**] @@ESTRING:s2: [**] @@ESTRING:s4: [**] @@ESTRING:s3: [**] @@ESTRING:s0: [**] @@ESTRING:: [**] @@ESTRING:i2: [**] @@NUMBER:i3:@ bytes [**] @IPv4:i0:@:@NUMBER:i4:@ -&gt; @IPv4:i1:@:@NUMBER:i5:@</pattern>
					<pattern>@IPv4:i0:@ @ESTRING:: @@ESTRING:s5: @@ESTRING:: &quot;@@ESTRING:s0: @@ESTRING:s2: @HTTP/1.@NUMBER::@&quot; @NUMBER:i2:@ @NUMBER:i3:@ @QSTRING:s3:&quot;@ @QSTRING:s4:&quot;@</pattern>
					<pattern>@ESTRING:s1: @@IPv4:i0:@ @ESTRING:: @@ESTRING:s5: @@ESTRING:: &quot;@@ESTRING:s0: @@ESTRING:s2: @HTTP/1.@NUMBER::@&quot; @NUMBER:i2:@ @NUMBER:i3:@ @QSTRING:s3:&quot;@ @QSTRING:s4:&quot;@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program='url'>192.168.1.1,10.0.0.0,GET,ajax.googleapis.com,/ajax/libs/jqueryui/1.7.2/jquery-ui.min.js,http://slickdeals.net/,Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; .NET CLR 2.0.50727; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729)|,com,googleapis.com,ajax.googleapis.com|200|46142|8583</test_message>
						<test_values>
							<test_value name='i0'>192.168.1.1</test_value>
							<test_value name='i1'>10.0.0.0</test_value>
							<test_value name='s0'>GET</test_value>
							<test_value name='s1'>ajax.googleapis.com</test_value>
							<test_value name='s2'>/ajax/libs/jqueryui/1.7.2/jquery-ui.min.js</test_value>
							<test_value name='s3'>http://slickdeals.net/</test_value>
							<test_value name='s4'>Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; .NET CLR 2.0.50727; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729)</test_value>
							<test_value name='s5'>,com,googleapis.com,ajax.googleapis.com</test_value>
							<test_value name='i2'>200</test_value>
							<test_value name='i3'>46142</test_value>
							<test_value name='i4'>8583</test_value>
						</test_values>
					</example>
					<example>
						<test_message program='url'>192.168.1.1,10.0.0.0,GET,ajax.googleapis.com,/ajax/libs/jqueryui/1.7.2/jquery-ui.min.js,http://slickdeals.net/,Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; .NET CLR 2.0.50727; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729)|,com,googleapis.com,ajax.googleapis.com|200||8583</test_message>
						<test_values>
							<test_value name='i0'>192.168.1.1</test_value>
							<test_value name='i1'>10.0.0.0</test_value>
							<test_value name='s0'>GET</test_value>
							<test_value name='s1'>ajax.googleapis.com</test_value>
							<test_value name='s2'>/ajax/libs/jqueryui/1.7.2/jquery-ui.min.js</test_value>
							<test_value name='s3'>http://slickdeals.net/</test_value>
							<test_value name='s4'>Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; .NET CLR 2.0.50727; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729)</test_value>
							<test_value name='s5'>,com,googleapis.com,ajax.googleapis.com</test_value>
							<test_value name='i2'>200</test_value>
							<test_value name='i3'></test_value>
							<test_value name='i4'>8583</test_value>
						</test_values>
					</example>
					<example>
						<test_message program='url'>192.168.1.1,10.0.0.0,GET,ajax.googleapis.com,/ajax/libs/jqueryui/1.7.2/jquery-ui.min.js,http://slickdeals.net/,Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; .NET CLR 2.0.50727; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729)|,com,googleapis.com,ajax.googleapis.com|200||</test_message>
						<test_values>
							<test_value name='i0'>192.168.1.1</test_value>
							<test_value name='i1'>10.0.0.0</test_value>
							<test_value name='s0'>GET</test_value>
							<test_value name='s1'>ajax.googleapis.com</test_value>
							<test_value name='s2'>/ajax/libs/jqueryui/1.7.2/jquery-ui.min.js</test_value>
							<test_value name='s3'>http://slickdeals.net/</test_value>
							<test_value name='s4'>Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; .NET CLR 2.0.50727; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729)</test_value>
							<test_value name='s5'>,com,googleapis.com,ajax.googleapis.com</test_value>
							<test_value name='i2'>200</test_value>
							<test_value name='i3'></test_value>
							<test_value name='i4'></test_value>
						</test_values>
					</example>
					<example>
						<test_message program='url'>127.0.0.1 - - [09/Dec/2012:23:20:27 -0600] &quot;HEAD / HTTP/1.1&quot; 200 334 &quot;-&quot; &quot;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/536.11 (KHTML, like Gecko) Ubuntu/12.04 Chromium/20.0.1132.47 Chrome/20.0.1132.47 Safari/536.11&quot;</test_message>
						<test_values>
							<test_value name='i0'>127.0.0.1</test_value>
							<test_value name='s0'>HEAD</test_value>
							<test_value name='s2'>/</test_value>
							<test_value name='s3'>-</test_value>
							<test_value name='s4'>Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/536.11 (KHTML, like Gecko) Ubuntu/12.04 Chromium/20.0.1132.47 Chrome/20.0.1132.47 Safari/536.11</test_value>
							<test_value name='s5'>-</test_value>
							<test_value name='i2'>200</test_value>
							<test_value name='i3'>334</test_value>
						</test_values>
					</example>
					</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name='snort' id='8'>
		<pattern>snort</pattern>
		<rules>
			<rule provider='ELSA' class='8' id='8'>
				<patterns>
					<pattern>@QSTRING:s0:[]@ @ESTRING:s1:[@Classification:@QSTRING:s2: ]@ [Priority: @NUMBER:i0:@] @QSTRING:i1:{}@ @IPv4:i2:@:@NUMBER:i3:@ -&gt; @IPv4:i4:@:@NUMBER:i5:@</pattern>
					<pattern>@QSTRING:s0:[]@ @ESTRING:s1:[@Classification:@QSTRING:s2: ]@ [Priority: @NUMBER:i0:@] @QSTRING:i1:{}@ @IPv4:i2:@ -&gt; @IPv4:i4:@</pattern>
					<pattern>@QSTRING:s0:[]@ @ESTRING:s1:[@Classification:@QSTRING:s2: ]@ [Priority: @NUMBER:i0:@]: @QSTRING:i1:{}@ @IPv4:i2:@:@NUMBER:i3:@ -&gt; @IPv4:i4:@:@NUMBER:i5:@</pattern>
					<pattern>@QSTRING:s0:[]@ @ESTRING:s1:[@Classification:@QSTRING:s2: ]@ [Priority: @NUMBER:i0:@]: @QSTRING:i1:{}@ @IPv4:i2:@ -&gt; @IPv4:i4:@</pattern>
					<pattern>@QSTRING:s0:[]@ @ESTRING:s1: {@@ESTRING:i1:}@ @IPv4:i2:@:@NUMBER:i3:@ -&gt; @IPv4:i4:@:@NUMBER:i5:@</pattern>
				</patterns>
				<example>
					<test_message program='snort'>[1:485:5] ICMP Destination Unreachable Communication Administratively Prohibited [Classification: Misc activity] [Priority: 3] {ICMP} 192.168.1.1 -&gt; 10.0.0.0</test_message>
					<test_value name='s0'>1:485:5</test_value>
					<test_value name='s1'>ICMP Destination Unreachable Communication Administratively Prohibited </test_value>
					<test_value name='s2'>Misc activity</test_value>
					<test_value name='i0'>3</test_value>
					<test_value name='i1'>ICMP</test_value>
					<test_value name='i2'>192.168.1.1</test_value>
					<test_value name='i4'>10.0.0.0</test_value>
				</example>
			</rule>
			<rule provider='Laurel' class='8' id='8'>
				<patterns>
					<pattern>@QSTRING:s0:[]@ @ESTRING:s1: [@Classification:@QSTRING:s2: ]@ [Priority: @NUMBER:i0:@] @QSTRING:s3:&lt;&gt;@ @QSTRING:i1:{}@ @IPv4:i2:@:@NUMBER:i3:@ -&gt; @IPv4:i4:@:@NUMBER:i5:@</pattern>
					<pattern>@QSTRING:s0:[]@ @ESTRING:s1:[@Classification:@QSTRING:s2: ]@ [Priority: @NUMBER:i0:@] @QSTRING:s3:&lt;&gt;@ @QSTRING:i1:{}@ @IPv4:i2:@ -&gt; @IPv4:i4:@</pattern>
					<pattern>@QSTRING:s0:[]@ @ESTRING:s1:[@Classification:@QSTRING:s2: ]@ [Priority: @NUMBER:i0:@]: @QSTRING:s3:&lt;&gt;@ @QSTRING:i1:{}@ @IPv4:i2:@:@NUMBER:i3:@ -&gt; @IPv4:i4:@:@NUMBER:i5:@</pattern>
					<pattern>@QSTRING:s0:[]@ @ESTRING:s1:[@Classification:@QSTRING:s2: ]@ [Priority: @NUMBER:i0:@]: @QSTRING:s3:&lt;&gt;@ @QSTRING:i1:{}@ @IPv4:i2:@ -&gt; @IPv4:i4:@</pattern>
					<pattern>@QSTRING:s0:[]@@QSTRING:s1: @[Classification:@QSTRING:s2: ]@ [Priority@QSTRING:i0: ]@: @QSTRING:i1:{}@ @IPv4:i2:@:@NUMBER:i3:@ -&gt; @IPv4:i4:@:@NUMBER:i5:@</pattern>
				</patterns>
				<example>
					<test_message program='snort'>[1:2010939:2] ET POLICY Suspicious inbound to PostgreSQL port 5432 [Classification: Potentially Bad Traffic] [Priority: 2]: &lt;eth1&gt; {TCP} 192.168.193.245:38472 -&gt; 192.168.193.1:5432</test_message>
					<test_value name='s0'>1:2010939:2</test_value>
					<test_value name='s1'>ET POLICY Suspicious inbound to PostgreSQL port 5432 </test_value>
					<test_value name='s2'>Potentially Bad Traffic</test_value>
					<test_value name='s3'>eth1</test_value>
					<test_value name='i0'>2</test_value>
					<test_value name='i1'>TCP</test_value>
					<test_value name='i2'>192.168.193.245</test_value>
					<test_value name='i3'>38472</test_value>
					<test_value name='i4'>192.168.193.1</test_value>
					<test_value name='i5'>5432</test_value>
				</example>
			</rule>
			<rule provider='A Ratcliffe' class='8' id='8'>
				<patterns>
					<pattern>@QSTRING:s0:[]@ @ESTRING:s1: [Classification@:@QSTRING:s2: ]@ [Priority: @NUMBER:i0:@]: @QSTRING:s3:&lt;&gt;@ @QSTRING:i1:{}@ @IPv4:i2:@:@NUMBER:i3:@ -&gt; @IPv4:i4:@:@NUMBER:i5:@</pattern>
					<pattern>@QSTRING:s0:[]@ [@ESTRING::]@ @ESTRING:s1: [Classification@:@QSTRING:s2: ]@ [Priority: @NUMBER:i0:@]: @QSTRING:s3:&lt;&gt;@ @QSTRING:i1:{}@ @IPv4:i2:@:@NUMBER:i3:@ -&gt; @IPv4:i4:@:@NUMBER:i5:@</pattern>
				</patterns>
			</rule>
			<rule class='8' id='8'>
				<patterns>
					<pattern>@NUMBER:pdb_extracted_month:@/@NUMBER:pdb_extracted_day:@/@NUMBER:pdb_extracted_shortyear:@-@NUMBER:pdb_extracted_hour:@:@NUMBER:pdb_extracted_minute:@:@NUMBER:pdb_extracted_second:@.@NUMBER::@@ESTRING::[**]@ @QSTRING:s0:[]@ @ESTRING:s1: [**] [@Classification:@ESTRING:s2:] @[Priority: @NUMBER:i0:@] {@ESTRING:i1:}@ @IPv4:i2:@:@NUMBER:i3:@ -&gt; @IPv4:i4:@:@NUMBER:i5:@</pattern>
					<pattern>@NUMBER:pdb_extracted_month:@/@NUMBER:pdb_extracted_day:@/@NUMBER:pdb_extracted_shortyear:@-@NUMBER:pdb_extracted_hour:@:@NUMBER:pdb_extracted_minute:@:@NUMBER:pdb_extracted_second:@.@NUMBER::@@ESTRING::[**]@ @QSTRING:s0:[]@ @ESTRING:s1: [**] [@Classification:@ESTRING:s2:] @[Priority: @NUMBER:i0:@] {@ESTRING:i1:}@ @IPv4:i2:@ -&gt; @IPv4:i4:@</pattern>
				</patterns>	
				<values>
					<value name='pdb_extracted_timestamp'>20$pdb_extracted_shortyear-$pdb_extracted_month-$pdb_extracted_day $pdb_extracted_hour:$pdb_extracted_minute:$pdb_extracted_second</value>
				</values>
			</rule>
			<rule provider='C Martinez' class='8' id='8'>
				<patterns>
					<pattern>@ESTRING:: [**]@@QSTRING:s0:[]@ @ESTRING:s1:[@Classification:@QSTRING:s2: ]@[Priority: @NUMBER:i0:@] @QSTRING:i1:{}@ @IPv4:i2:@:@NUMBER:i3:@ -&gt;@IPv4:i4:@:@NUMBER:i5:@</pattern>
					<pattern>@ESTRING:: [**]@@QSTRING:s0:[]@ @ESTRING:s1:[@Classification:@QSTRING:s2: ]@[Priority: @NUMBER:i0:@] @QSTRING:i1:{}@ @IPv4:i2:@ -&gt;@IPv4:i4:@</pattern>
					<pattern>@ESTRING:: [**]@@QSTRING:s0:[]@ @ESTRING:s1:[@Classification:@QSTRING:s2: ]@[Priority: @NUMBER:i0:@]: @QSTRING:i1:{}@ @IPv4:i2:@:@NUMBER:i3:@ -&gt;@IPv4:i4:@:@NUMBER:i5:@</pattern>
					<pattern>@ESTRING:: [**]@@QSTRING:s0:[]@ @ESTRING:s1:[@Classification:@QSTRING:s2: ]@[Priority: @NUMBER:i0:@]: @QSTRING:i1:{}@ @IPv4:i2:@ -&gt;@IPv4:i4:@</pattern>
					<pattern>@ESTRING:: [**]@@QSTRING:s0:[]@ @ESTRING:s1: {@@ESTRING:i1:}@ @IPv4:i2:@:@NUMBER:i3:@-&gt; @IPv4:i4:@:@NUMBER:i5:@</pattern>
					<pattern>@ESTRING:: [**]@@QSTRING:s0:[]@ @ESTRING:s1: [**] [@Classification:@QSTRING:s2: ]@[Priority: @NUMBER:i0:@] @QSTRING:i1:{}@ @IPv4:i2:@:@NUMBER:i3:@ -&gt; @IPv4:i4:@:@NUMBER:i5:@</pattern>
					<pattern>@ESTRING:: [**]@@QSTRING:s0:[]@ @ESTRING:s1: [**] [@Classification:@QSTRING:s2: ]@[Priority: @NUMBER:i0:@] @QSTRING:i1:{}@ @IPv4:i2:@ -&gt; @IPv4:i4:@</pattern>
					<pattern>@ESTRING:: [**]@ @QSTRING:s0:[]@ @ESTRING:s1: [**] [@Classification:@QSTRING:s2: ]@ [Priority: @NUMBER:i0:@] @QSTRING:i1:{}@ @IPv4:i2:@:@NUMBER:i3:@ -&gt; @IPv4:i4:@:@NUMBER:i5:@</pattern>
					<pattern>@ESTRING:: [**]@ @QSTRING:s0:[]@ @ESTRING:s1: [**] [@Classification:@QSTRING:s2: ]@ [Priority: @NUMBER:i0:@] @QSTRING:i1:{}@ @IPv4:i2:@ -&gt; @IPv4:i4:@</pattern>
					<pattern>@ESTRING:: [**]@@QSTRING:s0:[]@ @ESTRING:s1: [**] [@Classification:@QSTRING:s2: ]@[Priority: @NUMBER:i0:@]: @QSTRING:i1:{}@ @IPv4:i2:@:@NUMBER:i3:@ -&gt; @IPv4:i4:@:@NUMBER:i5:@</pattern>
					<pattern>@ESTRING:: [**]@@QSTRING:s0:[]@ @ESTRING:s1: [**] [@Classification:@QSTRING:s2: ]@[Priority: @NUMBER:i0:@]: @QSTRING:i1:{}@ @IPv4:i2:@ -&gt; @IPv4:i4:@</pattern>
					<pattern>@ESTRING:: [**]@@QSTRING:s0:[]@ @ESTRING:s1: [**] {@@ESTRING:i1:}@@IPv4:i2:@:@NUMBER:i3:@ -&gt; @IPv4:i4:@:@NUMBER:i5:@</pattern>
				</patterns>
			</rule>
		</rules>
	</ruleset>
	<ruleset name='ssh'>
		<pattern>sshd</pattern>
		<rules>
			<rule class='11' id='11'>
				<patterns>
					<pattern>Accepted @ESTRING:s0: @for @ESTRING:s1: @from @ESTRING:s2: @port @ESTRING:i0: @@ANYSTRING:s3@</pattern>
				</patterns>
			</rule>
			<rule class='12' id='12'>
				<patterns>
					<pattern>Failed @ESTRING:s0: @for @ESTRING:s1: @from @ESTRING:s2: @port @ESTRING:i0: @@ANYSTRING:s3@</pattern>
					<pattern>Failed @ESTRING:s0: @for invalid user @ESTRING:s1: @from @ESTRING:s2: @port @ESTRING:i0: @@ANYSTRING:s3@</pattern>
					<pattern>Failed @ESTRING:s0: @for illegal user @ESTRING:s1: @from @ESTRING:s2: @port @ESTRING:i0: @@ANYSTRING:s3@</pattern>
				</patterns>
			</rule>
			<rule class='13' id='13'>
				<patterns>
					<pattern>pam_unix(sshd:session): session closed for user @ANYSTRING:s0:@</pattern>
					<pattern>session closed for user @ANYSTRING:s0:@</pattern>
				</patterns>
			</rule>
		</rules>
	</ruleset>
	<ruleset>
		<pattern>bro_smtp_entities</pattern>
		<rules>
			<rule class='17' id='17'>
				<patterns>
					<pattern>@ESTRING::|@@ESTRING::|@@ESTRING:i0:|@@ESTRING:i1:|@@ESTRING:i2:|@@ESTRING:i3:|@@ESTRING::|@@ESTRING:s0:|@@ESTRING:i4:|@@ESTRING:s1:|@@ESTRING:s2:|@@ESTRING:s3:|@@ESTRING:s4:@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program='bro_smtp_entities'>1320613389.303478|zQQiHb1x3fj|216.33.127.82|37295|10.0.0.0|25|@VqmVdbY2Mm3|CDocuments and SettingsckaiserLocal SettingsTemporary Internet FilesContent.IE535ZF226Areport[3].pdf|54399|application/pdf|-|-|-</test_message>
						<test_value name='i0'>216.33.127.82</test_value>
						<test_value name='i1'>37295</test_value>
						<test_value name='i2'>10.0.0.0</test_value>
						<test_value name='i3'>25</test_value>
						<test_value name='s0'>CDocuments and SettingsckaiserLocal SettingsTemporary Internet FilesContent.IE535ZF226Areport[3].pdf</test_value>
						<test_value name='i4'>54399</test_value>
						<test_value name='s1'>application/pdf</test_value>
						<test_value name='s2'>-</test_value>
						<test_value name='s3'>-</test_value>
						<test_value name='s4'>-</test_value>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name='fortinet_url' id='21'>
		<pattern>kernel</pattern>
		<rules>
			<rule provider='ELSA' class='21' id='21'>
				<patterns>
					<pattern>date=@ESTRING:: @time=@ESTRING:: @devname=@ESTRING:: @device_id=@ESTRING:: @log_id=@ESTRING:: @subtype=@ESTRING:: @type=webfilter pri=@ESTRING:: @vd=@ESTRING:: @policyid=@ESTRING:: @identidx=@ESTRING:: @serial=@ESTRING:: @user=@ESTRING:s0: @group=@ESTRING:s1: @src=@IPv4:i0:@ sport=@ESTRING:i1: @src_port=@ESTRING:: @src_int=@ESTRING:: @dst=@IPv4:i2:@ dport=@ESTRING:i3: @dst_port=@ESTRING:: @dst_int=@ESTRING:: @service=@ESTRING:s2: @hostname=@ESTRING:s3: @profiletype=@ESTRING:: @profile=@ESTRING:: @status=@ESTRING:s4: @req_type=@ESTRING:: @url=@ESTRING:s5: @method=@ESTRING:: @class=@ESTRING:: @cat=@ESTRING:i4: @cat_desc=@QSTRING::&quot;&quot;@ carrier_ep=@ESTRING:: @msg=@QSTRING::&quot;&quot;@ class_desc=@ESTRING:: @profilegroup=</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program='kernel'>date=2012-02-10 time=11:27:01 devname=CUSTID01-SITEID-FW device_id=FG100C999999999 log_id=13312 subtype=ftgd_allow type=webfilter pri=notice vd=VDOM policyid=44 identidx=1 serial=369298248 user=USER group=AD/GROUP src=10.1.2.3 sport=2163 src_port=2163 src_int=INT dst=4.3.2.1 dport=80 dst_port=80 dst_int=WAN service=http hostname=col.stb.s-msn.com profiletype=Webfilter_Profile profile=PROFILE status=passthrough req_type=referral url=/i/79/65F987C952BDA0E84AE52464ADD59.jpg method=domain class=0 cat=41 cat_desc=&quot;Search Engines and Portals&quot; carrier_ep=N/A msg=&quot;URL belongs to an allowed category in policy&quot; class_desc=N/A profilegroup=N/A</test_message>
						<test_values>
							<test_value name='i0'>10.1.2.3</test_value>
							<test_value name='i1'>2163</test_value>
							<test_value name='i2'>4.3.2.1</test_value>
							<test_value name='i3'>80</test_value>
							<test_value name='s0'>USER</test_value>
							<test_value name='s1'>AD/GROUP</test_value>
							<test_value name='s2'>http</test_value>
							<test_value name='s3'>col.stb.s-msn.com</test_value>
							<test_value name='s4'>passthrough</test_value>
							<test_value name='s5'>/i/79/65F987C952BDA0E84AE52464ADD59.jpg</test_value>
							<test_value name='i4'>41</test_value>
						</test_values>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name='fortinet_traffic' id='22'>
		<pattern>kernel</pattern>
		<rules>
			<rule provider='ELSA' class='22' id='22'>
				<patterns>
					<pattern>date=@ESTRING:: @time=@ESTRING:: @devname=@ESTRING:: @device_id=@ESTRING:: @log_id=@ESTRING:: @subtype=@ESTRING:: @type=traffic pri=@ESTRING:: @vd=@ESTRING:: @dir_disp=@ESTRING:: @tran_disp=@ESTRING:: @src=@IPv4:i0:@ srcname=@ESTRING:: @src_port=@NUMBER:i1:@ dst=@IPv4:i2:@ dstname=@ESTRING:: @dst_port=@NUMBER:i3:@ tran_ip=@ESTRING:: @tran_port=@ESTRING:: @service=@ESTRING:: @proto=@NUMBER:i4@ app_type=@ESTRING:: @duration=@NUMBER:i5@ rule=@ESTRING:: @policyid=@ESTRING:: @identidx=@ESTRING:: @sent=@ESTRING:: @rcvd=@ESTRING:: @shaper_drop_sent=@ESTRING:: @shaper_drop_rcvd=@ESTRING:: @perip_drop=@ESTRING:: @sent_pkt=@ESTRING:: @rcvd_pkt=@ESTRING:: @src_int=@ESTRING:: @dst_int=@ESTRING:: @SN=@ESTRING:: @app=@ESTRING:: @app_cat=@ESTRING:: @carrier_ep=@ESTRING:: @vpn=@ESTRING:: @status=@ESTRING:: @user=@ESTRING:: @group=@ESTRING:: @shaper_sent_name=@ESTRING:: @shaper_rcvd_name=@ESTRING:: @perip_name</pattern>
					<pattern>date=@ESTRING:: @time=@ESTRING:: @devname=@ESTRING:: @devid=@ESTRING:: @logid=@ESTRING:: @type=traffic subtype=@ESTRING:: @level=@ESTRING:: @vd=@ESTRING:: @srcip=@IPv4:i0:@ srcport=@NUMBER:i1:@ srcintf=@QSTRING::&quot;&quot;@ dstip=@IPv4:i2:@ dstport=@NUMBER:i3:@ dstintf=@QSTRING::&quot;&quot;@ sessionid=@ESTRING:: @status=@ESTRING:: @policyid=@ESTRING:: @dstcountry=@QSTRING::&quot;&quot;@ srccountry=@QSTRING::&quot;&quot;@ trandisp=@ESTRING:: @tranip=@ESTRING:: @tranport=@ESTRING:: @service=@ESTRING:: @proto=@NUMBER:i4:@ duration=@NUMBER:i5:@ sentbyte=@ESTRING:: @rcvdbyte=@ESTRING:: @sentpkt=@ESTRING:: @rcvdpkt</pattern>
					<pattern>date=@ESTRING:: @time=@ESTRING:: @devname=@ESTRING:: @devid=@ESTRING:: @logid=@ESTRING:: @type=traffic subtype=@ESTRING:: @level=@ESTRING:: @vd=@ESTRING:: @srcip=@IPv4:i0:@ srcport=@NUMBER:i1:@ srcintf=@QSTRING::&quot;&quot;@ dstip=@IPv4:i2:@ dstport=@NUMBER:i3:@ dstintf=@QSTRING::&quot;&quot;@ sessionid=@ESTRING:: @status=@ESTRING:: @policyid=@ESTRING:: @dstcountry=@QSTRING::&quot;&quot;@ srccountry=@QSTRING::&quot;&quot;@ trandisp=@ESTRING:: @tranip=@ESTRING:: @tranport=@ESTRING:: @transip=@ESTRING:: @transport=@ESTRING:: @service=@ESTRING:: @proto=@NUMBER:i4:@ duration=@NUMBER:i5:@ sentbyte=@ESTRING:: @rcvdbyte=@ESTRING:: @sentpkt=@ESTRING:: @rcvdpkt</pattern>
					<pattern>date=@ESTRING:: @time=@ESTRING:: @devname=@ESTRING:: @device_id=@ESTRING:: @log_id=@ESTRING:: @type=traffic subtype=@ESTRING:: @pri=@ESTRING:: @vd=@ESTRING:: @src=@IPv4:i0:@ src_port=@NUMBER:i1:@ src_int=@QSTRING::&quot;&quot;@ dst=@IPv4:i2:@ dst_port=@NUMBER:i3:@ dst_int=@QSTRING::&quot;&quot;@ SN=@ESTRING:: @status=@ESTRING:: @policyid=@ESTRING:: @dst_country=@QSTRING::&quot;&quot;@ src_country=@QSTRING::&quot;&quot;@ service=@ESTRING:: @proto=@NUMBER:i4:@ duration=@NUMBER:i5:@ sent=@ESTRING:: @rcvd=@ESTRING:: @msg</pattern>
					<pattern>date=@ESTRING:: @time=@ESTRING:: @devname=@ESTRING:: @device_id=@ESTRING:: @log_id=@ESTRING:: @type=traffic subtype=@ESTRING:: @pri=@ESTRING:: @status=@ESTRING:: @vd=@ESTRING:: @dir_disp=@ESTRING:: @tran_disp=@ESTRING:: @src=@IPv4:i0:@ srcname=@ESTRING:: @src_port=@NUMBER:i1:@ dst=@IPv4:i2:@ dstname=@ESTRING:: @dst_port=@NUMBER:i3:@ tran_ip=@ESTRING:: @tran_port=@ESTRING:: @service=@ESTRING:: @proto=@NUMBER:i4:@ app_type=@ESTRING:: @duration=@NUMBER:i5:@</pattern>
					<pattern>date=@ESTRING:: @time=@ESTRING:: @devname=@ESTRING:: @device_id=@ESTRING:: @log_id=@ESTRING:: @type=traffic subtype=@ESTRING:: @pri=@ESTRING:: @status=@ESTRING:: @vd=@ESTRING:: @src=@IPv4:i0:@ srcname=@ESTRING:: @src_port=@NUMBER:i1:@ dst=@IPv4:i2:@ dstname=@ESTRING:: @dst_port=@NUMBER:i3:@ service=@ESTRING:: @proto=@NUMBER:i4:@ app_type=@ESTRING:: @duration=@NUMBER:i5:@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program='kernel'>date=2012-02-10 time=11:27:01 devname=CUSTID01-SITEID-FW device_id=FGT80C9999999999 log_id=2 subtype=allowed type=traffic pri=notice vd=VDOM dir_disp=org tran_disp=snat src=10.1.2.3 srcname=10.1.2.3 src_port=53624 dst=4.3.2.2 dstname=4.3.2.2 dst_port=80 tran_ip=5.4.3.2 tran_port=49648 service=80/tcp proto=6 app_type=N/A duration=120 rule=49 policyid=49 identidx=0 sent=1221 rcvd=2062 shaper_drop_sent=0 shaper_drop_rcvd=0 perip_drop=0 sent_pkt=7 rcvd_pkt=6 src_int=INT dst_int=WAN SN=16349534 app=N/A app_cat=N/A carrier_ep=N/A vpn=N/A status=accept user=N/A group=N/A shaper_sent_name=N/A shaper_rcvd_name=N/A perip_name=N/A</test_message>
						<test_values>
							<test_value name='i0'>10.1.2.3</test_value>
							<test_value name='i1'>53624</test_value>
							<test_value name='i2'>4.3.2.2</test_value>
							<test_value name='i3'>80</test_value>
							<test_value name='i4'>6</test_value>
							<test_value name='i5'>120</test_value>
						</test_values>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name='checkpoint_deny' id='23'>
		<rules>
			<rule provider='ELSA' class='23' id='23'>
				<patterns>
					<pattern>@QSTRING:i0:&quot;&quot;@ @QSTRING::&quot;&quot;@ @QSTRING::&quot;&quot;@ @QSTRING:s0:&quot;&quot;@ @QSTRING:s1:&quot;&quot;@ @QSTRING:s2:&quot;&quot;@ @QSTRING:s3:&quot;&quot;@ @QSTRING:s4:&quot;&quot;@ @QSTRING::&quot;&quot;@ @QSTRING:i1:&quot;&quot;@ @QSTRING:i2:&quot;&quot;@ @QSTRING:i3:&quot;&quot;@ @QSTRING::&quot;&quot;@ @QSTRING::&quot;&quot;@ @QSTRING::&quot;&quot;@ @QSTRING::&quot;&quot;@ &quot;message_info: @ESTRING:s5:&quot;@ @QSTRING::&quot;&quot;@ @QSTRING::&quot;&quot;@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program=''>&quot;1&quot; &quot;12Feb2012&quot; &quot;23:59:04&quot; &quot;bond0.30&quot; &quot;FW-INT-CHCKPNT1&quot; &quot;Log&quot; &quot;Drop&quot; &quot;ntp-udp&quot; &quot;ntp-udp&quot; &quot;192.168.1.210&quot; &quot;10.133.3.10&quot; &quot;udp&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;message_info: Address spoofing&quot; &quot;VPN-1 Power/UTM&quot; &quot;&quot; &quot;&quot;</test_message>
						<test_values>
							<test_value name='i0'>1</test_value>
							<test_value name='s0'>bond0.30</test_value>
							<test_value name='s1'>FW-INT-CHCKPNT1</test_value>
							<test_value name='s2'>Log</test_value>
							<test_value name='s3'>Drop</test_value>
							<test_value name='s4'>ntp-udp</test_value>
							<test_value name='i1'>192.168.1.210</test_value>
							<test_value name='i2'>10.133.3.10</test_value>
							<test_value name='i3'>udp</test_value>
							<test_value name='s5'>Address spoofing</test_value>
						</test_values>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name='palo_alto_url' id='24'>
		<rules>
			<rule provider='ELSA' class='24' id='24'>
				<patterns>
					<pattern>@NUMBER::@:@NUMBER::@,@NUMBER::@,@ESTRING::,@url,@NUMBER::@,@ESTRING::,@@IPv4:i0:@,@IPv4:i1:@,@IPv4::@,@IPv4::@,@ESTRING:s0:,@@ESTRING:s1:,@@ESTRING::,@@ESTRING:s2:,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING:i2:,@1@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@&quot;@ESTRING:s3:/@@ESTRING:s4:&quot;@,(@NUMBER::@),@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING:s5:,@</pattern>
					<pattern>@ESTRING::,@ TYPE: THREAT, SUBTYPE: url, THREAT_ID: (@NUMBER::@), ACTION: @ESTRING::,@ RULE: @ESTRING::,@ MISC: &quot;@ESTRING:s3:/@@ESTRING:s4:&quot;@</pattern>
					<values>
						<value name='s4'>/$s4</value>
					</values>
				</patterns>
				<examples>
					<example>
						<test_message program=''>46:31,002501000259,THREAT,url,0,2012/02/21 09:46:31,192.168.1.1,208.71.123.129,0.0.0.0,0.0.0.0,USERS-Network-AllowAll-to-EXT,domain\joeschmo,,web-browsing,vsys1,Users,External,ethernet1/3,ethernet1/5,forward-syslog-to-elsa,2012/02/2109:46:30,156730,1,50836,80,0,0,0x8000,tcp,alert,&quot;network.realmedia.com/RealMedia/ads/adstream_sx.ads/newsinc_ap_video_us/preroll/vast/sx/ss/a/@x75&quot;,(9999),All,informational,client-to-server,19630699,0x0,United States,United States,0,text/xml</test_message>
						<test_values>
							<test_value name='i0'>192.168.1.1</test_value>
							<test_value name='i1'>208.71.123.129</test_value>
							<test_value name='s0'>USERS-Network-AllowAll-to-EXT</test_value>
							<test_value name='s1'>domain\joeschmo</test_value>
							<test_value name='s2'>web-browsing</test_value>
							<test_value name='i2'>156730</test_value>
							<test_value name='s3'>network.realmedia.com</test_value>
							<test_value name='s4'>/RealMedia/ads/adstream_sx.ads/newsinc_ap_video_us/preroll/vast/sx/ss/a/@x75</test_value>
							<test_value name='s5'>United States</test_value>
						</test_values>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name='palo_alto_traffic' id='25'>
		<rules>
			<rule provider='ELSA' class='25' id='25'>
				<patterns>
					<pattern>@NUMBER::@:@NUMBER::@,@ESTRING::TRAFFIC,@@ESTRING:s5:,@@NUMBER::@,@ESTRING::,@@IPv4:i0:@,@IPv4:i1:@,@IPv4::@,@IPv4::@,@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING:s0:,@@ESTRING:s1:,@@ESTRING:s2:,@@ESTRING:s3:,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING:i2:,@@ESTRING:i3:,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING:i4:,@@ESTRING::,@@ESTRING:i5:,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING:s4:,@</pattern>
					<pattern>@ESTRING::,@ TYPE: TRAFFIC, SUBTYPE: @ESTRING:s5:,@ RULE: @ESTRING::,@ ACTION: @ESTRING::,@ INBOUND_INTERFACE: @ESTRING:s2:,@ FROM_ZONE: @ESTRING:s0:,@ SOURCE_USER: @ESTRING::,@ SOURCE_IP: @ESTRING:i0:,@ NAT_SOURCE_IP: @ESTRING::,@ SOURCE_PORT: @ESTRING:i2:,@ OUTBOUND_INTERFACE: @ESTRING:s3:,@ TO_ZONE: @ESTRING:s1:,@ DESTINATION_USER: @ESTRING::,@ DESTINATION_IP: @ESTRING:i1:,@ DESTINATION_PORT: @ESTRING:i3:,@ DESTINATION_LOCATION: @ESTRING:s4:,@ CATEGORY: @ESTRING:s5:,@ PROTOCOL: @ESTRING:i4:,@ APPLICATION: @ESTRING::,@ ELAPSED_TIME: @ESTRING::,@ BYTES: @ESTRING:i5:,@ BYTES_RECEIVED: @ESTRING::,@ BYTES_SENT: @ESTRING::,@ TOTAL_PACKETS: @ESTRING::,@ PACKETS_RECEIVED: @ESTRING::,@ PACKETS_SENT: @ESTRING::,@ REPEAT_COUNT_5sec: </pattern>
				</patterns>
				<examples>
					<example>
						<test_message program=''>46:31,002501000259,TRAFFIC,end,0,2012/02/21 09:46:31,10.10.10.10,192.168.1.1,0.0.0.0,0.0.0.0,ALL-http-https-to-BASTION,,,web-browsing,vsys1,External,Bastion,ethernet1/5,ethernet1/2,forward-syslog-to-elsa,2012/02/21 09:46:30,632179,1,4074,80,0,0,0x0,tcp,allow,2986,1493,1493,19,2012/02/21 09:45:57,31,not-resolved,0,453403179,0x0,United States,United States,0,10,9</test_message>
						<test_values>
							<test_value name='i0'>10.10.10.10</test_value>
							<test_value name='i1'>192.168.1.1</test_value>
							<test_value name='s0'>External</test_value>
							<test_value name='s1'>Bastion</test_value>
							<test_value name='s2'>ethernet1/5</test_value>
							<test_value name='s3'>ethernet1/2</test_value>
							<test_value name='i2'>4074</test_value>
							<test_value name='i3'>80</test_value>
							<test_value name='i4'>tcp</test_value>
							<test_value name='i5'>2986</test_value>
							<test_value name='s4'>United States</test_value>
							<test_value name='s5'>end</test_value>
						</test_values>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name='ossec' id='26'>
		<rules>
			<rule provider='ELSA' class='4' id='26'>
				<patterns>
					<pattern>@NUMBER::@@ESTRING::(@@ESTRING::)@ @IPv4:pdb_extracted_sourceip:@-&gt;WinEvtLog WinEvtLog: @ESTRING:pdb_extracted_program::@ AUDIT_@ESTRING::(@@ESTRING:i0:)@@ESTRING::Account Name@@ESTRING::Account Name@:  @ESTRING:s1: @@ESTRING::Account Domain@:  @ESTRING:s2: @@ESTRING::Source Network Address@: @IPv4:i1:@</pattern>
					<values>
						<value name='PROGRAM'>$pdb_extracted_program</value>
					</values>
				</patterns>
				<examples>
					<example>
						<test_message program=''>2013 Jan 18 20:25:08 (host.example.com) 172.20.0.23-&gt;WinEvtLog WinEvtLog: Security: AUDIT_SUCCESS(4624): Microsoft-Windows-Security-Auditing: myuser: MYDOMAIN: MYDOMAIN-DC-1.example.com: An account was successfully logged on. Subject:  Security ID:  S-1-5-18  Account Name:  MYDOMAIN-DC-1$  Account Domain:  MYDOMAIN  Logon ID:  0x3e7  Logon Type:   3  New Logon:  Security ID:  S-1-5-21-3113823999-9998615402-9997257512-9966  Account Name:  myuser  Account Domain:  MYDOMAIN  Logon ID:  0x2339f787  Logon GUID:  {00000000-0000-0000-0000-000000000000}  Process Information:  Process ID:  0x1e8  Process Name:  C:\\Windows\\System32\\lsass.exe  Network Information:  Workstation Name: MYDOMAIN-DC-1  Source Network Address: 172.24.248.117  Source Port:  54265  Detailed Authentication Information:  Logon Process:  Advapi    Authentication Package: MICROSOFT_AUTHENTICATION_PACKAGE_V1_0  Transited Services: -  Package Name (NTLM only): -  Key Length:  0  This event is generated when a logon session is created. It is generated on the computer that was accessed.</test_message>
						<test_values>
							<test_value name='i0'>4624</test_value>
							<test_value name='s1'>myuser</test_value>
							<test_value name='s2'>MYDOMAIN</test_value>
							<test_value name='i1'>172.24.248.117</test_value>
						</test_values>
					</example>
				</examples>
			</rule>
			<rule provider='ELSA' class='4' id='26'>
				<patterns>
					<pattern>asdf@NUMBER::@@ESTRING::(@@ESTRING::)@ @IPv4:pdb_extracted_sourceip:@-&gt;WinEvtLog WinEvtLog: @ESTRING:pdb_extracted_program::@ AUDIT_@ESTRING::(@@ESTRING:i0:)@</pattern>
					<values>
						<value name='PROGRAM'>$pdb_extracted_program</value>
					</values>
				</patterns>
				<examples>
					<example>
						<test_message program=''>2012 Feb 20 09:04:41 (serverb) 123.123.40.23-&gt;WinEvtLog WinEvtLog: Security: AUDIT_SUCCESS(4769): Microsoft-Windows-Security-Auditing: bgreen@DOM1.A.COM: DOM1.A.COM: serverb.dom1.a.com: A Kerberos service ticket was requested. Account Information:  Account Name: bgreen@DOM1.A.COM  Account Domain:  DOM1.A.COM  Logon GUID: {CBB22EBF-4367-CB43-E5AC-2A8C13FD9641}  Service Information:  Service Name:  SERVERC$  Service ID: S-1-5-21-117536760-2556423787-3220343774-160533  Network Information:Client Address:  ::ffff:123.123.39.33  Client Port:  62513  Additional Information:  Ticket Options:  0x40810000  Ticket Encryption Type: 0x12  Failure Code:  0x0  Transited Services: -  This event is generated every time access is requested to a resource such as a computer or a Windows service.  The service name indicates the resource to which access was requested.</test_message>
						<test_values>
							<test_value name='i0'>4769</test_value>
							<test_value name='PROGRAM'>Security</test_value>
							<test_value name='pdb_extracted_sourceip'>123.123.40.23</test_value>
						</test_values>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name='barracuda' id='27'>
		<pattern>from</pattern>
		<rules>
			<rule provider='ELSA' class='27' id='27'>
				<patterns>
					<pattern>@IPv4:pdb_extracted_sourceip:@: scan[@NUMBER::@]@ESTRING::[@@IPv4:i0:@] @ESTRING:: @@ESTRING:: @@ESTRING:: @SCAN @ESTRING:: @@ESTRING:s0: @@ESTRING:s1: @@ESTRING:: @@ESTRING:i1: @@ESTRING:i2: @@ESTRING:s2: @SZ:@NUMBER::@ SUBJ:@ANYSTRING:s3:@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program='from'>192.168.1.10: scan[8077]: UNKNOWN[10.37.80.102] 1329946623-01792678721d5b70001-uwIQq5 1329946623 1329946623 SCAN - sender@example.com recipient@example.com 0.341 0 0 - SZ:1634 SUBJ:Service - Flow Capture (inside)|status.example.com|PROBLEM</test_message>
						<test_values>
							<test_value name='i0'>10.37.80.102</test_value>
							<test_value name='s0'>sender@example.com</test_value>
							<test_value name='s1'>recipient@example.com</test_value>
							<test_value name='i1'>0</test_value>
							<test_value name='i2'>0</test_value>
							<test_value name='s2'>-</test_value>
							<test_value name='s3'>Service - Flow Capture (inside)|status.example.com|PROBLEM</test_value>
							<test_value name='pdb_extracted_sourceip'>192.168.1.10</test_value>
						</test_values>
					</example>
				</examples>
			</rule>
			<rule provider='ELSA' class='28' id='28'>
				<patterns>
					<pattern>@IPv4:pdb_extracted_sourceip:@: inbound/pass@NUMBER::@[@NUMBER::@]@ESTRING::[@@IPv4:i0:@] @ESTRING:: @@ESTRING:: @@ESTRING:: @RECV @ESTRING:s0: @@ESTRING:s1: @@ESTRING:i1: @@ESTRING:i2: @@ANYSTRING:s2:@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program='from'>192.168.1.10: inbound/pass1[22443]: host.com[8.7.24.13] 1329330589-01792657ab486050001-5NcMI6 1329330589 1329330590 RECV test@test.com test1@test.ca 2 62 8.7.24.13</test_message>
						<test_values>
							<test_value name='i0'>8.7.24.13</test_value>
							<test_value name='s0'>test@test.com</test_value>
							<test_value name='s1'>test1@test.ca</test_value>
							<test_value name='i1'>2</test_value>
							<test_value name='i2'>62</test_value>
							<test_value name='s2'>8.7.24.13</test_value>
							<test_value name='pdb_extracted_sourceip'>192.168.1.10</test_value>
						</test_values>
					</example>
				</examples>
			</rule>
			<rule provider='ELSA' class='29' id='29'>
				<patterns>
					<pattern>@IPv4:pdb_extracted_sourceip:@: outbound/smtp[@NUMBER::@]: @IPv4:i0:@ @ESTRING:: @@ESTRING:: @@ESTRING:: @SEND @ESTRING:: @@ESTRING:i1: @@ESTRING:: @@ESTRING:: @@ESTRING:: @@ANYSTRING:s0:@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program='from'>192.168.1.10: outbound/smtp[17580]: 127.0.0.1 1329330593-01792657ab486060001-slQ29D 0 0 SEND - 1 40FD5C6C659 250 &lt;0be658c5d60e4a0ea51a0a4745d6115e@mail.ca&gt; Queued mail for delivery</test_message>
						<test_values>
							<test_value name='i0'>127.0.0.1</test_value>
							<test_value name='s0'>Queued mail for delivery</test_value>
							<test_value name='i1'>1</test_value>
							<test_value name='pdb_extracted_sourceip'>192.168.1.10</test_value>
						</test_values>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name='barracuda_scan' id='27_scan'>
		<pattern>scan</pattern>
		<rules>
			<rule provider='ELSA' class='27' id='27'>
				<patterns>
					<pattern>@ESTRING::[@@IPv4:i0:@] @ESTRING:: @@ESTRING:: @@ESTRING:: @SCAN @ESTRING:: @@ESTRING:s0: @@ESTRING:s1: @@ESTRING:: @@ESTRING:i1: @@ESTRING:i2: @@ESTRING:s2: @SZ:@NUMBER::@ SUBJ:@ANYSTRING:s3:@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program='scan'>UNKNOWN[10.37.80.102] 1329946623-01792678721d5b70001-uwIQq5 1329946623 1329946623 SCAN - sender@example.com recipient@example.com 0.341 0 0 - SZ:1634 SUBJ:Service - Flow Capture (inside)|status.example.com|PROBLEM</test_message>
						<test_values>
							<test_value name='i0'>10.37.80.102</test_value>
							<test_value name='s0'>sender@example.com</test_value>
							<test_value name='s1'>recipient@example.com</test_value>
							<test_value name='i1'>0</test_value>
							<test_value name='i2'>0</test_value>
							<test_value name='s2'>-</test_value>
							<test_value name='s3'>Service - Flow Capture (inside)|status.example.com|PROBLEM</test_value>
						</test_values>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>		
	<ruleset name='barracuda_inbound' id='27_inbound'>
		<pattern>inbound</pattern>
		<rules>
			<rule provider='ELSA' class='28' id='28'>
				<patterns>
					<pattern>@ESTRING::[@@IPv4:i0:@] @ESTRING:: @@ESTRING:: @@ESTRING:: @RECV @ESTRING:s0: @@ESTRING:s1: @@ESTRING:i1: @@ESTRING:i2: @@ANYSTRING:s2:@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program='inbound/pass1'>host.com[8.7.24.13] 1329330589-01792657ab486050001-5NcMI6 1329330589 1329330590 RECV test@test.com test1@test.ca 2 62 8.7.24.13</test_message>
						<test_values>
							<test_value name='i0'>8.7.24.13</test_value>
							<test_value name='s0'>test@test.com</test_value>
							<test_value name='s1'>test1@test.ca</test_value>
							<test_value name='i1'>2</test_value>
							<test_value name='i2'>62</test_value>
							<test_value name='s2'>8.7.24.13</test_value>
						</test_values>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>		
	<ruleset name='barracuda_outbound' id='27_outbound'>
		<pattern>outbound</pattern>
		<rules>
			<rule provider='ELSA' class='29' id='29'>
				<patterns>
					<pattern>@IPv4:i0:@ @ESTRING:: @@ESTRING:: @@ESTRING:: @SEND @ESTRING:: @@ESTRING:i1: @@ESTRING:: @@ESTRING:: @@ESTRING:: @@ANYSTRING:s0:@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program='outbound/smtp'>192.168.1.10: outbound/smtp[17580]: 127.0.0.1 1329330593-01792657ab486060001-slQ29D 0 0 SEND - 1 40FD5C6C659 250 &lt;0be658c5d60e4a0ea51a0a4745d6115e@mail.ca&gt; Queued mail for delivery</test_message>
						<test_values>
							<test_value name='i0'>127.0.0.1</test_value>
							<test_value name='s0'>Queued mail for delivery</test_value>
							<test_value name='i1'>1</test_value>
						</test_values>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name='Microsoft Exchange via Epilog' id='30'>
		<patterns>exchmtlog</patterns>
		<rules>
			<rule provider='ELSA' class='30' id='30'>
				<patterns>
					<pattern>@ESTRING::,@@ESTRING::,@@ESTRING:s0:,@@ESTRING::,@@ESTRING:s1:,@@ESTRING::,@@ESTRING::,@STOREDRIVER,DELIVER,@NUMBER::@,@ESTRING:s2:,@@ESTRING:s3:,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING::,@@ESTRING:s4:,@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program='exchmtlog'>2012-03-16T17:13:16.475Z,,servername,,casservername,,,STOREDRIVER,DELIVER,23065261,sender@some.org,recipient@other.org,,156558,1,,,TEST MESSAGE SUBJECT,sender@some.org,sender@some.org,2012-03-16T17:13:16.147Z</test_message>
						<test_value name='s0'>servername</test_value>
						<test_value name='s1'>casservername</test_value>
						<test_value name='s2'>sender@some.org</test_value>
						<test_value name='s3'>recipient@other.org</test_value>
						<test_value name='s4'>TEST MESSAGE SUBJECT</test_value>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name='URL via Novell forwarder script' id='31'>
		<patterns>novell_logs_</patterns>
		<rules>
			<rule provider='ELSA' class='7' id='7'>
				<patterns>
					<pattern>@ESTRING::|@@ESTRING::|@@ESTRING:i0:|@@ESTRING:username:|@@ESTRING:i1:|@@ESTRING:s1:|@@ESTRING:s0:|@@ESTRING::|@&quot;@ESTRING:s2:&quot;@|&quot;@ESTRING::|@@ESTRING::|@@ESTRING:i2:|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING:i3:|@@ESTRING:i5:|@&quot;@ESTRING:s4:&quot;@|@ESTRING::|@&quot;@ESTRING:s3:&quot;@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program='novell_logs_test'>2012-04-06|15:57:49|10.124.19.11|-|10.0.59.189|dev.mail.example.com|GET|&quot;https://dev.mail.example.com:443/owa/auth/preload.htm&quot;|&quot;/owa/auth/preload.htm&quot;|&quot;&quot;|HTTP/1.1|200|&quot;In Cache, Fresh&quot;|550|&quot;1527&quot;|Success|2077|916|0.000|&quot;Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; .NET CLR 1.1.4322; InfoPath.3)&quot;|&quot;ASPSESSIONIDSSDSDRTA=JPNHAEECMAIOIDMIHNPJGOKE; ASPSESSIONIDSQDSCQSA=FGPFCJECCJAGBFBHLPHPKMPD&quot;|&quot;https://dev.mail.example.com/exchweb/bin/auth/owalogon.asp?url=https://dev.mail.example.com/exchange&amp;reason=0&amp;replaceCurrent=1&quot;|&quot;&quot;|1|-|-|&quot;&quot;|&quot;&quot;|&quot;&quot;|&quot;&quot;|&quot;&quot;|&quot;&quot;</test_message>
						<test_value name='i0'>10.124.19.11</test_value>
						<test_value name='i1'>10.0.59.189</test_value>
						<test_value name='s0'>GET</test_value>
						<test_value name='s1'>dev.mail.example.com</test_value>
						<test_value name='s2'>/owa/auth/preload.htm</test_value>
						<test_value name='s3'>https://dev.mail.example.com/exchweb/bin/auth/owalogon.asp?url=https://dev.mail.example.com/exchange&amp;reason=0&amp;replaceCurrent=1</test_value>
						<test_value name='s4'>Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; .NET CLR 1.1.4322; InfoPath.3)</test_value>
						<test_value name='i2'>200</test_value>
						<test_value name='i3'>916</test_value>
						<test_value name='i5'>0.000</test_value>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name='Windows Event log Firewall Filtering' id='32'>
		<pattern>Security-Auditing</pattern>
		<rules>
			<rule provider='M Smith' class='3' id='1000'>
				<patterns>
					<pattern>@ESTRING:: @The Windows Filtering Platform has @ESTRING:: @a connection. Application Information: Process ID: @ESTRING:: @Application Name: @ESTRING:: @Network Information: Direction: @ESTRING:: @Source Address: @IPv4:i1@ Source Port: @NUMBER:i2:@ Destination Address: @IPv4:i3:@ Destination Port: @NUMBER:i4:@ Protocol: @NUMBER:i0:@ Filter Information: Filter Run-Time ID: @ESTRING:: @Layer Name: @ESTRING:: @Layer Run-Time ID: @NUMBER::@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program='Security-Auditing'>5156: The Windows Filtering Platform has permitted a connection. Application Information: Process ID: 1924 Application Name: \device\harddiskvolume1\users\admin\appdata\local\dude\win.exe Network Information: Direction: Outbound Source Address: 1.1.1.1 Source Port: 1234 Destination Address: 2.2.2.2 Destination Port: 4567 Protocol: 17 Filter Information: Filter Run-Time ID: 70078 Layer Name: Connect Layer Run-Time ID: 48</test_message>
							<test_value name='i1'>1.1.1.1</test_value>
							<test_value name='i2'>1234</test_value>
							<test_value name='i3'>2.2.2.2</test_value>
							<test_value name='i4'>4567</test_value>
							<test_value name='i0'>17</test_value>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name='TMG-Gateway-W3C-Logs-via-Epilog' id='10099'>
            <rules>
                    <rule provider='bgreen' class='3' id='10099'>
                            <patterns>
                                    <pattern>@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING:i0:|@@ESTRING:::@@ESTRING:i2:|@@ESTRING:i3::@@ESTRING:i4:|@@ESTRING:i1:|@@ESTRING:s0:|@@ESTRING:s1:|@</pattern>
                            </patterns>
                            <examples>
                                    <example>
                                            <test_message program='ISAFWSLOG'>BOB|2012-07-05|15:05:11|TCP|123.123.123.222:40521|123.123.123.111:443|123.123.111.111|Local Host|Internal|Establish|0x0|-|HTTPS|0|0|0|0|-|-|-|-|4|1874698|-|-|::|-|1048575|-</test_message>
                                            <test_value name='i0'>TCP</test_value>
                                            <test_value name='i1'>123.123.111.111</test_value>
                                            <test_value name='i2'>40521</test_value>
                                            <test_value name='i3'>123.123.123.111</test_value>
                                            <test_value name='i4'>443</test_value>
											<test_value name='s0'>Local Host</test_value>
											<test_value name='s1'>Internal</test_value>
                                    </example>
                            </examples>
                    </rule>
            </rules>
    </ruleset>
    <ruleset name='ISAFWSLog-via-Epilog'>
    		<patterns>
    			<pattern>ISAFWSLog</pattern>
    		</patterns>
            <rules>
                    <rule provider='ELSA' class='7' id='7'>
                            <patterns>
                                    <pattern>@ESTRING:i0:|@@ESTRING::|@@ESTRING:s4:|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING:i1:|@@ESTRING::|@@ESTRING::|@@ESTRING:s0:|@@ESTRING:://@@ESTRING:s1:/@@ESTRING:s2:|@@ESTRING:i2:|@</pattern>
                                    <pattern>@ESTRING:i0:|@@ESTRING::|@@ESTRING:s4:|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING::|@@ESTRING:i1:|@@ESTRING::|@@ESTRING:s0:|@@ESTRING::|@@ESTRING:s1:|@</pattern>
                            </patterns>
                            <examples>
                                    <example>
                                    		<test_message program='ISAFWSLog'>1.1.1.1|domainname\username|Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; InfoPath.2)|2012-08-27|18:59:49|MAD00GS6|2.2.2.2|2.2.2.2|80|http|GET|http://search.twitter.com/search.json?q=hp%2520dell%2520problems&amp;since_id=240160211699122180&amp;callback=twitter._queue_callback&amp;result_type=mixed|200|Internet Access to Users|Req ID: 1f449904 |Internal|External|0x480|Allowed|-</test_message>
                                            <test_value name='i0'>1.1.1.1</test_value>
											<test_value name='i1'>2.2.2.2</test_value>
											<test_value name='s0'>GET</test_value>
											<test_value name='s1'>search.twitter.com</test_value>
											<test_value name='s2'>search.json?q=hp%2520dell%2520problems&amp;since_id=240160211699122180&amp;callback=twitter._queue_callback&amp;result_type=mixed</test_value>
											<test_value name='s3'></test_value>
											<test_value name='s4'>Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; InfoPath.2)</test_value>
											<test_value name='s5'></test_value>
											<test_value name='i2'>200</test_value>
											<test_value name='i3'></test_value>
											<test_value name='i4'></test_value>
                                    </example>
                            </examples>
                    </rule>
            </rules>
    </ruleset>
    <ruleset name='Cisco SEC'>
    	<pattern>%SEC-</pattern>
    	<rules>
    		<rule provider='ELSA' class='2' id='2'>
    			<pattern>list @ESTRING:s0: @denied @ESTRING:i0: @@ESTRING:i1:(@@NUMBER:i2:@) -&gt; @ESTRING:i3:(@@NUMBER:i4:@@ANYSTRING@</pattern>
    			<examples>
	    			<example>
	    				<test_message program='%SEC-6-IPACCESSLOGP'>list FILTER-INTERNET-IN denied tcp 1.2.3.4(53420) -&gt; 5.6.7.8(23), 1 packet</test_message>
	    				<test_value name='s2'>FILTER-INTERNET-IN</test_value>
	    				<test_value name='i0'>tcp</test_value>
	    				<test_value name='i1'>1.2.3.4</test_value>
	    				<test_value name='i2'>53420</test_value>
	    				<test_value name='i3'>5.6.7.8</test_value>
	    				<test_value name='i4'>23</test_value>
	    			</example>
	    		</examples>
	    	</rule>
    	</rules>
    	<rules>
    		<rule provider='ELSA' class='3' id='3'>
    			<pattern>list @ESTRING:s0: @permitted @ESTRING:i0: @@ESTRING:i1:(@@NUMBER:i2:@) -&gt; @ESTRING:i3:(@@NUMBER:i4:@@ANYSTRING@</pattern>
    			<examples>
	    			<example>
	    				<test_message program='%SEC-6-IPACCESSLOGP'>list FILTER-INTERNET-IN permitted tcp 1.2.3.4(53420) -&gt; 5.6.7.8(23), 1 packet</test_message>
	    				<test_value name='s2'>FILTER-INTERNET-IN</test_value>
	    				<test_value name='i0'>tcp</test_value>
	    				<test_value name='i1'>1.2.3.4</test_value>
	    				<test_value name='i2'>53420</test_value>
	    				<test_value name='i3'>5.6.7.8</test_value>
	    				<test_value name='i4'>23</test_value>
	    			</example>
	    		</examples>
	    	</rule>
    	</rules>
    </ruleset>
    <ruleset name='CEF'>
    	<rules>
    		<rule provider='ELSA' class='32' id='32'>
    			<pattern>CEF:@NUMBER::@|@ESTRING:s0:|@@ESTRING:s1:|@@ESTRING:s2:|@@ESTRING:s3:|@@ESTRING:s4:|@@NUMBER:i0:@|@ANYSTRING:s5:@</pattern>
    			<examples>
	    			<example>
	    				<test_message program=''>CEF:0|security|threatmanager|1.0|100|worm successfully stopped|10|src=10.0.0.1 dst=2.1.2.2 spt=1232</test_message>
	    				<test_value name='i0'>10</test_value>
	    				<test_value name='s0'>security</test_value>
	    				<test_value name='s1'>threatmanager</test_value>
	    				<test_value name='s2'>1.0</test_value>
	    				<test_value name='s3'>100</test_value>
	    				<test_value name='s4'>worm successfully stopped</test_value>
	    				<test_value name='s5'>src=10.0.0.1 dst=2.1.2.2 spt=1232</test_value>
	    			</example>
	    		</examples>
	    	</rule>
    	</rules>
	</ruleset>
	<ruleset name='Watchguard Firewall'>
		<pattern>firewall</pattern>
		<rules>
			<rule provider='ELSA' class='2' id='2'>
				<pattern>Deny @ESTRING:s0: @@ESTRING:s1: @@NUMBER::@ @ESTRING:i0: @@NUMBER::@ @NUMBER::@ @ESTRING:i1: @@ESTRING:i3: @@ESTRING:i2: @@ESTRING:i4: @</pattern>
				<examples>
					<example>
						<test_message program='firewall'>Deny 0-External Firebox 1340 tcp 20 56 74.125.225.143 10.0.1.1 443 3449 offset 5 A 451109382 win 257 (Unhandled External Packet-00)</test_message>
						<test_value name='i0'>tcp</test_value>
						<test_value name='i1'>74.125.225.143</test_value>
						<test_value name='i2'>443</test_value>
						<test_value name='i3'>10.0.1.1</test_value>
						<test_value name='i4'>3449</test_value>
						<test_value name='s0'>0-External</test_value>
						<test_value name='s1'>Firebox</test_value>
					</example>
				</examples>
			</rule>
			<rule provider='ELSA' class='3' id='3'>
				<pattern>Allow @ESTRING:s1: @@ESTRING:s0: @@NUMBER::@ @ESTRING:i0: @@NUMBER::@ @NUMBER::@ @ESTRING:i1: @@ESTRING:i3: @@ESTRING:i2: @@ESTRING:i4: @</pattern>
				<examples>
					<example>
						<test_message program='firewall'>Allow 1-Trusted 0-External 52 tcp 20 127 192.168.1.31 96.60.118.121 55185 8005 offset 8 S 1125590318 win 32 (ATSBDR-00)</test_message>
						<test_value name='i0'>tcp</test_value>
						<test_value name='i1'>192.168.1.31</test_value>
						<test_value name='i2'>55185</test_value>
						<test_value name='i3'>96.60.118.121</test_value>
						<test_value name='i4'>8005</test_value>
						<test_value name='s0'>0-External</test_value>
						<test_value name='s1'>1-Trusted</test_value>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name='Watchguard URL'>
		<pattern>http-proxy</pattern>
		<rules>
			<rule provider='ELSA' class='7' id='7'>
				<pattern>Deny @ESTRING:: @@ESTRING:: @tcp @ESTRING:i0: @@ESTRING:i1: @@NUMBER::@ @NUMBER::@ msg=&quot;@ESTRING::&quot;@ proxy_act=&quot;@ESTRING::&quot;@ op=&quot;@ESTRING:s0:&quot;@ dstname=&quot;@ESTRING:s1:&quot;@ arg=&quot;@ESTRING:s2:&quot;@ sent_bytes=&quot;@NUMBER::@&quot; rcvd_bytes=&quot;@NUMBER:i3:@</pattern>
				<examples>
					<example>
						<test_message program='http-proxy'>Deny 1-Trusted 0-External tcp 192.168.1.17 23.21.13.155 62115 80 msg=&quot;HTTP Request&quot; proxy_act=&quot;HTTP-Client.1&quot; op=&quot;&quot; dstname=&quot;23.21.13.155&quot; arg=&quot;&quot; sent_bytes=&quot;1&quot; rcvd_bytes=&quot;0&quot; (HTTP-proxy-ExceptLunch-00)</test_message>
						<test_value name='i0'>192.168.1.17</test_value>
						<test_value name='i1'>23.21.13.155</test_value>
						<test_value name='i3'>0</test_value>
						<test_value name='s0'></test_value>
						<test_value name='s1'>23.21.13.155</test_value>
						<test_value name='s2'></test_value>
					</example>
				</examples>
			</rule>
			<rule provider='ELSA' class='7' id='7'>
				<pattern>Allow @ESTRING:: @@ESTRING:: @tcp @ESTRING:i0: @@ESTRING:i1: @@NUMBER::@ @NUMBER::@ msg=&quot;@ESTRING::&quot;@ proxy_act=&quot;@ESTRING::&quot;@ op=&quot;@ESTRING:s0:&quot;@ dstname=&quot;@ESTRING:s1:&quot;@ arg=&quot;@ESTRING:s2:&quot;@ sent_bytes=&quot;@NUMBER::@&quot; rcvd_bytes=&quot;@NUMBER:i3:@</pattern>
				<examples>
					<example>
						<test_message program='http-proxy'>Allow 1-Trusted 0-External tcp 192.168.1.22 74.125.142.95 2597 80 msg=&quot;HTTP Request&quot; proxy_act=&quot;HTTP-Client.1&quot; op=&quot;GET&quot; dstname=&quot;ajax.googleapis.com&quot; arg=&quot;/ajax/libs/jquery/1.5/jquery.min.js&quot; sent_bytes=&quot;363&quot; rcvd_bytes=&quot;30368&quot; (HTTP-proxy-ExceptLunch-00)</test_message>
						<test_value name='i0'>192.168.1.22</test_value>
						<test_value name='i1'>74.125.142.95</test_value>
						<test_value name='i3'>30368</test_value>
						<test_value name='s0'>GET</test_value>
						<test_value name='s1'>ajax.googleapis.com</test_value>
						<test_value name='s2'>/ajax/libs/jquery/1.5/jquery.min.js</test_value>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name='Sidewinder Firewall'>
		<pattern>auditd</pattern>
		<rules>
			<rule provider='ELSA' class='2' id='2'>
				<pattern>date@ESTRING::event=@ACL deny@ESTRING::srcip=@@IPv4:i1:@,srcport=@NUMBER:i2:@,srcburb=@ESTRING:s1:,@dstip=@IPv4:i3:@,dstport=@NUMBER:i4:@,dstburb=@ESTRING:s0:,@protocol=@NUMBER:i0:@</pattern>
				<pattern>date@ESTRING::event=@ACL deny@ESTRING::srcip=@@IPv4:i1:@,srcburb=@ESTRING:s1:,@dstip=@IPv4:i3:@,dstburb=@ESTRING:s0:,@protocol=@NUMBER:i0:@</pattern>
				<pattern>date@ESTRING::type=@t_attack@ESTRING::srcip=@@IPv4:i1:@,srcport=@NUMBER:i2:@,srcburb=@ESTRING:s1:,@@ESTRING::protocol=@@NUMBER:i0:@@ESTRING::dstip=@@IPv4:i3:@,dstport=@NUMBER:i4:@,dstburb=@ESTRING:s0:,@</pattern>
				<pattern>date@ESTRING::type=@t_netprobe@ESTRING::srcip=@@IPv4:i1:@,srcport=@NUMBER:i2:@,srcburb=@ESTRING:s1:,@dstip=@IPv4:i3:@,dstport=@NUMBER:i4:@,protocol=@NUMBER:i0:@,interface=@ESTRING:s0:,@</pattern>
				<examples>
					<example>
						<test_message program='auditd'>date=&quot;Oct 1 16:24:57 2012 UTC&quot;,fac=f_kernel_ipfilter,area=a_general_area,type=t_ipftraffic,pri=p_major,pid=0,ruid=0,euid=0,pgid=0,logid=0,cmd=kernel,domain=htpp,edomain=htpp,hostname=localhost,event=IP Filter session open,rule_name=myrule-out,srcip=1.1.1.1,srcport=1,srcburb=internal2,dstip=2.2.2.2,dstport=2,dstburb=external1,protocol=6,netsessid=5069c3d9000c7831</test_message>
						<test_value name='i0'>6</test_value>
						<test_value name='i1'>1.1.1.1</test_value>
						<test_value name='i2'>1</test_value>
						<test_value name='i3'>2.2.2.2</test_value>
						<test_value name='i4'>2</test_value>
						<test_value name='s0'>external1</test_value>
						<test_value name='s1'>internal2</test_value>
					</example>
				</examples>
			</rule>
			<rule provider='ELSA' class='3' id='3'>
				<pattern>date@ESTRING::event=@proxy traffic end@ESTRING::srcip=@@IPv4:i1:@,srcport=@NUMBER:i2:@,srcburb=@ESTRING:s1:,@protocol=@NUMBER:i0:@,dstip=@IPv4:i3:@,dstport=@NUMBER:i4:@,dstburb=@ESTRING:s0:,@bytes_written_to_client=@NUMBER:i5:@</pattern>
				<pattern>date@ESTRING::event=@proxy traffic end@ESTRING::srcip=@@IPv4:i1:@,srcburb=@ESTRING:s1:,@protocol=@NUMBER:i0:@,dstip=@IPv4:i3:@,dstburb=@ESTRING:s0:,@bytes_written_to_client=@NUMBER:i5:@</pattern>
				<pattern>date@ESTRING::event=@IP Filter session close@ESTRING::srcip=@@IPv4:i1:@,srcport=@NUMBER:i2:@,srcburb=@ESTRING:s1:,@dstip=@IPv4:i3:@,dstport=@NUMBER:i4:@,dstburb=@ESTRING:s0:,@bytes_written_to_client=@NUMBER:i5:@@ESTRING::protocol=@@NUMBER:i0:@</pattern>
				<pattern>date@ESTRING::event=@IP Filter session timeout@ESTRING::srcip=@@IPv4:i1:@,srcport=@NUMBER:i2:@,srcburb=@ESTRING:s1:,@dstip=@IPv4:i3:@,dstport=@NUMBER:i4:@,dstburb=@ESTRING:s0:,@bytes_written_to_client=@NUMBER:i5:@@ESTRING::protocol=@@NUMBER:i0:@</pattern>
				<examples>
					<example>
						<test_message program='auditd'>date=&quot;Oct 1 16:24:57 2012 UTC&quot;,fac=f_http_proxy,area=a_libproxycommon,type=t_nettraffic,pri=p_major,pid=28529,ruid=0,euid=0,pgid=28529,logid=0,cmd=httpp,domain=htpp,edomain=htpp,hostname=localhost,event=proxy traffic end,service_name=http,netsessid=5069c3d9000ab8ce,srcip=1.1.1.1,srcport=1,srcburb=internal2,protocol=6,dstip=2.2.2.2,dstport=2,dstburb=external1,bytes_written_to_client=1297,bytes_written_to_server=421,rule_name=www.isa.webproxy,cache_hit=0,request_status=0,start_time=&quot;Mon Oct 1 11:24:57 2012&quot;</test_message>
						<test_value name='i0'>6</test_value>
						<test_value name='i1'>1.1.1.1</test_value>
						<test_value name='i2'>1</test_value>
						<test_value name='i3'>2.2.2.2</test_value>
						<test_value name='i4'>2</test_value>
						<test_value name='s0'>external1</test_value>
						<test_value name='s1'>internal2</test_value>
						<test_value name='i5'>1297</test_value>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name='Websense'>
		<pattern></pattern>
		<rules>
			<rule provider='ELSA' class='33' id='33'>
				<pattern>vendor=Websense@ESTRING::action=@@ESTRING:s5: @severity=@ESTRING::category=@@ESTRING:s3: @user=@ESTRING:s0: @src_host=@IPv4:i0:@@ESTRING::dst_host=@@ESTRING:s1: @dst_ip=@IPv4:i1:@@ESTRING::http_response=@@NUMBER:i2:@@ESTRING::http_user_agent=@@ESTRING:s4: @@ESTRING::disposition=@@ESTRING:s3: @@ESTRING:://@@ESTRING::/@@ANYSTRING:s2:@</pattern>
				<pattern>vendor=Websense@ESTRING::action=@@ESTRING:s5: @severity=@ESTRING::category=@@ESTRING:s3: @user=@ESTRING:s0: @src_host=@IPv4:i0:@@ESTRING::dst_host=@@ESTRING:s1: @dst_ip=@IPv4:i1:@@ESTRING::http_response=@@NUMBER:i2:@@ESTRING::http_user_agent=@@ESTRING:s4: @@ESTRING::disposition=@@ESTRING:s3: @</pattern>
				<values>
					<value name='s2'>/$s2</value>
				</values>
				<examples>
					<example>
						<test_message program=''>vendor=Websense product=Security product_version=7.7.0 action=permitted severity=1 category=153 user=- src_host=10.64.134.74 src_port=62189 dst_host=mail.google.com dst_ip=74.125.224.53 dst_port=443 bytes_out=197 bytes_in=76 http_response=200 http_method=CONNECT http_content_type=- http_user_agent=Mozilla/5.0_(Windows;_U;_Windows_NT_6.1;_en-US;_rv:1.9.2.23)_Gecko/20110920_Firefox/3.6.23 http_proxy_status_code=200 reason=- disposition=1034 policy=- role=8 duration=0 url=https://mail.google.com/index.html</test_message>
						<test_value name='i0'>10.64.134.74</test_value>
						<test_value name='i1'>74.125.224.53</test_value>
						<test_value name='i2'>200</test_value>
						<test_value name='s0'>-</test_value>
						<test_value name='s1'>mail.google.com</test_value>
						<test_value name='s2'>/index.html</test_value>
						<test_value name='s3'>1034</test_value>
						<test_value name='s4'>Mozilla/5.0_(Windows;_U;_Windows_NT_6.1;_en-US;_rv:1.9.2.23)_Gecko/20110920_Firefox/3.6.23</test_value>
						<test_value name='s5'>permitted</test_value>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name='McAfee SmartFilter'>
		<pattern></pattern>
		<rules>
			<rule provider='ELSA' class='33' id='33'>
				<pattern>@IPv4:i0@ - @ESTRING:s0: @@ESTRING::&quot;@@ESTRING:://@@ESTRING:s1:/@@ESTRING:s2:&quot;@ @NUMBER:i2:@ @ESTRING:s5: @@QSTRING:s3:&quot;@</pattern>
				<values>
					<value name='s2'>/$s2</value>
				</values>
				<examples>
					<example>
						<test_message program=''>1.1.1.1 - username  [03/Oct/2012:06:52:51 +0100]  &quot;GET http://a.nice.url/some/uri?parameters=go&amp;in=here&quot; 200 ALLOW &quot;Blogs/Wiki, Entertainment&quot;</test_message>
						<test_value name='i0'>1.1.1.1</test_value>
						<test_value name='i2'>200</test_value>
						<test_value name='s0'>username</test_value>
						<test_value name='s1'>a.nice.url</test_value>
						<test_value name='s2'>/some/uri?parameters=go&amp;in=here</test_value>
						<test_value name='s3'>Blogs/Wiki, Entertainment</test_value>
						<test_value name='s5'>ALLOW</test_value>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name='Netflow' id='Netflow'>
		<pattern>netflow_syslog</pattern>
		<rules>
			<rule provider='ELSA' class='34' id='34'>
				<patterns>
					<pattern>@ESTRING:i0:|@@ESTRING:i1:|@@ESTRING:i2:|@@ESTRING:i3:|@@ESTRING:i4:|@@ESTRING:i5:|@@ESTRING:s0:|@@ESTRING:s1:|@@ESTRING:s2:|@@ESTRING:s3:|@@ESTRING:s4:|@@ANYSTRING:s5:@</pattern>
					<pattern>@ESTRING:i0:|@@ESTRING:i1:|@@ESTRING:i2:|@@ESTRING:i3:|@@ESTRING:i4:|@@ESTRING:i5:|@@ESTRING:s0:|@@ESTRING:s1:|@@ESTRING:s2:|@@ESTRING:s3:|@@ESTRING:s4:|@</pattern>
					<pattern>@ESTRING:i0:|@@ESTRING:i1:|@@ESTRING:i2:|@@ESTRING:i3:|@@ESTRING:i4:|@@ESTRING:i5:|@@ESTRING:s0:|@@ESTRING:s1:|@@ESTRING:s2:|@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program='netflow_syslog'>tcp|192.85.128.47|35843|1.1.1.1|443|30486|2173|US|Palo Alto, CA|37.376202|-122.182602|HPES - Hewlett-Packard Company</test_message>
						<test_values>
							<test_value name='i0'>tcp</test_value>
							<test_value name='i1'>192.85.128.47</test_value>
							<test_value name='i2'>35843</test_value>
							<test_value name='i3'>1.1.1.1</test_value>
							<test_value name='i4'>443</test_value>
							<test_value name='i5'>30486</test_value>
							<test_value name='s0'>2173</test_value>
							<test_value name='s1'>US</test_value>
							<test_value name='s2'>Palo Alto, CA</test_value>
							<test_value name='s3'>37.376202</test_value>
							<test_value name='s4'>-122.182602</test_value>
							<test_value name='s5'>HPES - Hewlett-Packard Company</test_value>
						</test_values>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name='IISWebLog'>
		<pattern>IISWebLog</pattern>
		<rule provider='ELSA' class='7' id='IIS_7'>
			<pattern>@ESTRING:: @@ESTRING:: @@ESTRING:: @@ESTRING:: @@IPv4:i1:@ @ESTRING:s0: @@ESTRING:s2: @@ESTRING:: @@ESTRING:: @@ESTRING:: @@IPv4:i0:@ @ESTRING:: @@ESTRING:s4: @@ESTRING:: @@ESTRING:s3: @@ESTRING:s1: @@NUMBER:i2:@ @NUMBER::@ @NUMBER::@ @NUMBER:i3:@ @NUMBER::@ @NUMBER:i5:@</pattern>
			<examples>
				<example>
					<test_message program='IISWebLog'>2012-12-13 13:39:16 W3SVC1 MYSERVERNAME 1.1.1.1 GET / - 80 - 2.2.2.2 HTTP/1.1 Mozilla/5.0+(Windows+NT+6.1;+WOW64)+AppleWebKit/537.11+(KHTML,+like+Gecko)+Chrome/23.0.1271.95+Safari/537.11 - - www.fqdn.of.website.from.host.header.com 301 0 0 401 408 453</test_message>
					<test_values>
						<test_value name='i0'>2.2.2.2</test_value>
						<test_value name='i1'>1.1.1.1</test_value>
						<test_value name='i2'>301</test_value>
						<test_value name='i3'>401</test_value>
						<test_value name='i5'>453</test_value>
						<test_value name='s0'>GET</test_value>
						<test_value name='s1'>www.fqdn.of.website.from.host.header.com</test_value>
						<test_value name='s2'>/</test_value>
						<test_value name='s3'>-</test_value>
						<test_value name='s4'>Mozilla/5.0+(Windows+NT+6.1;+WOW64)+AppleWebKit/537.11+(KHTML,+like+Gecko)+Chrome/23.0.1271.95+Safari/537.11</test_value>
					</test_values>
				</example>
			</examples>
		</rule>
	</ruleset>
	<ruleset name='Vyatta FW'>
		<pattern>kernel-</pattern>
		<rules>
			<rule provider='ELSA' class='2' id='2'>
				<patterns>
					<pattern>@QSTRING::[]@ [@ESTRING:s2:-R]@IN=@ESTRING:s1: @OUT=@ESTRING:s0: @@ESTRING:: SRC=@@IPv4:i1:@ DST=@IPv4:i3:@ @ESTRING::PROTO=@@ESTRING:i0: @SPT=@ESTRING:i2: @DPT=@ESTRING:i4: @@ANYSTRING@</pattern>
					<pattern>@QSTRING::[]@ [@ESTRING:s2:-D]@IN=@ESTRING:s1: @OUT=@ESTRING:s0: @@ESTRING:: SRC=@@IPv4:i1:@ DST=@IPv4:i3:@ @ESTRING::PROTO=@@ESTRING:i0: @SPT=@ESTRING:i2: @DPT=@ESTRING:i4: @@ANYSTRING@</pattern>
					<pattern>@QSTRING::[]@ [@ESTRING:s2:-R]@ IN=@ESTRING:s1: @OUT=@ESTRING:s0: @@ESTRING:: SRC=@@IPv4:i1:@ DST=@IPv4:i3:@ @ESTRING::PROTO=@@ESTRING:i0: @SPT=@ESTRING:i2: @DPT=@ESTRING:i4: @@ANYSTRING@</pattern>
					<pattern>@QSTRING::[]@ [@ESTRING:s2:-D]@ IN=@ESTRING:s1: @OUT=@ESTRING:s0: @@ESTRING:: SRC=@@IPv4:i1:@ DST=@IPv4:i3:@ @ESTRING::PROTO=@@ESTRING:i0: @SPT=@ESTRING:i2: @DPT=@ESTRING:i4: @@ANYSTRING@</pattern>
					<pattern>@QSTRING::[]@ [@ESTRING:s2:-R]@IN=@ESTRING:s1: @OUT=@ESTRING:s0: @@ESTRING:: SRC=@@IPv4:i1:@ DST=@IPv4:i3:@ @ESTRING::PROTO=@@ESTRING:i0: @@ANYSTRING@</pattern>
					<pattern>@QSTRING::[]@ [@ESTRING:s2:-D]@IN=@ESTRING:s1: @OUT=@ESTRING:s0: @@ESTRING:: SRC=@@IPv4:i1:@ DST=@IPv4:i3:@ @ESTRING::PROTO=@@ESTRING:i0: @@ANYSTRING@</pattern>
					<pattern>@QSTRING::[]@ [@ESTRING:s2:-R]@ IN=@ESTRING:s1: @OUT=@ESTRING:s0: @@ESTRING:: SRC=@@IPv4:i1:@ DST=@IPv4:i3:@ @ESTRING::PROTO=@@ESTRING:i0: @@ANYSTRING@</pattern>
					<pattern>@QSTRING::[]@ [@ESTRING:s2:-D]@ IN=@ESTRING:s1: @OUT=@ESTRING:s0: @@ESTRING:: SRC=@@IPv4:i1:@ DST=@IPv4:i3:@ @ESTRING::PROTO=@@ESTRING:i0: @@ANYSTRING@</pattern>
					<pattern>@QSTRING::[]@ [@ESTRING:s2:-R]@IN=@ESTRING:s1: @OUT=@ESTRING:s0: @@ESTRING:: SRC=@@IPv4:i1:@ DST=@IPv4:i3:@ @ESTRING::PROTO=@@STRING:i0:@</pattern>
					<pattern>@QSTRING::[]@ [@ESTRING:s2:-D]@IN=@ESTRING:s1: @OUT=@ESTRING:s0: @@ESTRING:: SRC=@@IPv4:i1:@ DST=@IPv4:i3:@ @ESTRING::PROTO=@@STRING:i0:@</pattern>
					<pattern>@QSTRING::[]@ [@ESTRING:s2:-R]@ IN=@ESTRING:s1: @OUT=@ESTRING:s0: @@ESTRING:: SRC=@@IPv4:i1:@ DST=@IPv4:i3:@ @ESTRING::PROTO=@@STRING:i0:@</pattern>
					<pattern>@QSTRING::[]@ [@ESTRING:s2:-D]@ IN=@ESTRING:s1: @OUT=@ESTRING:s0: @@ESTRING:: SRC=@@IPv4:i1:@ DST=@IPv4:i3:@ @ESTRING::PROTO=@@STRING:i0:@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program='kernel'>[100100.226323] [WEB_IN-default-R]IN=eth0 OUT=eth1 MAC=00:50:56:a6:00:13:00:50:56:a6:1f:41:08:00 SRC=172.31.254.28 DST=172.31.253.105 LEN=44 TOS=0x00 PREC=0x00 TTL=41 ID=16822 PROTO=TCP SPT=51425 DPT=23 WINDOW=1024 RES=0x00 SYN URGP=0</test_message>
						<test_value name='s0'>eth1</test_value>
						<test_value name='s1'>eth0</test_value>
						<test_value name='s2'>WEB_IN-default</test_value>
						<test_value name='i0'>TCP</test_value>
						<test_value name='i1'>172.31.254.28</test_value>
						<test_value name='i2'>51425</test_value>
						<test_value name='i3'>172.31.253.105</test_value>
						<test_value name='i4'>23</test_value>
					</example>
					<example>
						<test_message program='kernel'>[382188.344294] [WEB_IN-default-D]IN=eth0 OUT=eth1 MAC=00:50:56:a6:00:13:00:50:56:a6:1f:41:08:00 SRC=172.31.254.28 DST=172.31.253.109 LEN=44 TOS=0x00 PREC=0x00 TTL=45 ID=55452 PROTO=TCP SPT=51809 DPT=80 WINDOW=1024 RES=0x00 SYN URGP=0</test_message>
						<test_value name='s0'>eth1</test_value>
						<test_value name='s1'>eth0</test_value>
						<test_value name='s2'>WEB_IN-default</test_value>
						<test_value name='i0'>TCP</test_value>
						<test_value name='i1'>172.31.254.28</test_value>
						<test_value name='i2'>51809</test_value>
						<test_value name='i3'>172.31.253.109</test_value>
						<test_value name='i4'>80</test_value>
					</example>
					<example>
						<test_message program='kernel'>[387123.927635] [WEB_IN-8-D] IN=eth0 OUT=eth1 MAC=00:50:56:a6:00:13:00:50:56:a6:1f:41:08:00 SRC=172.31.254.28 DST=172.31.253.103 LEN=28 TOS=0x00 PREC=0x00 TTL=47 ID=49372 PROTO=ICMP TYPE=8 CODE=0 ID=5799 SEQ=0</test_message>
						<test_value name='s0'>eth1</test_value>
						<test_value name='s1'>eth0</test_value>
						<test_value name='s2'>WEB_IN-8</test_value>
						<test_value name='i0'>ICMP</test_value>
						<test_value name='i1'>172.31.254.28</test_value>
						<test_value name='i2'></test_value>
						<test_value name='i3'>172.31.253.103</test_value>
						<test_value name='i4'></test_value>
					</example>
					<example>
						<test_message program='kernel'>[466981.095849] [WEB_IN-default-D]IN=eth0 OUT=eth1 MAC=00:50:56:a6:00:13:00:50:56:a6:1f:41:08:00 SRC=172.31.254.28 DST=172.31.253.106 LEN=20 TOS=0x00 PREC=0x00 TTL=44 ID=39983 PROTO=135</test_message>
						<test_value name='s0'>eth1</test_value>
						<test_value name='s1'>eth0</test_value>
						<test_value name='s2'>WEB_IN-default</test_value>
						<test_value name='i0'>135</test_value>
						<test_value name='i1'>172.31.254.28</test_value>
						<test_value name='i2'></test_value>
						<test_value name='i3'>172.31.253.106</test_value>
						<test_value name='i4'></test_value>
					</example>
					<example>
						<test_message program='kernel'>[451134.428328] [WEB_IN-9-R] IN=eth0 OUT=eth1 MAC=00:50:56:a6:00:13:00:50:56:a6:1f:41:08:00 SRC=172.31.254.28 DST=172.31.253.107 LEN=20 TOS=0x00 PREC=0x00 TTL=37 ID=12252 PROTO=ESP INCOMPLETE [0 bytes]</test_message>
						<test_value name='s0'>eth1</test_value>
						<test_value name='s1'>eth0</test_value>
						<test_value name='s2'>WEB_IN-9</test_value>
						<test_value name='i0'>ESP</test_value>
						<test_value name='i1'>172.31.254.28</test_value>
						<test_value name='i2'></test_value>
						<test_value name='i3'>172.31.253.107</test_value>
						<test_value name='i4'></test_value>
					</example>
				</examples>
			</rule>
		</rules>
		<rules>
			<rule provider='ELSA' class='3' id='3'>
				<patterns>
					<pattern>@QSTRING::[]@ [@ESTRING:s2:-A]@IN=@ESTRING:s1: @OUT=@ESTRING:s0: @@ESTRING::SRC=@@IPv4:i1:@ DST=@IPv4:i3:@ @ESTRING::PROTO=@@ESTRING:i0: @SPT=@ESTRING:i2: @DPT=@ESTRING:i4: @@ANYSTRING@</pattern>
					<pattern>@QSTRING::[]@ [@ESTRING:s2:-A]@ IN=@ESTRING:s1: @OUT=@ESTRING:s0: @@ESTRING::SRC=@@IPv4:i1:@ DST=@IPv4:i3:@ @ESTRING::PROTO=@@ESTRING:i0: @SPT=@ESTRING:i2: @DPT=@ESTRING:i4: @@ANYSTRING@</pattern>
					<pattern>@QSTRING::[]@ [@ESTRING:s2:-A]@IN=@ESTRING:s1: @OUT=@ESTRING:s0: @@ESTRING::SRC=@@IPv4:i1:@ DST=@IPv4:i3:@ @ESTRING::PROTO=@@ESTRING:i0: @@ANYSTRING@</pattern>
					<pattern>@QSTRING::[]@ [@ESTRING:s2:-A]@ IN=@ESTRING:s1: @OUT=@ESTRING:s0: @@ESTRING::SRC=@@IPv4:i1:@ DST=@IPv4:i3:@ @ESTRING::PROTO=@@ESTRING:i0: @@ANYSTRING@</pattern>
					<pattern>@QSTRING::[]@ [@ESTRING:s2:-A]@IN=@ESTRING:s1: @OUT=@ESTRING:s0: @@ESTRING::SRC=@@IPv4:i1:@ DST=@IPv4:i3:@ @ESTRING::PROTO=@@STRING:i0:@</pattern>
					<pattern>@QSTRING::[]@ [@ESTRING:s2:-A]@ IN=@ESTRING:s1: @OUT=@ESTRING:s0: @@ESTRING::SRC=@@IPv4:i1:@ DST=@IPv4:i3:@ @ESTRING::PROTO=@@STRING:i0:@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program='kernel'>[88829.069484] [WEB_IN-7-A] IN=eth0 OUT=eth1 MAC=00:50:56:a6:00:13:00:50:56:a6:1f:41:08:00 SRC=172.31.254.28 DST=172.31.253.102 LEN=44 TOS=0x00 PREC=0x00 TTL=46 ID=22533 PROTO=TCP SPT=59995 DPT=3306 WINDOW=1024 RES=0x00 SYN URGP=0</test_message>
						<test_value name='s0'>eth1</test_value>
						<test_value name='s1'>eth0</test_value>
						<test_value name='s2'>WEB_IN-7</test_value>
						<test_value name='i0'>TCP</test_value>
						<test_value name='i1'>172.31.254.28</test_value>
						<test_value name='i2'>59995</test_value>
						<test_value name='i3'>172.31.253.102</test_value>
						<test_value name='i4'>3306</test_value>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name='OSSEC_ALERTS'>
		<pattern>ossec</pattern>
		<rules>
			<rule provider='shadejinx' class='35' id='35'>
				<pattern>Alert Level: @NUMBER:i0:@; Rule: @NUMBER:i1:@ - @ESTRING:s0:;@ Location: @ESTRING:s1:-@@ESTRING::;@ user: @ESTRING:s2:;@</pattern>
				<examples>
					<example>
						<test_message program='ossec'>Alert Level: 4; Rule: 18105 - Windows audit failure event.; Location: %SERVER.DOMAIN.LOCAL%-&gt;/var/log/ossec_in; user: %USERNAME%; Jan 12 13:51:34 %SERVER.DOMAIN.LOCAL% MSWinEventLog|1|Security|3151378|Sat Jan 12 13:51:32 2013|4776|Microsoft-Windows-Security-Auditing|%USERNAME%|N/A|Failure Audit|%SERVER.DOMAIN.LOCAL%|None||The computer attempted to validate the credentials for an account. Authentication Package: MICROSOFT_AUTHENTICATION_PACKAGE_V1_0 Logon Account: %USERNAME% Source Workstation: %WORKSTATION_NAME% Error Code: 0xc0000064|3147595</test_message>
						<test_value name='i0'>4</test_value>
						<test_value name='i1'>18105</test_value>
						<test_value name='s0'>Windows audit failure event.</test_value>
						<test_value name='s1'>%SERVER.DOMAIN.LOCAL%</test_value>
						<test_value name='s2'>%USERNAME%</test_value>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name='NetScreen' id='1001'>
		<rules>
			<rule provider='ELSA' class='2' id='2'>
				<patterns>
					<pattern>NetScreen device_id=@ESTRING:: @@ESTRING:: start_time=&quot;@@ESTRING::&quot;@ duration=@ESTRING:: @policy_id=@ESTRING:s2: @service=@ESTRING:: @proto=@ESTRING:i0: @src zone=@ESTRING:s1: @dst zone=@ESTRING:s0: @action=Deny sent=@ESTRING:: @rcvd=@ESTRING:: @src=@ESTRING:i1: @dst=@ESTRING:i3: @src_port=@ESTRING:i2: @dst_port=@ESTRING:i4: @</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program='fwgate-1'>NetScreen device_id=fw [Root]system-notification-00257(traffic): start_time=&quot;2012-10-02 09:46:20&quot; duration=0 policy_id=10005 service=http proto=6 src zone=OUT dst zone=IN action=Deny sent=0 rcvd=40 src=192.168.0.1 dst=192.168.1.1 src_port=51271 dst_port=80 session_id=0 reason=Traffic Denied</test_message>
						<test_value name='i0'>6</test_value>
						<test_value name='s0'>IN</test_value>
						<test_value name='i1'>192.168.0.1</test_value>
						<test_value name='s1'>OUT</test_value>
						<test_value name='i2'>51271</test_value>
						<test_value name='i3'>192.168.1.1</test_value>
						<test_value name='i4'>10005</test_value>
					</example>
				</examples>
			</rule>
		</rules>
		<rules>
			<rule provider='ELSA' class='3' id='3'>
				<patterns>
					<pattern>NetScreen device_id=@ESTRING:: @@ESTRING:: start_time=&quot;@@ESTRING::&quot;@ duration=@ESTRING:s2: @policy_id=@ESTRING:: @service=@ESTRING:: @proto=@ESTRING:i0: @src zone=@ESTRING:s1: @dst zone=@ESTRING:s0: @action=Permit sent=@ESTRING:: @rcvd=@ESTRING:i5: @src=@ESTRING:i1: @dst=@ESTRING:i3: @src_port=@ESTRING:i2: @dst_port=@ESTRING:i4: @</pattern>
				</patterns>
				<examples>
					<example>
					    <test_message program='fwgate-1'>NetScreen device_id=fwgate-1 [Root]system-notification-00257(traffic): start_time=&quot;2013-02-14 15:37:46&quot; duration=2 policy_id=8 service=tcp/port:10050 proto=6 src zone=Trust dst zone=DMZ action=Permit sent=379 rcvd=377 src=192.168.1.XX dst=192.168.XXX.XXX src_port=36033 dst_port=10050 src-xlated ip=192.168.XX.XX port=36033 dst-xlated ip=192.168.XXX.XXX port=10050 session_id=253315 reason=Close - TCP FIN</test_message>
						<test_value name='i0'>6</test_value>
						<test_value name='i1'>192.168.1.XX</test_value>
						<test_value name='i2'>36033</test_value>
						<test_value name='i3'>192.168.XXX.XXX</test_value>
						<test_value name='i4'>10050</test_value>
						<test_value name='i5'>377</test_value>
						<test_value name='s0'>DMZ</test_value>
						<test_value name='s1'>Trust</test_value>
						<test_value name='s2'>2</test_value>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name='ATT Uverse' id='1001'>
		<rules>
			<rule provider='ELSA' class='2' id='2'>
				<patterns>
					<pattern>src=@ESTRING:i1: @dst=@ESTRING:i3: @ipprot=@ESTRING:i0: @sport=@ESTRING:i2: @dport=@ESTRING:i4: @</pattern>
					<pattern>src=@ESTRING:i1: @dst=@ESTRING:i3: @ipprot=@ESTRING:i0: @</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program='fw,fwmon'>src=192.168.1.65 dst=192.168.2.8 ipprot=17 sport=7547 dport=3478 Drop traffic to 192.168.0.0/16</test_message>
						<test_value name='i0'>17</test_value>
						<test_value name='i1'>192.168.1.65</test_value>
						<test_value name='i2'>7547</test_value>
						<test_value name='i3'>192.168.2.8</test_value>
						<test_value name='i4'>3478</test_value>
					</example>
					<example>
						<test_message program='fw,fwmon'>src=192.168.2.8 dst=192.168.1.72 ipprot=17 (layer 4 info unknown) Unknown inbound session stopped</test_message>
						<test_value name='i0'>17</test_value>
						<test_value name='i1'>192.168.2.8</test_value>
						<test_value name='i3'>192.168.1.72</test_value>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
	<ruleset name='bluecoat'>
		<pattern>url</pattern>
		<rules>
			<rule class='7' id='7'>
				<patterns>
					<pattern>@ESTRING:: @@ESTRING:: @@NUMBER:i5:@ @IPv4:i0:@ @NUMBER:i2:@ @ESTRING:: @@NUMBER::@ @NUMBER:i3:@ @ESTRING:s0: @@ESTRING:: @@ESTRING:s1: @@ESTRING:: @@ESTRING:s2_a: @@ESTRING:s2_b: @@ESTRING:: @@ESTRING:: @@ESTRING:: @@ESTRING:: @@ESTRING:: @@ESTRING:s4: @@ESTRING:s5: @</pattern>
					<pattern>20@ESTRING:: @@ESTRING:: @@ESTRING:: @@ESTRING:i0: @@ESTRING:: @@ESTRING:: @@ESTRING:: @@ESTRING:: @@ESTRING:: @@ESTRING:s1: @</pattern>
				</patterns>
				<values>
					<value name='s2'>$s2_a$s2_b</value>
				</values>
			</rule>
		</rules>
	</ruleset>
	<ruleset name='infoblox_dhcp' id='40'>
		<pattern>dhcpd</pattern>
		<rules>
			<rule provider='ELSA' class='40' id='40'>
				<patterns>
					<pattern>DHCPDISCOVER from @ESTRING:s0: @via @ESTRING:i0::@</pattern>
					<pattern>bind update on @ESTRING:i0: @from @ESTRING:s1:(@@NUMBER::@)</pattern>
					<pattern>Forward map from @ESTRING:s2: @to @ESTRING:i0: @</pattern>
					<pattern>Abandoning IP address @ESTRING:i0::@</pattern>
					<pattern>Reclaiming abandoned lease @IPvANY:i0:@</pattern>
					<pattern>client @ESTRING:i0:#@@NUMBER::@: update forwarding &apos;@ESTRING:s1:/@</pattern>
					<pattern>DNS format error from @ESTRING:i1:#@@NUMBER:i2:@ resolving </pattern>
					<pattern>DHCPACK on @ESTRING:i0: @to @ESTRING:s0: @(@ESTRING:s2:)@</pattern>
				</patterns>
				<examples>
					<example>
						<test_message program='dhcpd'>DHCPDISCOVER from aa:aa:aa:aa:aa:aa via 10.1.52.31: peer holds all free leases</test_message>
						<test_value name='s0'>aa:aa:aa:aa:aa:aa</test_value>
						<test_value name='i0'>10.1.52.31</test_value>
					</example>
					<example>
						<test_message program='dhcpd'>bind update on 1.1.1.1 from corp-test(1368109376) rejected: incoming update is less critical than outgoing update</test_message>
						<test_value name='i0'>1.1.1.1</test_value>
						<test_value name='s1'>corp-test</test_value>
					</example>
					<example>
						<test_message program='dhcpd'>Forward map from host.test.com to 1.1.1.1 FAILED: Has an address record but no DHCID, not mine.</test_message>
						<test_value name='i0'>1.1.1.1</test_value>
						<test_value name='s2'>host.test.com</test_value>
					</example>
					<example>
						<test_message program='dhcpd'>Abandoning IP address 1.1.1.1: pinged before offer</test_message>
						<test_value name='i0'>1.1.1.1</test_value>
					</example>
					<example>
						<test_message program='dhcpd'>Reclaiming abandoned lease 10.1.52.207.</test_message>
						<test_value name='i0'>1.1.1.1</test_value>
					</example>
					<example>
						<test_message program='dhcpd'>client 1.1.1.1#64919: update forwarding &apos;test.com/IN&apos; denied</test_message>
						<test_value name='i0'>1.1.1.1</test_value>
						<test_value name='s1'>test.com</test_value>
					</example>
					<example>
						<test_message program='dhcpd'>DHCPACK on 192.168.208.64 to aa:aa:aa:aa:aa:aa (JT-Mac) via 192.168.208.8</test_message>
						<test_value name='i0'>192.168.208.64</test_value>
						<test_value name='s0'>aa:aa:aa:aa:aa:aa</test_value>
						<test_value name='s2'>JT-Mac</test_value>
					</example>
				</examples>
			</rule>
		</rules>
	</ruleset>
</patterndb>
